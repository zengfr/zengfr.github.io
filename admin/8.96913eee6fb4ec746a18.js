(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+6XX":function(e,t,n){var r=n("y1pI");e.exports=function(e){return r(this.__data__,e)>-1}},"+K+b":function(e,t,n){var r=n("JHRd");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},"+Qka":function(e,t,n){var r=n("fmRc"),i=n("t2Dn"),o=n("cq/+"),a=n("T1AV"),c=n("GoyQ"),s=n("mTTR"),u=n("itsj");e.exports=function e(t,n,l,f,p){t!==n&&o(n,function(o,s){if(p||(p=new r),c(o))a(t,n,s,l,e,f,p);else{var d=f?f(u(t,s),o,s+"",t,n,p):void 0;void 0===d&&(d=o),i(t,s,d)}},s)}},"+em5":function(e,t,n){"use strict";n.d(t,"a",function(){return P});var r,i,o,a,c,s=n("lSNA"),u=n.n(s),l=n("yG8O"),f=n.n(l),p=n("lwsE"),d=n.n(p),h=n("W8MJ"),v=n.n(h),g=n("U+yc"),m=n.n(g),y=(n("1ABj"),n("gQMU")),b=n.n(y),_=n("J2iB"),E=n.n(_),S=n("u6S6"),T=n.n(S),x=n("4cb6"),A=n("h1nZ"),O=n("bB6j"),w=n("bPkA");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){u()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var P=(r=Object(x.injectable)(),i=Object(x.inject)(O.a.IShaderModuleService),r((a=function(){function e(){d()(this,e),f()(this,"shaderModuleService",c,this),this.rendererService=void 0,this.config=void 0,this.quad="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return v()(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getType",value:function(){return w.a.PostProcessing}},{key:"init",value:function(e,t){this.config=t,this.rendererService=e.getContainer().get(O.a.IRendererService);var n=this.rendererService,r=n.createAttribute,i=n.createBuffer,o=n.createModel,a=this.setupShaders(),c=a.uniforms;this.model=o({vs:a.vs,fs:a.fs,attributes:{a_Position:r({buffer:i({data:[-4,-4,4,-4,0,4],type:A.gl.FLOAT}),size:2})},uniforms:I(I({u_Texture:null},c),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(e){var t=this,n=e.multiPassRenderer.getPostProcessor(),r=this.rendererService,i=r.useFramebuffer,o=r.clear,a=(0,r.getViewportSize)(),c=a.width,s=a.height;i(this.renderToScreen?null:n.getWriteFBO(),function(){o({framebuffer:n.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:I({u_Texture:n.getReadFBO(),u_ViewportSize:[c,s]},t.convertOptionsToUniforms(t.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(e){this.enabled=e}},{key:"setRenderToScreen",value:function(e){this.renderToScreen=e}},{key:"updateOptions",value:function(e){this.optionsToUpdate=I(I({},this.optionsToUpdate),e)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(e){var t={};return Object.keys(e).forEach(function(n){E()(e[n])||(t["u_".concat(b()(T()(n)))]=e[n])}),t}}]),e}(),c=m()(a.prototype,"shaderModuleService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=a))||o)},"+iFO":function(e,t,n){var r=n("dTAl"),i=n("LcsW"),o=n("6sVZ");e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},"/33/":function(e,t){},"/9aa":function(e,t,n){var r=n("NykK"),i=n("ExA7");e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},"/Uc5":function(e,t){},"03A+":function(e,t,n){var r=n("JTzB"),i=n("ExA7"),o=Object.prototype,a=o.hasOwnProperty,c=o.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(e){return i(e)&&a.call(e,"callee")&&!c.call(e,"callee")};e.exports=s},"0Cz8":function(e,t,n){var r=n("Xi7e"),i=n("ebwN"),o=n("e4Nc");e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},"0JQy":function(e,t){var n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",i="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+n+"|"+r+")?",s="[\\ufe0e\\ufe0f]?",u=s+c+"(?:\\u200d(?:"+[i,o,a].join("|")+")"+s+c+")*",l="(?:"+[i+n+"?",n,o,a,"[\\ud800-\\udfff]"].join("|")+")",f=RegExp(r+"(?="+r+")|"+l+u,"g");e.exports=function(e){return e.match(f)||[]}},"0ZTe":function(e,t,n){var r=n("wy8a"),i=n("quyA"),o=n("Em2t"),a=n("dt0z");e.exports=function(e){return function(t){t=a(t);var n=i(t)?o(t):void 0,c=n?n[0]:t.charAt(0),s=n?r(n,1).join(""):t.slice(1);return c[e]()+s}}},"0eqD":function(e,t){},"0gSV":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tagged=void 0;var r=n("GXnB"),i=n("Ztfv");t.tagged=function(e,t){return function(n,o,a){var c=new r.Metadata(e,t);"number"==typeof a?i.tagParameter(n,o,a,c):i.tagProperty(n,o,c)}}},"0wsv":function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r=6371008.8,i={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*r,kilometers:6371.0088,kilometres:6371.0088,meters:r,metres:r,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:r/1852,radians:1,yards:5825721.287490856};function o(e,t){void 0===t&&(t="kilometers");var n=i[t];if(!n)throw new Error(t+" units is invalid");return e*n}function a(e){return e%360*Math.PI/180}},"1ABj":function(e,t){e.exports=function(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}},"1OyB":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return r})},"1hJj":function(e,t,n){var r=n("e4Nc"),i=n("ftKO"),o=n("3A9y");function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},"1jvM":function(e,t){},"2ajD":function(e,t){e.exports=function(e){return e!=e}},"2gN3":function(e,t,n){var r=n("Kz5y");e.exports=r["__core-js_shared__"]},"3A9y":function(e,t){e.exports=function(e){return this.__data__.has(e)}},"3Fdi":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(t){}try{return e+""}catch(t){}}return""}},"3L66":function(e,t,n){var r=n("MMmD"),i=n("ExA7");e.exports=function(e){return i(e)&&r(e)}},"3cYt":function(e,t){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},4:function(e,t){},"406g":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingOnSyntax=void 0;var r=n("z4Hk"),i=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new r.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=i},"4cb6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.METADATA_KEY=void 0;var r=n("xfSm");t.METADATA_KEY=r;var i=n("9Fde");Object.defineProperty(t,"Container",{enumerable:!0,get:function(){return i.Container}});var o=n("FV85");Object.defineProperty(t,"BindingScopeEnum",{enumerable:!0,get:function(){return o.BindingScopeEnum}}),Object.defineProperty(t,"BindingTypeEnum",{enumerable:!0,get:function(){return o.BindingTypeEnum}}),Object.defineProperty(t,"TargetTypeEnum",{enumerable:!0,get:function(){return o.TargetTypeEnum}});var a=n("dxzI");Object.defineProperty(t,"AsyncContainerModule",{enumerable:!0,get:function(){return a.AsyncContainerModule}}),Object.defineProperty(t,"ContainerModule",{enumerable:!0,get:function(){return a.ContainerModule}});var c=n("cZ5Q");Object.defineProperty(t,"injectable",{enumerable:!0,get:function(){return c.injectable}});var s=n("0gSV");Object.defineProperty(t,"tagged",{enumerable:!0,get:function(){return s.tagged}});var u=n("ZzCi");Object.defineProperty(t,"named",{enumerable:!0,get:function(){return u.named}});var l=n("Yk9n");Object.defineProperty(t,"inject",{enumerable:!0,get:function(){return l.inject}}),Object.defineProperty(t,"LazyServiceIdentifer",{enumerable:!0,get:function(){return l.LazyServiceIdentifer}});var f=n("jYx5");Object.defineProperty(t,"optional",{enumerable:!0,get:function(){return f.optional}});var p=n("n2J3");Object.defineProperty(t,"unmanaged",{enumerable:!0,get:function(){return p.unmanaged}});var d=n("jIg/");Object.defineProperty(t,"multiInject",{enumerable:!0,get:function(){return d.multiInject}});var h=n("oaX6");Object.defineProperty(t,"targetName",{enumerable:!0,get:function(){return h.targetName}});var v=n("Sk89");Object.defineProperty(t,"postConstruct",{enumerable:!0,get:function(){return v.postConstruct}});var g=n("wnjb");Object.defineProperty(t,"MetadataReader",{enumerable:!0,get:function(){return g.MetadataReader}});var m=n("d9O0");Object.defineProperty(t,"id",{enumerable:!0,get:function(){return m.id}});var y=n("Ztfv");Object.defineProperty(t,"decorate",{enumerable:!0,get:function(){return y.decorate}});var b=n("RR/i");Object.defineProperty(t,"traverseAncerstors",{enumerable:!0,get:function(){return b.traverseAncerstors}}),Object.defineProperty(t,"taggedConstraint",{enumerable:!0,get:function(){return b.taggedConstraint}}),Object.defineProperty(t,"namedConstraint",{enumerable:!0,get:function(){return b.namedConstraint}}),Object.defineProperty(t,"typeConstraint",{enumerable:!0,get:function(){return b.typeConstraint}});var _=n("ujMp");Object.defineProperty(t,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return _.getServiceIdentifierAsString}});var E=n("78VC");Object.defineProperty(t,"multiBindToService",{enumerable:!0,get:function(){return E.multiBindToService}})},"4kj+":function(e,t){},"4kuk":function(e,t,n){var r=n("SfRM"),i=n("Hvzi"),o=n("u8Dt"),a=n("ekgI"),c=n("JSQU");function s(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=a,s.prototype.set=c,e.exports=s},"5Tg0":function(e,t,n){(function(e){var r=n("Kz5y"),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i?r.Buffer:void 0,c=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=c?c(n):new e.constructor(n);return e.copy(r),r}}).call(this,n("YuTi")(e))},"6AGu":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingInSyntax=void 0;var r=n("FV85"),i=n("LKzl"),o=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=o},"6NqC":function(e,t){},"6acW":function(e,t,n){var r=n("dt0z"),i=n("gQMU");e.exports=function(e){return i(r(e).toLowerCase())}},"6nK8":function(e,t,n){var r=n("dVn5"),i=n("fo6e"),o=n("dt0z"),a=n("9NmV");e.exports=function(e,t,n){return e=o(e),void 0===(t=n?void 0:t)?i(e)?a(e):r(e):e.match(t)||[]}},"6sVZ":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"77Zs":function(e,t,n){var r=n("Xi7e");e.exports=function(){this.__data__=new r,this.size=0}},"78VC":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=void 0,t.multiBindToService=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach(function(n){return e.bind(n).toService(t)})}}}},"7Ix3":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"7W2i":function(e,t,n){var r=n("SksO");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},"7tbW":function(e,t,n){var r=n("LGYb");e.exports=function(e){return e&&e.length?r(e):[]}},"8/Fi":function(e,t,n){"use strict";n("J4zp"),n("9nhX")},"88Gu":function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},"8OQS":function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(i[n]=e[n]);return i}},"8ml+":function(e,t,n){"use strict";var r=n("h1nZ");n.o(r,"Scene")&&n.d(t,"Scene",function(){return r.Scene});var i=n("kQ+U");n.d(t,"Scene",function(){return i.a}),n("k5/I"),n("Hel2"),n("RL2/")},"8uyu":function(e,t){},"9Fde":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(t){o(t)}}function c(e){try{s(r.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(c){o=[6,c],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;var o=n("LgvC"),a=n("MON2"),c=n("FV85"),s=n("xfSm"),u=n("wnjb"),l=n("h7MG"),f=n("aPG5"),p=n("gzZq"),d=n("d9O0"),h=n("ujMp"),v=n("HpQ9"),g=n("AwBQ"),m=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=c.BindingScopeEnum.Transient;else if(t.defaultScope!==c.BindingScopeEnum.Singleton&&t.defaultScope!==c.BindingScopeEnum.Transient&&t.defaultScope!==c.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=d.id(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new u.MetadataReader}return e.merge=function(t,n){var r=new e,i=l.getBindingDictionary(r),o=l.getBindingDictionary(t),a=l.getBindingDictionary(n);function c(e,t){e.traverse(function(e,n){n.forEach(function(e){t.add(e.serviceIdentifier,e.clone())})})}return c(o,i),c(a,i),r},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(this,void 0,void 0,function(){var t,n,r,o,a;return i(this,function(i){switch(i.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,i.label=1;case 1:return n<r.length?(a=t((o=r[n]).id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach(function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)})},e.prototype.bind=function(e){var t=new o.Binding(e,this.options.defaultScope||c.BindingScopeEnum.Transient);return this._bindingDictionary.add(e,t),new p.BindingToSyntax(t)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(a.CANNOT_UNBIND+" "+h.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new g.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,s.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=l.createMockRequest(this,e,t,n);r=i.some(function(e){return e.constraint(o)})}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(v.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(e,t){return t(e)},n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,c.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,c.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,s.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,c.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,c.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,s.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind.bind(e)(r);return t(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=e.bind.bind(e)(n);return t(r,i),r}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(r),unbindFunction:function(t){e.unbind.bind(e)(t)}};var i}},e.prototype._get=function(e,t,n,r,i,o){var c=null,s={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(c=this._middleware(s)))throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else c=this._planAndResolve()(s);return c},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=l.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),f.resolve(n)}},e}();t.Container=m},"9NmV":function(e,t){var n="a-z\\xdf-\\xf6\\xf8-\\xff",r="A-Z\\xc0-\\xd6\\xd8-\\xde",i="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",o="["+i+"]",a="\\d+",c="["+n+"]",s="[^\\ud800-\\udfff"+i+a+"\\u2700-\\u27bf"+n+r+"]",u="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",f="["+r+"]",p="(?:"+c+"|"+s+")",d="(?:"+f+"|"+s+")",h="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",v="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",g="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",m="[\\ufe0e\\ufe0f]?",y=m+g+"(?:\\u200d(?:"+["[^\\ud800-\\udfff]",u,l].join("|")+")"+m+g+")*",b="(?:"+["[\\u2700-\\u27bf]",u,l].join("|")+")"+y,_=RegExp([f+"?"+c+"+"+h+"(?="+[o,f,"$"].join("|")+")",d+"+"+v+"(?="+[o,f+p,"$"].join("|")+")",f+"?"+p+"+"+h,f+"+"+v,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",a,b].join("|"),"g");e.exports=function(e){return e.match(_)||[]}},"9nhX":function(e,t,n){var r=n("g4R6"),i=n("tLB3");e.exports=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=i(n))==n?n:0),void 0!==t&&(t=(t=i(t))==t?t:0),r(i(e),t,n)}},AFH1:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft"}(r||(r={}))},AP2z:function(e,t,n){var r=n("nmnc"),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,c=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(s){}var i=a.call(e);return r&&(t?e[c]=n:delete e[c]),i}},APxj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Ucsi");t.default=function(e,t){return void 0===t&&(t=!0),{lazyInject:r.makePropertyInjectDecorator(e,t),lazyInjectNamed:r.makePropertyInjectNamedDecorator(e,t),lazyInjectTagged:r.makePropertyInjectTaggedDecorator(e,t),lazyMultiInject:r.makePropertyMultiInjectDecorator(e,t)}}},AwBQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lookup=void 0;var r=n("MON2"),i=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(r.NULL_ARGUMENT);if(null==t)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(r.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(r.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach(function(n,r){var i=n.filter(function(t){return!e(t)});i.length>0?t._map.set(r,i):t._map.delete(r)})},e.prototype.hasKey=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach(function(e,n){e.forEach(function(e){return t.add(n,e.clone())})}),t},e.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},e}();t.Lookup=i},B8du:function(e,t){e.exports=function(){return!1}},BGjm:function(e,t){e.exports=function(e,t){t||(t=document);var n=t.head||t.getElementsByTagName("head")[0];if(!n){n=t.createElement("head");var r=t.body||t.getElementsByTagName("body")[0];r?r.parentNode.insertBefore(n,r):t.documentElement.appendChild(n)}var i=t.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),n.appendChild(i),i}},Bnag:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},BsWD:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("a3WO");function i(e,t){if(e){if("string"==typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},CZoQ:function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},Cwc5:function(e,t,n){var r=n("NKxu"),i=n("Npjl");e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},"D+ow":function(e,t){},D9lx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingInWhenOnSyntax=void 0;var r=n("6AGu"),i=n("406g"),o=n("z4Hk"),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=a},DSRE:function(e,t,n){(function(e){var r=n("Kz5y"),i=n("B8du"),o=t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,c=a&&a.exports===o?r.Buffer:void 0;e.exports=(c?c.isBuffer:void 0)||i}).call(this,n("YuTi")(e))},E2jh:function(e,t,n){var r,i=n("2gN3"),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},E3If:function(e,t,n){"use strict";n.r(t),n.d(t,"MonitorModule",function(){return we});var r,i,o,a,c,s=n("tyNb"),u=n("8ml+"),l=n("lwsE"),f=n.n(l),p=n("W8MJ"),d=n.n(p),h=n("7W2i"),v=n.n(h),g=n("a1gu"),m=n.n(g),y=n("Nsbk"),b=n.n(y),_=n("lSNA"),E=n.n(_),S=n("yG8O"),T=n.n(S),x=n("U+yc"),A=n.n(x),O=(n("1ABj"),n("h1nZ"));function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){E()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var I,P,C,R,M,N,L,j,D,F,B,U,z,G=(r=Object(O.lazyInject)(O.TYPES.ILogService),i=Object(O.lazyInject)(O.TYPES.IGlobalConfigService),o=function(){function e(t){f()(this,e),T()(this,"logger",a,this),T()(this,"configService",c,this),this.config=void 0,this.config=t}return d()(e,[{key:"setContainer",value:function(e,t){e.bind(O.TYPES.MapConfig).toConstantValue(k(k({},this.config),{},{id:t})),e.bind(O.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),a=A()(o.prototype,"logger",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=A()(o.prototype,"configService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o),V=n("o0o1"),H=n.n(V),X=n("QILm"),W=n.n(X),Y=n("yXPU"),Z=n.n(Y),q=n("hi0z"),K=n.n(q),Q=n("Hel2"),J=n("IOcx"),$=n("4cb6"),ee={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},te=n("J4zp"),ne=n.n(te),re=Math.PI/180,ie=function(){function e(){f()(this,e),this.projectionMatrix=J.b.create(),this.viewMatrix=J.b.create(),this.viewProjectionMatrix=J.b.create(),this.ViewProjectionMatrixUncentered=J.b.create(),this.viewUncenteredMatrix=J.b.create(),this.zoom=void 0,this.center=void 0}return d()(e,[{key:"syncWithMapCamera",value:function(e){var t=e.zoom,n=e.pitch,r=void 0===n?0:n,i=e.bearing,o=void 0===i?0:i,a=e.center,c=void 0===a?[0,0]:a,s=e.offsetOrigin,u=void 0===s?[0,0]:s,l=e.cameraHeight,f=void 0===l?1:l,p=e.aspect,d=void 0===p?1:p,h=e.near,v=void 0===h?.1:h,g=e.far,m=void 0===g?1e3:g,y=e.fov,b=void 0===y?0:y;this.zoom=void 0===t?1:t,this.center=c;var _=r*re,E=(360-o)*re;J.b.perspective(this.projectionMatrix,b,d,v,m);var S=J.d.fromValues(f*Math.sin(_)*Math.sin(E),-f*Math.sin(_)*Math.cos(E),f*Math.cos(_)),T=J.d.fromValues(-Math.cos(_)*Math.sin(E),Math.cos(_)*Math.cos(E),Math.sin(_));J.b.lookAt(this.viewMatrix,S,J.d.fromValues(0,0,0),T),this.viewUncenteredMatrix=J.b.clone(this.viewMatrix),J.b.translate(this.viewMatrix,this.viewMatrix,J.d.fromValues(-u[0],u[1],0)),J.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),J.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var e=ne()(this.center,2);return[e[0],e[1]]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(e,t){var n=85.0511287798,r=Math.max(Math.min(n,e[1]),-n),i=256<<20,o=Math.PI/180,a=e[0]*o,c=r*o;return c=Math.log(Math.tan(Math.PI/4+c/2)),[a=i*(.5/Math.PI*a+.5)-215440491,c=-(i*(-.5/Math.PI*c+(o=.5))-106744817)]}}]),e}();function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach(function(t){E()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n("BGjm")("/* @antv/l7-maps */\n.amap-logo{\n display: none !important;\n}\n");var ce=0;window.forceWebGL=!0;var se="15cd8a57710d40c9b7c0e3cc120f1200",ue=!1,le=[],fe=(I=Object($.injectable)(),P=Object($.inject)(O.TYPES.IGlobalConfigService),C=Object($.inject)(O.TYPES.ILogService),R=Object($.inject)(O.TYPES.MapConfig),M=Object($.inject)(O.TYPES.ICoordinateSystemService),N=Object($.inject)(O.TYPES.IEventEmitter),I((j=function(){function e(){var t=this;f()(this,e),this.map=void 0,T()(this,"configService",D,this),T()(this,"logger",F,this),T()(this,"config",B,this),T()(this,"coordinateSystemService",U,this),T()(this,"eventEmitter",z,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(e){var n=e.camera,r=n.fov,i=n.near,o=n.far,a=n.height,c=n.pitch,s=n.rotation,u=n.aspect,l=n.position,f=t.getCenter(),p=f.lng,d=f.lat;t.cameraChangedCallback&&(t.viewport.syncWithMapCamera({aspect:u,bearing:360-s,far:o,fov:r,cameraHeight:a,near:i,pitch:c,zoom:t.map.getZoom()-1,center:[p,d],offsetOrigin:[l.x,l.y]}),t.viewport.getZoom()>12?t.coordinateSystemService.setCoordinateSystem(O.CoordinateSystem.P20_OFFSET):t.coordinateSystemService.setCoordinateSystem(O.CoordinateSystem.P20),t.cameraChangedCallback(t.viewport))}}var t;return d()(e,[{key:"addMarkerContainer",value:function(){var e=this.map.getContainer();if(null!==e){var t=e.getElementsByClassName("amap-maps")[0];this.markerContainer=Q.a.create("div","l7-marker-container",t)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(e,t){-1!==O.MapServiceEvent.indexOf(e)?this.eventEmitter.on(e,t):this.map.on(e,t)}},{key:"off",value:function(e,t){-1!==O.MapServiceEvent.indexOf(e)?this.eventEmitter.off(e,t):this.map.off(e,t)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var e;return null===(e=this.map.getContainer())||void 0===e?void 0:e.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var e=this.map.getSize();return[e.getWidth(),e.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(e){return this.map.setZoom(e)}},{key:"getCenter",value:function(){var e=this.map.getCenter();return{lng:e.getLng(),lat:e.getLat()}}},{key:"setCenter",value:function(e){this.map.setCenter(e)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var e=this.map.getBounds().toBounds(),t=e.getNorthEast(),n=e.getSouthWest(),r=this.getCenter(),i=r.lng>t.getLng()||r.lng<n.getLng()?180-t.getLng():t.getLng();return[[r.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[i,t.getLat()]]}},{key:"getMinZoom",value:function(){return this.map.get("zooms")[0]-1}},{key:"getMaxZoom",value:function(){return this.map.get("zooms")[1]-1}},{key:"setRotation",value:function(e){return this.map.setRotation(e)}},{key:"setPitch",value:function(e){return this.map.setPitch(e)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(e){this.map.panTo(e)}},{key:"panBy",value:function(e){this.map.panTo(e)}},{key:"fitBounds",value:function(e){this.map.setBounds(new AMap.Bounds([e[0][0],e[0][1],e[1][0],e[1][1]]))}},{key:"setZoomAndCenter",value:function(e,t){this.map.setZoomAndCenter(e,t)}},{key:"setMapStyle",value:function(e){this.map.setMapStyle(this.getMapStyle(e))}},{key:"setMapStatus",value:function(e){this.map.setStatus(e)}},{key:"pixelToLngLat",value:function(e){var t=this.map.pixelToLngLat(new AMap.Pixel(e[0],e[1]));return{lng:t.getLng(),lat:t.getLat()}}},{key:"lngLatToPixel",value:function(e){var t=this.map.lnglatToPixel(new AMap.LngLat(e[0],e[1]));return{x:t.getX(),y:t.getY()}}},{key:"containerToLngLat",value:function(e){var t=new AMap.Pixel(e[0],e[1]),n=this.map.containerToLngLat(t);return{lng:null==n?void 0:n.getLng(),lat:null==n?void 0:n.getLat()}}},{key:"lngLatToContainer",value:function(e){var t=new AMap.LngLat(e[0],e[1]),n=this.map.lngLatToContainer(t);return{x:n.getX(),y:n.getY()}}},{key:"lngLatToMercator",value:function(e,t){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=this.viewport.projectFlat(e),o=J.b.create();return J.b.translate(o,o,J.d.fromValues(i[0],i[1],t)),J.b.scale(o,o,J.d.fromValues(r[0],r[1],r[2])),J.b.rotateX(o,o,n[0]),J.b.rotateY(o,o,n[1]),J.b.rotateZ(o,o,n[2]),o}},{key:"init",value:(t=Z()(H.a.mark(function e(){var t,n,r,i,o,a,c,s,u,l,f,p,d,h,v=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this.config).id,i=void 0===(r=t.style)?"light":r,a=void 0===(o=t.minZoom)?0:o,s=void 0===(c=t.maxZoom)?18:c,l=void 0===(u=t.token)?se:u,f=t.mapInstance,d=void 0===(p=t.plugin)?[]:p,h=W()(t,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),e.next=3,new Promise(function(e){var t=function(){if(f)v.map=f,v.$mapContainer=v.map.getContainer(),setTimeout(function(){v.map.on("camerachange",v.handleCameraChanged),e()},30);else{v.$mapContainer=v.creatAmapContainer(n);var t=new AMap.Map(v.$mapContainer,ae({mapStyle:v.getMapStyle(i),zooms:[a,s],viewMode:"3D"},h));t.on("camerachange",v.handleCameraChanged),v.map=t,setTimeout(function(){e()},10)}};ue||f?ue&&window.AMap||f?t():le.push(t):(l===se&&v.logger.warn(v.configService.getSceneWarninfo("MapToken")),ue=!0,d.push("Map3D"),K.a.load({key:l,version:"1.4.15",plugins:d}).then(function(e){t(),le.length&&(le.forEach(function(e){return e()}),le=[])}).catch(function(e){throw new Error(e)}))});case 3:this.viewport=new ie;case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"exportMap",value:function(e){var t,n=null===(t=this.getContainer())||void 0===t?void 0:t.getElementsByClassName("amap-layer")[0];return"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png")}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).emit.apply(t,[e].concat(r))}},{key:"once",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).once.apply(t,[e].concat(r))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var e=document.getElementById("amap-script");e&&document.head.removeChild(e)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(e){this.cameraChangedCallback=e}},{key:"getMapStyle",value:function(e){return ee[e]?ee[e]:e}},{key:"creatAmapContainer",value:function(e){var t=e;"string"==typeof e&&(t=document.getElementById(e));var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    ",n.id="l7_amap_div"+ce++,t.appendChild(n),n}}]),e}(),D=A()(j.prototype,"configService",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=A()(j.prototype,"logger",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=A()(j.prototype,"config",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=A()(j.prototype,"coordinateSystemService",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=A()(j.prototype,"eventEmitter",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=j))||L),pe=function(e){v()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=b()(t);if(n){var i=b()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return m()(this,e)});function i(){return f()(this,i),r.apply(this,arguments)}return d()(i,[{key:"getServiceConstructor",value:function(){return fe}}]),i}(G),de=n("ma/q"),he=n("/KA4"),ve=n("fXoL"),ge=n("3Pt+"),me=n("B+r4"),ye=n("JA5x"),be=n("A07A"),_e=n("eHCX"),Ee=n("ofXK");const Se=function(){return[16,16]},Te=function(){return[40,16]},xe=[{path:"",component:(()=>{class e{constructor(e,t){this.fb=e,this.ngZone=t,this.deadline=Date.now()+1728e5+3e4,this.miniAreaData=[264,274,284,294,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470],this.wordCloudData=[{x:"China",value:138322e4,category:"asia"},{x:"India",value:1316e6,category:"asia"},{x:"United States",value:324982e3,category:"america"},{x:"Indonesia",value:26351e4,category:"asia"},{x:"Brazil",value:207505e3,category:"america"},{x:"Pakistan",value:196459e3,category:"asia"},{x:"Nigeria",value:191836e3,category:"africa"},{x:"Bangladesh",value:162459e3,category:"asia"},{x:"Russia",value:146804372,category:"europe"},{x:"Japan",value:12679e4,category:"asia"},{x:"Mexico",value:123518e3,category:"america"},{x:"Ethiopia",value:104345e3,category:"africa"},{x:"Philippines",value:104037e3,category:"asia"},{x:"Egypt",value:93013300,category:"africa"},{x:"Vietnam",value:927e5,category:"asia"},{x:"Germany",value:828e5,category:"europe"},{x:"Democratic Republic of the Congo",value:82243e3,category:"africa"},{x:"Iran",value:80135400,category:"asia"},{x:"Turkey",value:79814871,category:"asia"},{x:"Thailand",value:68298e3,category:"asia"},{x:"France",value:67013e3,category:"europe"},{x:"United Kingdom",value:6511e4,category:"europe"},{x:"Italy",value:60599936,category:"europe"},{x:"Tanzania",value:56878e3,category:"africa"},{x:"South Africa",value:55908e3,category:"africa"},{x:"Myanmar",value:54836e3,category:"asia"},{x:"South Korea",value:51446201,category:"asia"},{x:"Colombia",value:49224700,category:"america"},{x:"Kenya",value:48467e3,category:"africa"},{x:"Spain",value:46812e3,category:"europe"},{x:"Argentina",value:4385e4,category:"america"},{x:"Ukraine",value:42541633,category:"europe"},{x:"Sudan",value:42176e3,category:"africa"},{x:"Uganda",value:41653e3,category:"africa"},{x:"Algeria",value:41064e3,category:"africa"},{x:"Poland",value:38424e3,category:"europe"},{x:"Iraq",value:37883543,category:"asia"},{x:"Canada",value:36541e3,category:"america"},{x:"Morocco",value:34317500,category:"africa"},{x:"Saudi Arabia",value:33710021,category:"asia"},{x:"Uzbekistan",value:32121e3,category:"asia"},{x:"Malaysia",value:32063200,category:"asia"},{x:"Peru",value:31826018,category:"america"},{x:"Venezuela",value:31431164,category:"america"},{x:"Nepal",value:28825709,category:"asia"},{x:"Angola",value:28359634,category:"africa"},{x:"Ghana",value:28308301,category:"africa"},{x:"Yemen",value:2812e4,category:"asia"},{x:"Afghanistan",value:27657145,category:"asia"},{x:"Mozambique",value:27128530,category:"africa"},{x:"Australia",value:24460900,category:"australia"},{x:"North Korea",value:24213510,category:"asia"},{x:"Taiwan",value:23545680,category:"asia"},{x:"Cameroon",value:23248044,category:"africa"},{x:"Ivory Coast",value:22671331,category:"africa"},{x:"Madagascar",value:22434363,category:"africa"},{x:"Niger",value:21564e3,category:"africa"},{x:"Sri Lanka",value:21203e3,category:"asia"},{x:"Romania",value:1976e4,category:"europe"},{x:"Burkina Faso",value:19632147,category:"africa"},{x:"Syria",value:18907e3,category:"asia"},{x:"Mali",value:18875e3,category:"africa"},{x:"Malawi",value:18299e3,category:"africa"},{x:"Chile",value:18191900,category:"america"},{x:"Kazakhstan",value:17975800,category:"asia"},{x:"Netherlands",value:17121900,category:"europe"},{x:"Ecuador",value:16737700,category:"america"},{x:"Guatemala",value:16176133,category:"america"},{x:"Zambia",value:15933883,category:"africa"},{x:"Cambodia",value:15626444,category:"asia"},{x:"Senegal",value:15256346,category:"africa"},{x:"Chad",value:14965e3,category:"africa"},{x:"Zimbabwe",value:14542235,category:"africa"},{x:"Guinea",value:13291e3,category:"africa"},{x:"South Sudan",value:12131e3,category:"africa"},{x:"Rwanda",value:11553188,category:"africa"},{x:"Belgium",value:11356191,category:"europe"}]}initDashBoard(){new de.Gauge("dashBoard",{percent:.75,autoFit:!0,height:180,range:{color:"#30BF78"},indicator:{pointer:{style:{stroke:"#D0D0D0"}},pin:{style:{stroke:"#D0D0D0"}}},axis:{label:{formatter:e=>100*Number(e)},subTickLine:{count:3}},statistic:{content:{formatter:()=>"87 %"}}}).render()}initArea(){new de.TinyArea("miniArea",{height:120,autoFit:!0,data:this.miniAreaData,smooth:!0,areaStyle:{fill:"#d6e3fd"},annotations:[{type:"line",start:["min","mean"],end:["max","mean"],text:{content:"400\u4ebf\u5143",offsetY:-2,style:{textAlign:"left",fontSize:10,textBaseline:"bottom"}},style:{}},{type:"line",start:["min",800],end:["max",800],text:{content:"1400\u4ebf\u5143",offsetY:-2,style:{textAlign:"left",fontSize:10,textBaseline:"bottom"}},style:{}}]}).render()}initLiquidPlot(){new de.Liquid("liquidPlot",{percent:.25,outline:{border:4,distance:8},wave:{length:128}}).render()}wordCloud(){const e=new de.WordCloud("wordCloud",{data:this.wordCloudData,wordField:"x",weightField:"value",wordStyle:{fontFamily:"Verdana",fontSize:[24,80]},interactions:[{type:"element-active"}],state:{active:{style:{lineWidth:3}}}});Object(he.f)().subscribe(()=>{e.render()})}initRingProgress(e){new de.RingProgress("ringProgress"+e,{height:100,width:100,autoFit:!1,percent:.7,color:["#5B8FF9","#E8EDF3"]}).render()}ngAfterViewInit(){Object(he.f)().subscribe(()=>{this.ngZone.runOutsideAngular(()=>{this.initDashBoard(),this.initArea(),this.initLiquidPlot();for(let e=1;e<=3;e++)this.initRingProgress(e);this.wordCloud(),new u.Scene({id:"map",logoPosition:"bottomright",antialias:!1,map:new pe({pitch:0,style:"dark",center:[112,23.69],zoom:2.5})})})})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(ve.Nb(ge.e),ve.Nb(ve.z))},e.\u0275cmp=ve.Hb({type:e,selectors:[["app-monitor"]],decls:46,vars:67,consts:[[1,"content-wrap"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],["nzTitle","\u6d3b\u52a8\u5b9e\u65f6\u4ea4\u6613\u60c5\u51b5"],[3,"nzGutter"],[3,"nzSpan"],[3,"nzValue","nzTitle"],[3,"nzValue","nzTitle","nzFormat"],["nz-col","","nzSpan","24",2,"min-height","430px"],["id","map"],[1,"card-wrap-line"],["nzTitle","\u6d3b\u52a8\u60c5\u51b5\u9884\u6d4b"],[1,"card-top"],["nz-typography","","nzType","secondary"],[1,"title"],["id","miniArea"],["nzTitle","\u5238\u6838\u6548\u7387",1,"m-t-15"],["id","dashBoard"],["nzTitle","\u5404\u54c1\u7c7b\u5360\u6bd4"],["nz-row",""],["nz-col","","nzSpan","8","id","ringProgress1",1,"pipe-height","center"],["nz-col","","nzSpan","8","id","ringProgress2",1,"pipe-height","center"],["nz-col","","nzSpan","8","id","ringProgress3",1,"pipe-height","center"],["nz-col","",3,"nzXl","nzXXl","nzLg","nzMd","nzSm","nzXs"],["nzTitle","\u70ed\u95e8\u641c\u7d22"],["id","wordCloud",1,"pipe-height"],["nzTitle","\u8d44\u6e90\u5269\u4f59"],["id","liquidPlot",1,"pipe-height"]],template:function(e,t){1&e&&(ve.Tb(0,"section",0),ve.Tb(1,"section",1),ve.Tb(2,"div",2),ve.Tb(3,"nz-card",3),ve.Tb(4,"div",1),ve.Tb(5,"div",2),ve.Tb(6,"nz-row",4),ve.Tb(7,"nz-col",5),ve.Ob(8,"nz-statistic",6),ve.ec(9,"number"),ve.Sb(),ve.Tb(10,"nz-col",5),ve.Ob(11,"nz-statistic",6),ve.ec(12,"percent"),ve.Sb(),ve.Sb(),ve.Sb(),ve.Tb(13,"div",2),ve.Tb(14,"nz-row",4),ve.Tb(15,"nz-col",5),ve.Ob(16,"nz-countdown",7),ve.Sb(),ve.Tb(17,"nz-col",5),ve.Ob(18,"nz-statistic",6),ve.ec(19,"number"),ve.Sb(),ve.Sb(),ve.Sb(),ve.Tb(20,"div",8),ve.Ob(21,"div",9),ve.Sb(),ve.Sb(),ve.Sb(),ve.Sb(),ve.Tb(22,"div",2),ve.Tb(23,"div",10),ve.Tb(24,"nz-card",11),ve.Tb(25,"div",12),ve.Tb(26,"div",13),ve.Hc(27,"\u76ee\u6807\u8bc4\u4f30"),ve.Sb(),ve.Tb(28,"div",14),ve.Hc(29,"\u6709\u671b\u8fbe\u5230\u9884\u671f"),ve.Sb(),ve.Sb(),ve.Tb(30,"div"),ve.Ob(31,"div",15),ve.Sb(),ve.Sb(),ve.Tb(32,"nz-card",16),ve.Ob(33,"div",17),ve.Sb(),ve.Sb(),ve.Sb(),ve.Tb(34,"div",2),ve.Tb(35,"nz-card",18),ve.Tb(36,"div",19),ve.Ob(37,"div",20),ve.Ob(38,"div",21),ve.Ob(39,"div",22),ve.Sb(),ve.Sb(),ve.Sb(),ve.Tb(40,"div",23),ve.Tb(41,"nz-card",24),ve.Ob(42,"div",25),ve.Sb(),ve.Sb(),ve.Tb(43,"div",23),ve.Tb(44,"nz-card",26),ve.Ob(45,"div",27),ve.Sb(),ve.Sb(),ve.Sb(),ve.Sb()),2&e&&(ve.zb(1),ve.kc("nzGutter",ve.nc(65,Se)),ve.zb(1),ve.kc("nzXXl",18)("nzXl",18)("nzLg",24)("nzMd",24)("nzSm",24)("nzXs",24),ve.zb(2),ve.kc("nzGutter",ve.nc(66,Te)),ve.zb(1),ve.kc("nzXXl",12)("nzXl",12)("nzLg",12)("nzMd",12)("nzSm",24)("nzXs",24),ve.zb(1),ve.kc("nzGutter",16),ve.zb(1),ve.kc("nzSpan",12),ve.zb(1),ve.kc("nzValue",ve.fc(9,59,124543233)+"\u5143")("nzTitle","\u4eca\u65e5\u4ea4\u6613\u603b\u989d"),ve.zb(2),ve.kc("nzSpan",12),ve.zb(1),ve.kc("nzValue",ve.fc(12,61,.92))("nzTitle","\u9500\u552e\u76ee\u6807\u5b8c\u6210\u7387"),ve.zb(2),ve.kc("nzXXl",12)("nzXl",12)("nzLg",12)("nzMd",12)("nzSm",24)("nzXs",24),ve.zb(1),ve.kc("nzGutter",16),ve.zb(1),ve.kc("nzSpan",12),ve.zb(1),ve.kc("nzValue",t.deadline)("nzTitle","\u6d3b\u52a8\u5269\u4f59\u65f6\u95f4")("nzFormat","HH:mm:ss:SSS"),ve.zb(1),ve.kc("nzSpan",12),ve.zb(1),ve.kc("nzValue",ve.fc(19,63,234)+"\u5143")("nzTitle","\u6bcf\u79d2\u4ea4\u6613\u603b\u989d"),ve.zb(4),ve.kc("nzXXl",6)("nzXl",6)("nzLg",24)("nzMd",24)("nzSm",24)("nzXs",24),ve.zb(12),ve.kc("nzXXl",12)("nzXl",12)("nzLg",24)("nzMd",24)("nzSm",24)("nzXs",24),ve.zb(6),ve.kc("nzXl",6)("nzXXl",6)("nzLg",12)("nzMd",24)("nzSm",24)("nzXs",24),ve.zb(3),ve.kc("nzXl",6)("nzXXl",6)("nzLg",12)("nzMd",24)("nzSm",24)("nzXs",24))},directives:[me.c,me.a,ye.a,be.b,be.a,_e.a],pipes:[Ee.f,Ee.v],styles:[".content-wrap[_ngcontent-%COMP%]{width:100%;padding:24px}.card-wrap-line[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;height:100%}.card-top[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:24px}.pipe-height[_ngcontent-%COMP%]{height:180px}#map[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}"],changeDetection:0}),e})(),data:{title:"\u76d1\u63a7\u9875",key:"monitor"}}];let Ae=(()=>{class e{}return e.\u0275mod=ve.Lb({type:e}),e.\u0275inj=ve.Kb({factory:function(t){return new(t||e)},imports:[[s.n.forChild(xe)],s.n]}),e})();var Oe=n("yCTO");let we=(()=>{class e{}return e.\u0275mod=ve.Lb({type:e}),e.\u0275inj=ve.Kb({factory:function(t){return new(t||e)},imports:[[Oe.a,Ae]]}),e})()},EA7m:function(e,t,n){var r=n("zZ0H"),i=n("Ioao"),o=n("wclG");e.exports=function(e,t){return o(i(e,t,r),e+"")}},EbDI:function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},EfZ0:function(e,t,n){},Em2t:function(e,t,n){var r=n("bahg"),i=n("quyA"),o=n("0JQy");e.exports=function(e){return i(e)?o(e):r(e)}},EpBk:function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},ExA7:function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},FI6e:function(e,t){},FV85:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetTypeEnum=t.BindingTypeEnum=t.BindingScopeEnum=void 0,t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},GXnB:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=n("xfSm"),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=i},GoyQ:function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},H8j4:function(e,t,n){var r=n("QkVE");e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},Hel2:function(e,t,n){"use strict";n.d(t,"k",function(){return D}),n.d(t,"l",function(){return F}),n.d(t,"h",function(){return B}),n.d(t,"b",function(){return z}),n.d(t,"g",function(){return G}),n.d(t,"i",function(){return V}),n.d(t,"j",function(){return H}),n.d(t,"e",function(){return U}),n.d(t,"d",function(){return X}),n.d(t,"f",function(){return W}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i});var r={};n.r(r),n.d(r,"getContainer",function(){return s}),n.d(r,"trim",function(){return u}),n.d(r,"splitWords",function(){return l}),n.d(r,"create",function(){return f}),n.d(r,"remove",function(){return p}),n.d(r,"addClass",function(){return d}),n.d(r,"removeClass",function(){return h}),n.d(r,"hasClass",function(){return v}),n.d(r,"setClass",function(){return g}),n.d(r,"getClass",function(){return m}),n.d(r,"empty",function(){return y}),n.d(r,"setTransform",function(){return _}),n.d(r,"triggerResize",function(){return E}),n.d(r,"printCanvas",function(){return S}),n.d(r,"getViewPortScale",function(){return T}),n.d(r,"DPR",function(){return x});var i={};n.r(i),n.d(i,"sum",function(){return q}),n.d(i,"max",function(){return Y}),n.d(i,"min",function(){return Z}),n.d(i,"mean",function(){return K}),n.d(i,"mode",function(){return Q}),n.d(i,"statMap",function(){return J}),n.d(i,"getColumn",function(){return $}),n.d(i,"getSatByColumn",function(){return ee});var o=n("J4zp"),a=n.n(o),c=window.document.documentElement.style;function s(e){var t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}function u(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function l(e){return u(e).split(/\s+/)}function f(e,t,n){var r=document.createElement(e);return r.className=t||"",n&&n.appendChild(r),r}function p(e){var t=e.parentNode;t&&t.removeChild(e)}function d(e,t){if(void 0!==e.classList)for(var n=l(t),r=0,i=n.length;r<i;r++)e.classList.add(n[r]);else if(!v(e,t)){var o=m(e);g(e,(o?o+" ":"")+t)}}function h(e,t){void 0!==e.classList?e.classList.remove(t):g(e,u((" "+m(e)+" ").replace(" "+t+" "," ")))}function v(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=m(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function g(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function m(e){return e instanceof SVGElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function y(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var b=function(e){if(!c)return e[0];for(var t in e)if(e[t]&&e[t]in c)return e[t];return e[0]}(["transform","WebkitTransform"]);function _(e,t){e.style[b]=t}function E(){if("function"==typeof Event)window.dispatchEvent(new Event("resize"));else{var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}}function S(e){var t=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log("%c\n",t.join(""))}function T(){var e,t=document.querySelector('meta[name="viewport"]');if(!t)return 1;var n=(null===(e=t.content)||void 0===e?void 0:e.split(",")).find(function(e){var t=e.split("=");return"initial-scale"===a()(t,2)[0]});return n?1*n.split("=")[1]:1}var x=T()<1?1:window.devicePixelRatio,A=n("lwsE"),O=n.n(A),w=n("W8MJ"),k=n.n(w),I=n("7W2i"),P=n.n(I),C=n("a1gu"),R=n.n(C),M=n("Nsbk"),N=n.n(M),L=n("oShl");!function(e){P()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=N()(t);if(n){var i=N()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return R()(this,e)});function i(e,t,n){var o;return O()(this,i),(o=r.call(this,e)).status=void 0,o.url=void 0,o.status=t,o.url=n,o.name=o.constructor.name,o.message=e,o}k()(i,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}])}(n.n(L)()(Error));var j=n("0wsv");function D(e,t,n){var r=Object(j.a)(t[1]-e[1]),i=Object(j.a)(t[0]-e[0]),o=Object(j.a)(e[1]),a=Object(j.a)(t[1]),c=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(o)*Math.cos(a);return Object(j.b)(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),"meters")}function F(e,t){var n=Math.abs(e[1][1]-e[0][1])*t,r=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-r,e[0][1]-n],[e[1][0]+r,e[1][1]+n]]}function B(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}Math;var U,z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0;O()(this,e),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=t,this.destroy=n||this.defaultDestroy,this.order=[],this.clear()}return k()(e,[{key:"clear",value:function(){var e=this;this.order.forEach(function(t){e.delete(t)}),this.cache={},this.order=[]}},{key:"get",value:function(e){var t=this.cache[e];return t&&(this.deleteOrder(e),this.appendOrder(e)),t}},{key:"set",value:function(e,t){this.cache[e]?(this.delete(e),this.cache[e]=t,this.appendOrder(e)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[e]=t,this.appendOrder(e))}},{key:"delete",value:function(e){var t=this.cache[e];t&&(this.deleteCache(e),this.deleteOrder(e),this.destroy(t,e))}},{key:"deleteCache",value:function(e){delete this.cache[e]}},{key:"deleteOrder",value:function(e){var t=this.order.findIndex(function(t){return t===e});t>=0&&this.order.splice(t,1)}},{key:"appendOrder",value:function(e){this.order.push(e)}},{key:"defaultDestroy",value:function(e,t){return null}}]),e}();function G(e,t){e.forEach(function(e){t[e]&&(t[e]=t[e].bind(t))})}function V(e){return(e&&e[0])+256*(e&&e[1])+65536*(e&&e[2])-1}function H(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}n("FmoU"),function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e.LEFT="left",e.RIGHT="right"}(U||(U={}));var X={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function W(e,t,n){var r=e.classList;for(var i in X)X.hasOwnProperty(i)&&r.remove("l7-".concat(n,"-anchor-").concat(i));r.add("l7-".concat(n,"-anchor-").concat(t))}function Y(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return 1*t}function Z(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return 1*t}function q(e){if(0===e.length)return 0;for(var t=1*e[0],n=1;n<e.length;n++)t+=1*e[n];return t}function K(e){if(0===e.length)throw new Error("mean requires at least one data point");return q(e)/e.length}function Q(e){if(0===e.length)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var t=e[0],n=NaN,r=0,i=1,o=1;o<e.length+1;o++)e[o]!==t?(i>r&&(r=i,n=t),i=1,t=e[o]):i++;return 1*n}var J={min:Z,max:Y,mean:K,sum:q,mode:Q};function $(e,t){return e.map(function(e){return e[t]})}function ee(e,t){return J[e](t)}},HpQ9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerSnapshot=void 0;var r=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}();t.ContainerSnapshot=r},HthE:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET"}(r||(r={}))},Hvzi:function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},Ijbi:function(e,t,n){var r=n("WkPL");e.exports=function(e){if(Array.isArray(e))return r(e)}},Ioao:function(e,t,n){var r=n("heNW"),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,c=i(o.length-t,0),s=Array(c);++a<c;)s[a]=o[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=o[a];return u[t]=n(s),r(e,this,u)}}},J2iB:function(e,t){e.exports=function(e){return null==e}},J4zp:function(e,t,n){var r=n("wTVA"),i=n("m0LI"),o=n("ZhPi"),a=n("wkBT");e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},J7lC:function(e,t){},JHRd:function(e,t,n){var r=n("Kz5y");e.exports=r.Uint8Array},JHgL:function(e,t,n){var r=n("QkVE");e.exports=function(e){return r(this,e).get(e)}},JSQU:function(e,t,n){var r=n("YESw");e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},JTzB:function(e,t,n){var r=n("NykK"),i=n("ExA7");e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},KMkd:function(e,t){e.exports=function(){this.__data__=[],this.size=0}},KfNM:function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},KwMD:function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},KxBF:function(e,t){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},Kz5y:function(e,t,n){var r=n("WFqU"),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},L56e:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["mapload"]},L8xA:function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},LGYb:function(e,t,n){var r=n("1hJj"),i=n("jbM+"),o=n("Xt/L"),a=n("xYSL"),c=n("dQpi"),s=n("rEGp");e.exports=function(e,t,n){var u=-1,l=i,f=e.length,p=!0,d=[],h=d;if(n)p=!1,l=o;else if(f>=200){var v=t?null:c(e);if(v)return s(v);p=!1,l=a,h=new r}else h=t?[]:d;e:for(;++u<f;){var g=e[u],m=t?t(g):g;if(g=n||0!==g?g:0,p&&m==m){for(var y=h.length;y--;)if(h[y]===m)continue e;t&&h.push(m),d.push(g)}else l(h,m,n)||(h!==d&&h.push(m),d.push(g))}return d}},LKzl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingWhenOnSyntax=void 0;var r=n("406g"),i=n("z4Hk"),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=o},LcsW:function(e,t,n){var r=n("kekF")(Object.getPrototypeOf,Object);e.exports=r},LgvC:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Binding=void 0;var r=n("FV85"),i=n("d9O0"),o=function(){function e(e,t){this.id=i.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=o},LsHQ:function(e,t,n){var r=n("EA7m"),i=n("mv/X");e.exports=function(e){return r(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,c=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,c&&i(n[0],n[1],c)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,a)}return t})}},MMmD:function(e,t,n){var r=n("lSCD"),i=n("shjB");e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},MON2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STACK_OVERFLOW=t.CIRCULAR_DEPENDENCY_IN_FACTORY=t.POST_CONSTRUCT_ERROR=t.MULTIPLE_POST_CONSTRUCT_METHODS=t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=t.ARGUMENTS_LENGTH_MISMATCH=t.INVALID_DECORATOR_OPERATION=t.INVALID_TO_SELF_VALUE=t.INVALID_FUNCTION_BINDING=t.INVALID_MIDDLEWARE_RETURN=t.NO_MORE_SNAPSHOTS_AVAILABLE=t.INVALID_BINDING_TYPE=t.NOT_IMPLEMENTED=t.CIRCULAR_DEPENDENCY=t.UNDEFINED_INJECT_ANNOTATION=t.MISSING_INJECT_ANNOTATION=t.MISSING_INJECTABLE_ANNOTATION=t.NOT_REGISTERED=t.CANNOT_UNBIND=t.AMBIGUOUS_MATCH=t.KEY_NOT_FOUND=t.NULL_ARGUMENT=t.DUPLICATED_METADATA=t.DUPLICATED_INJECTABLE_DECORATOR=void 0,t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(e,t,n){var r=n("hypo"),i=n("ljhN"),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];o.call(e,t)&&i(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},NKxu:function(e,t,n){var r=n("lSCD"),i=n("E2jh"),o=n("GoyQ"),a=n("3Fdi"),c=/^\[object .+?Constructor\]$/,s=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?s:c).test(a(e))}},Npjl:function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},Nsbk:function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},NykK:function(e,t,n){var r=n("nmnc"),i=n("AP2z"),o=n("KfNM"),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},O0oS:function(e,t,n){var r=n("Cwc5"),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=i},O1je:function(e,t){},PJYZ:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},PSsN:function(e,t){},PUg6:function(e,t,n){"use strict";var r;!function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"}(r||(r={}))},Q1l4:function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},QGbF:function(e,t){},QILm:function(e,t,n){var r=n("8OQS");e.exports=function(e,t){if(null==e)return{};var n,i,o=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t.indexOf(n=a[i])>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},QcOe:function(e,t,n){var r=n("GoyQ"),i=n("6sVZ"),o=n("7Ix3"),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var c in e)("constructor"!=c||!t&&a.call(e,c))&&n.push(c);return n}},QkVE:function(e,t,n){var r=n("EpBk");e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},QkVN:function(e,t,n){var r=n("+Qka"),i=n("LsHQ")(function(e,t,n){r(e,t,n)});e.exports=i},"R/W3":function(e,t,n){var r=n("KwMD"),i=n("2ajD"),o=n("CZoQ");e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},RIqP:function(e,t,n){var r=n("Ijbi"),i=n("EbDI"),o=n("ZhPi"),a=n("Bnag");e.exports=function(e){return r(e)||i(e)||o(e)||a()}},"RL2/":function(e,t,n){},RMtq:function(e,t){},"RR/i":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeConstraint=t.namedConstraint=t.taggedConstraint=t.traverseAncerstors=void 0;var r=n("xfSm"),i=n("GXnB"),o=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||o(n,t))};t.traverseAncerstors=o;var a=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new i.Metadata(e,t),n}};t.taggedConstraint=a;var c=a(r.NAMED_TAG);t.namedConstraint=c,t.typeConstraint=function(e){return function(t){return null!==t&&("string"==typeof e?t.bindings[0].serviceIdentifier===e:e===t.bindings[0].implementationType)}}},SfRM:function(e,t,n){var r=n("YESw");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},Sk89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postConstruct=void 0;var r=n("MON2"),i=n("xfSm"),o=n("GXnB");t.postConstruct=function(){return function(e,t,n){var a=new o.Metadata(i.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,e.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,e.constructor)}}},SksO:function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},T1AV:function(e,t,n){var r=n("t2Dn"),i=n("5Tg0"),o=n("yP5f"),a=n("Q1l4"),c=n("+iFO"),s=n("03A+"),u=n("Z0cm"),l=n("3L66"),f=n("DSRE"),p=n("lSCD"),d=n("GoyQ"),h=n("YO3V"),v=n("c6wG"),g=n("itsj"),m=n("jeLo");e.exports=function(e,t,n,y,b,_,E){var S=g(e,n),T=g(t,n),x=E.get(T);if(x)r(e,n,x);else{var A=_?_(S,T,n+"",e,t,E):void 0,O=void 0===A;if(O){var w=u(T),k=!w&&f(T),I=!w&&!k&&v(T);A=T,w||k||I?u(S)?A=S:l(S)?A=a(S):k?(O=!1,A=i(T,!0)):I?(O=!1,A=o(T,!0)):A=[]:h(T)||s(T)?(A=S,s(S)?A=m(S):d(S)&&!p(S)||(A=c(T))):O=!1}O&&(E.set(T,A),b(A,T,y,_,E),E.delete(T)),r(e,n,A)}}},TKrE:function(e,t,n){var r=n("qRkn"),i=n("dt0z"),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,a=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(o,r).replace(a,"")}},"U+yc":function(e,t){e.exports=function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}},U8pU:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",function(){return r})},"UNi/":function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},Ucsi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Symbol.for("INJECTION");function i(e,t,n,i){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return i&&!Reflect.hasMetadata(r,this,t)&&Reflect.defineMetadata(r,n(),this,t),Reflect.hasMetadata(r,this,t)?Reflect.getMetadata(r,this,t):n()},set:function(e){Reflect.defineMetadata(r,e,this,t)}})}t.makePropertyInjectDecorator=function(e,t){return function(n){return function(r,o){i(r,o,function(){return e.get(n)},t)}}},t.makePropertyInjectNamedDecorator=function(e,t){return function(n,r){return function(o,a){i(o,a,function(){return e.getNamed(n,r)},t)}}},t.makePropertyInjectTaggedDecorator=function(e,t){return function(n,r,o){return function(a,c){i(a,c,function(){return e.getTagged(n,r,o)},t)}}},t.makePropertyMultiInjectDecorator=function(e,t){return function(n){return function(r,o){i(r,o,function(){return e.getAll(n)},t)}}}},V1cb:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"}(r||(r={}))},VaNO:function(e,t){e.exports=function(e){return this.__data__.has(e)}},W8MJ:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},WFqU:function(e,t){var n="object"==typeof global&&global&&global.Object===Object&&global;e.exports=n},WkPL:function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},Xi7e:function(e,t,n){var r=n("KMkd"),i=n("adU4"),o=n("tMB7"),a=n("+6XX"),c=n("Z8oC");function s(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=a,s.prototype.set=c,e.exports=s},"Xt/L":function(e,t){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},YESw:function(e,t,n){var r=n("Cwc5")(Object,"create");e.exports=r},YO3V:function(e,t,n){var r=n("NykK"),i=n("LcsW"),o=n("ExA7"),a=Function.prototype.toString,c=Object.prototype.hasOwnProperty,s=a.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&a.call(n)==s}},Yk9n:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.LazyServiceIdentifer=void 0;var r=n("MON2"),i=n("xfSm"),o=n("GXnB"),a=n("Ztfv"),c=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=c,t.inject=function(e){return function(t,n,c){if(void 0===e)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(t.name));var s=new o.Metadata(i.INJECT_TAG,e);"number"==typeof c?a.tagParameter(t,n,c,s):a.tagProperty(t,n,s)}}},Z0cm:function(e,t){e.exports=Array.isArray},Z8oC:function(e,t,n){var r=n("y1pI");e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},ZhPi:function(e,t,n){var r=n("WkPL");e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},Ztfv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tagProperty=t.tagParameter=t.decorate=void 0;var r=n("MON2"),i=n("xfSm");function o(e,t,n,i,o){var a={},c="number"==typeof o,s=void 0!==o&&c?o.toString():n;if(c&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var u=a[s];if(Array.isArray(u))for(var l=0,f=u;l<f.length;l++){var p=f[l];if(p.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+p.key.toString())}else u=[];u.push(i),a[s]=u,Reflect.defineMetadata(e,a,t)}function a(e,t){Reflect.decorate(e,t)}function c(e,t){return function(n,r){t(n,r,e)}}t.tagParameter=function(e,t,n,r){o(i.TAGGED,e,t,r,n)},t.tagProperty=function(e,t,n){o(i.TAGGED_PROP,e.constructor,t,n)},t.decorate=function(e,t,n){"number"==typeof n?a([c(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):a([e],t)}},ZzCi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.named=void 0;var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");t.named=function(e){return function(t,n,a){var c=new i.Metadata(r.NAMED_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,c):o.tagProperty(t,n,c)}}},a1gu:function(e,t,n){var r=n("cDf5"),i=n("PJYZ");e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},a3WO:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",function(){return r})},aPG5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=void 0;var r=n("MON2"),i=n("FV85"),o=n("qK8v"),a=n("ujMp"),c=n("cSJO"),s=function(e,t,n){try{return n()}catch(i){throw o.isStackOverflowExeption(i)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):i}},u=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,o=t.childRequests,l=t.target&&t.target.isArray(),f=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(l&&f)return o.map(function(t){return u(e)(t)});var p=null;if(!t.target.isOptional()||0!==n.length){var d=n[0],h=d.scope===i.BindingScopeEnum.Singleton,v=d.scope===i.BindingScopeEnum.Request;if(h&&d.activated)return d.cache;if(v&&null!==e&&e.has(d.id))return e.get(d.id);if(d.type===i.BindingTypeEnum.ConstantValue)p=d.cache;else if(d.type===i.BindingTypeEnum.Function)p=d.cache;else if(d.type===i.BindingTypeEnum.Constructor)p=d.implementationType;else if(d.type===i.BindingTypeEnum.DynamicValue&&null!==d.dynamicValue)p=s("toDynamicValue",d.serviceIdentifier,function(){return d.dynamicValue(t.parentContext)});else if(d.type===i.BindingTypeEnum.Factory&&null!==d.factory)p=s("toFactory",d.serviceIdentifier,function(){return d.factory(t.parentContext)});else if(d.type===i.BindingTypeEnum.Provider&&null!==d.provider)p=s("toProvider",d.serviceIdentifier,function(){return d.provider(t.parentContext)});else{if(d.type!==i.BindingTypeEnum.Instance||null===d.implementationType){var g=a.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+g)}p=c.resolveInstance(d.implementationType,o,u(e))}return"function"==typeof d.onActivation&&(p=d.onActivation(t.parentContext,p)),h&&(d.cache=p,d.activated=!0),v&&null!==e&&!e.has(d.id)&&e.set(d.id,p),p}}};t.resolve=function(e){return u(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},adU4:function(e,t,n){var r=n("y1pI"),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))}},asDA:function(e,t){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},b48C:function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}},b80T:function(e,t,n){var r=n("UNi/"),i=n("03A+"),o=n("Z0cm"),a=n("DSRE"),c=n("wJg7"),s=n("c6wG"),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),l=!n&&i(e),f=!n&&!l&&a(e),p=!n&&!l&&!f&&s(e),d=n||l||f||p,h=d?r(e.length,String):[],v=h.length;for(var g in e)!t&&!u.call(e,g)||d&&("length"==g||f&&("offset"==g||"parent"==g)||p&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||c(g,v))||h.push(g);return h}},bB6j:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Normal="normal",e.PostProcessing="post-processing"}(r||(r={}))},bTtR:function(e,t){},bYl4:function(e,t){},bahg:function(e,t){e.exports=function(e){return e.split("")}},bzyH:function(e,t){},c6wG:function(e,t,n){var r=n("dD9F"),i=n("sEf8"),o=n("mdPL"),a=o&&o.isTypedArray,c=a?i(a):r;e.exports=c},cDf5:function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},cSJO:function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveInstance=void 0;var i=n("MON2"),o=n("FV85"),a=n("xfSm");t.resolveInstance=function(e,t,n){var c,s=null;if(t.length>0){var u=t.filter(function(e){return null!==e.target&&e.target.type===o.TargetTypeEnum.ConstructorArgument}).map(n);s=function(e,t,n){var r=t.filter(function(e){return null!==e.target&&e.target.type===o.TargetTypeEnum.ClassProperty}),i=r.map(n);return r.forEach(function(t,n){var r;r=t.target.name.value(),e[r]=i[n]}),e}(s=new((c=e).bind.apply(c,r([void 0],u))),t,n)}else s=new e;return function(e,t){if(Reflect.hasMetadata(a.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(a.POST_CONSTRUCT,e);try{t[n.value]()}catch(r){throw new Error(i.POST_CONSTRUCT_ERROR(e.name,r.message))}}}(e,s),s}},cZ5Q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectable=void 0;var r=n("MON2"),i=n("xfSm");t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,e))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(i.PARAM_TYPES,t,e),e}}},cZlC:function(e,t,n){"use strict";var r,i,o;!function(e){e.LINEAR="linear",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat"}(r||(r={})),function(e){e.CONSTANT="constant",e.VARIABLE="variable"}(i||(i={})),function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"}(o||(o={}))},"cq/+":function(e,t,n){var r=n("mc0g")();e.exports=r},cvCv:function(e,t){e.exports=function(e){return function(){return e}}},d9O0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.id=void 0;var r=0;t.id=function(){return r++}},dD9F:function(e,t,n){var r=n("NykK"),i=n("shjB"),o=n("ExA7"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},dQpi:function(e,t,n){var r=n("yGk4"),i=n("vN+2"),o=n("rEGp"),a=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},dTAl:function(e,t,n){var r=n("GoyQ"),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},dVn5:function(e,t){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(n)||[]}},dX1H:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Target=void 0;var r=n("xfSm"),i=n("d9O0"),o=n("GXnB"),a=n("zxMA"),c=function(){function e(e,t,n,c){this.id=i.id(),this.type=e,this.serviceIdentifier=n,this.name=new a.QueryableString(t||""),this.metadata=new Array;var s=null;"string"==typeof c?s=new o.Metadata(r.NAMED_TAG,c):c instanceof o.Metadata&&(s=c),null!==s&&this.metadata.push(s)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++)if(n[t].key===e)return!0;return!1},e.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(r.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some(function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG})},e.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===r.NAMED_TAG})[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG}):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(r.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}();t.Target=c},doU7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingCount=void 0,t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},dt0z:function(e,t,n){var r=n("zoYe");e.exports=function(e){return null==e?"":r(e)}},dxzI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncContainerModule=t.ContainerModule=void 0;var r=n("d9O0");t.ContainerModule=function(e){this.id=r.id(),this.registry=e},t.AsyncContainerModule=function(e){this.id=r.id(),this.registry=e}},e4Nc:function(e,t,n){var r=n("fGT3"),i=n("k+1r"),o=n("JHgL"),a=n("pSRY"),c=n("H8j4");function s(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=a,s.prototype.set=c,e.exports=s},eUgh:function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},ebwN:function(e,t,n){var r=n("Cwc5")(n("Kz5y"),"Map");e.exports=r},"eg+a":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},ekgI:function(e,t,n){var r=n("YESw"),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},fGT3:function(e,t,n){var r=n("4kuk"),i=n("Xi7e"),o=n("ebwN");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},fX6N:function(e,t,n){"use strict";n.d(t,"c",function(){return Ci}),n.d(t,"b",function(){return Mi}),n.d(t,"a",function(){return Ni}),n("mNvP");var r,i=n("uhBA"),o=n.n(i),a=n("4cb6"),c=n("APxj"),s=n.n(c),u=n("bB6j"),l=n("lSNA"),f=n.n(l),p=n("lwsE"),d=n.n(p),h=n("W8MJ"),v=n.n(h),g=n("Hel2"),m=n("rxlC"),y=n.n(m);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t,n){var r,i=E(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.icon,c=o.xOffset;e[a.id]=_(_({},a),{},{x:c,y:n,image:a.image,width:a.width,height:a.height})}}catch(s){i.e(s)}finally{i.f()}}function x(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function A(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var I=function(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}();function P(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="black",e.textBaseline="middle"}function C(e,t){for(var n=0;n<e.length;n++)t.data[4*n+3]=e[n]}var R,M,N,L=Object(a.injectable)()(r=function(){function e(){d()(this,e),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new g.b(3)}return v()(e,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:I,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8},this.key=""}},{key:"addIconGlyphs",value:function(e){var t=this;e.forEach(function(e){t.iconFontGlyphs[e.name]=e.unicode})}},{key:"getGlyph",value:function(e){return this.iconFontGlyphs[e]?String.fromCharCode(parseInt(this.iconFontGlyphs[e],16)):""}},{key:"setFontOptions",value:function(e){this.fontOptions=k(k({},this.fontOptions),e),this.key=this.getKey();var t=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(!n||0!==t.length){var r=this.generateFontAtlas(this.key,t,n);this.fontAtlas=r,this.cache.set(this.key,r)}}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(e,t,n){var r=this.fontOptions,i=r.fontFamily,o=r.fontWeight,a=r.fontSize,c=r.buffer,s=r.sdf,u=r.radius,l=r.cutoff,f=n&&n.data;f||((f=document.createElement("canvas")).width=1024);var p=f.getContext("2d");P(p,i,a,o);var d=function(e){var t=e.getFontWidth,n=e.fontHeight,r=e.buffer,i=e.maxCanvasWidth,o=e.mapping,a=void 0===o?{}:o,c=e.xOffset,s=e.yOffset,u=void 0===s?0:s,l=0,f=void 0===c?0:c;Array.from(e.characterSet).forEach(function(e,n){if(!a[e]){var r=t(e,n);f+30>i&&(f=0,l++),a[e]={x:f,y:u+30*l,width:30,height:30,advance:r},f+=30}});var p=n+2*r;return{mapping:a,xOffset:f,yOffset:u+l*p,canvasHeight:x(u+(l+1)*p)}}(k({getFontWidth:function(e){return p.measureText(e).width},fontHeight:1*a,buffer:c,characterSet:t,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),h=d.mapping,v=d.canvasHeight,g=d.xOffset,m=d.yOffset,b=p.getImageData(0,0,f.width,f.height);if(f.height=v,p.putImageData(b,0,0),P(p,i,a,o),s){var _,E=new y.a(a,c,u,l,i,o),S=p.getImageData(0,0,E.size,E.size),T=A(t);try{for(T.s();!(_=T.n()).done;){var O=_.value;C(E.draw(O),S),p.putImageData(S,h[O].x,h[O].y)}}catch(M){T.e(M)}finally{T.f()}}else{var w,I=A(t);try{for(I.s();!(w=I.n()).done;){var R=w.value;p.fillText(R,h[R].x,h[R].y+1*a)}}catch(M){I.e(M)}finally{I.f()}}return{xOffset:g,yOffset:m,mapping:h,data:f,width:f.width,height:f.height}}},{key:"getKey",value:function(){var e=this.fontOptions,t=e.fontFamily,n=e.fontWeight,r=e.fontSize,i=e.buffer,o=e.radius,a=e.cutoff;return e.sdf?"".concat(t," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(t," ").concat(n," ").concat(r," ").concat(i)}},{key:"getNewChars",value:function(e,t){var n=this.cache.get(e);if(!n)return t;var r=[],i=new Set(Object.keys(n.mapping));return new Set(t).forEach(function(e){i.has(e)||r.push(e)}),r}},{key:"scale",get:function(){return 1}},{key:"canvas",get:function(){var e=this.cache.get(this.key);return e&&e.data}},{key:"mapping",get:function(){var e=this.cache.get(this.key);return e&&e.mapping}}]),e}())||r,j=n("7W2i"),D=n.n(j),F=n("a1gu"),B=n.n(F),U=n("Nsbk"),z=n.n(U),G=Object(a.injectable)()(R=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){var e;d()(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).canvasHeight=128,e.texture=void 0,e.canvas=void 0,e.iconData=void 0,e.iconMap=void 0,e.ctx=void 0,e.loadingImageCount=0,e}return v()(i,[{key:"isLoading",value:function(){return 0===this.loadingImageCount}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(e,t){var n=this,r=new Image;if(this.loadingImageCount++,this.hasImage(e))throw new Error("Image Id already exists");this.iconData.push({id:e,size:64}),this.updateIconMap(),this.loadImage(t).then(function(t){r=t;var i=n.iconData.find(function(t){return t.id===e});i&&(i.image=r,i.width=r.width,i.height=r.height),n.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(e){return this.iconMap.hasOwnProperty(e)}},{key:"removeImage",value:function(e){this.hasImage(e)&&(this.iconData=this.iconData.filter(function(t){return t.id!==e}),delete this.iconMap[e],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var e=this;this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(t){var n=e.iconMap[t],r=n.x,i=n.y,o=n.image,a=n.width,c=void 0===a?64:a,s=n.height,u=void 0===s?64:s,l=Math.max(c,u)/64,f=u/l,p=c/l;o&&e.ctx.drawImage(o,r+(64-p)/2,i+(64-f)/2,p,f)})}},{key:"updateIconMap",value:function(){var e=function(e,t,n){var r,i=0,o=0,a=0,c=[],s={},u=E(e);try{for(u.s();!(r=u.n()).done;){var l=r.value;if(!s[l.id]){var f=l.size;i+f+3>1024&&(T(s,c,o),i=0,o=a+o+3,a=0,c=[]),c.push({icon:l,xOffset:i}),i=i+f+3,a=Math.max(a,f)}}}catch(p){u.e(p)}finally{u.f()}return c.length>0&&T(s,c,o),{mapping:s,canvasHeight:x(a+o+3)}}(this.iconData),t=e.canvasHeight;this.iconMap=e.mapping,this.canvasHeight=t}},{key:"loadImage",value:function(e){return new Promise(function(t,n){if(e instanceof HTMLImageElement)t(e);else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){t(r)},r.onerror=function(){n(new Error("Could not load image at "+e))},r.src=e instanceof File?URL.createObjectURL(e):e}})}}]),i}(i.EventEmitter))||R,V=n("J4zp"),H=n.n(V),X=n("IOcx"),W=Object(a.injectable)()(M=function(){function e(){d()(this,e),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return v()(e,[{key:"init",value:function(){}},{key:"update",value:function(e){this.viewport=e,this.viewMatrixInverse=X.b.invert(X.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var e=this.viewport.getCenter(),t=H()(e,2);return[t[0],t[1]]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(e,t){return this.viewport.projectFlat(e,t)}},{key:"setViewProjectionMatrix",value:function(e){this.overridedViewProjectionMatrix=e}},{key:"jitterProjectionMatrix",value:function(e,t){var n=X.b.fromTranslation(X.b.create(),[e,t,0]);this.jitteredProjectionMatrix=X.b.multiply(X.b.create(),n,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=X.b.multiply(X.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||M;function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z,q,K,Q=Object(a.injectable)()(N=function(){function e(){d()(this,e),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return v()(e,[{key:"init",value:function(e,t){this.container=e.container,this.scene=t,this.mapsService=t.get(u.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(e,t){t.get(u.a.IMapService).map?(e.addTo(this.scene),this.controls.push(e)):this.unAddControls.push(e)}},{key:"getControlByName",value:function(e){return this.controls.find(function(t){return t.controlOption.name===e})}},{key:"removeControl",value:function(e){var t=this.controls.indexOf(e);return t>-1&&this.controls.splice(t,1),e.remove(),this}},{key:"addControls",value:function(){var e=this;this.unAddControls.forEach(function(t){t.addTo(e.scene),e.controls.push(t)}),this.unAddControls=[]}},{key:"destroy",value:function(){var e,t=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}(this.controls);try{for(t.s();!(e=t.n()).done;)e.value.remove()}catch(n){t.e(n)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var e=this.controlCorners={},t="l7-",n=this.controlContainer=g.a.create("div",t+"control-container",this.container);function r(r,i){e[r+i]=g.a.create("div",t+r+" "+t+i,n)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")}},{key:"clearControlPos",value:function(){for(var e in this.controlCorners)this.controlCorners[e]&&g.a.remove(this.controlCorners[e]);this.controlContainer&&g.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),e}())||N,J=Object(a.injectable)()(Z=function(){function e(){d()(this,e),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return v()(e,[{key:"addMarkerLayer",value:function(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(e),e.addTo(this.scene)):this.unAddMarkerLayers.push(e)}},{key:"removeMarkerLayer",value:function(e){e.destroy(),this.markerLayers.indexOf(e);var t=this.markerLayers.indexOf(e);t>-1&&this.markerLayers.splice(t,1)}},{key:"addMarker",value:function(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(e),e.addTo(this.scene)):this.unAddMarkers.push(e)}},{key:"addMarkers",value:function(){var e=this;this.unAddMarkers.forEach(function(t){t.addTo(e.scene),e.markers.push(t)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var e=this;this.unAddMarkerLayers.forEach(function(t){e.markerLayers.push(t),t.addTo(e.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(e){e.remove(),this.markers.indexOf(e);var t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(e){this.scene=e,this.mapsService=e.get(u.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(e){e.remove()}),this.markers=[],this.markerLayers.forEach(function(e){e.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(e){e.destroy()}}]),e}())||Z,$=Object(a.injectable)()(q=function(){function e(){d()(this,e),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return v()(e,[{key:"removePopup",value:function(e){e.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(e){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(e.addTo(this.scene),this.popup=e):this.unAddPopup=e}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(e){this.scene=e,this.mapsService=e.get(u.a.IMapService)}}]),e}())||q,ee=n("QkVN"),te=n.n(ee),ne={MapToken:"\u60a8\u6b63\u5728\u4f7f\u7528 Demo\u6d4b\u8bd5\u5730\u56fetoken\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u53bb\u5bf9\u5e94\u5730\u56fe\u8bf7\u6ce8\u518cToken",SDK:"\u8bf7\u786e\u8ba4\u5f15\u5165\u4e86mapbox-gl api\u4e14\u5728L7\u4e4b\u524d\u5f15\u5165"};function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var oe={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},ae={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},ce=Object(a.injectable)()(K=function(){function e(){d()(this,e),this.sceneConfigCache={},this.layerConfigCache={}}return v()(e,[{key:"getSceneConfig",value:function(e){return this.sceneConfigCache[e]}},{key:"getSceneWarninfo",value:function(e){return ne[e]}},{key:"setSceneConfig",value:function(e,t){this.sceneConfigCache[e]=ie(ie({},oe),t)}},{key:"getLayerConfig",value:function(e){return this.layerConfigCache[e]}},{key:"setLayerConfig",value:function(e,t,n){this.layerConfigCache[t]=ie({},te()({},this.sceneConfigCache[e],ae,n))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||K,se=n("yG8O"),ue=n.n(se),le=n("U+yc"),fe=n.n(le),pe=(n("1ABj"),Math.PI/180),de=4003e4;function he(e){var t=e.latitude,n=void 0===t?0:t,r=e.zoom,i=e.scale,o=e.highPrecision,a=void 0!==o&&o,c=e.flipY,s=void 0!==c&&c,u={},l=512*(i=void 0!==i?i:Math.pow(2,void 0===r?0:r)),f=Math.cos(n*pe),p=l/360,d=p/f,h=l/de/f;if(u.pixelsPerMeter=[h,-h,h],u.metersPerPixel=[1/h,-1/h,1/h],u.pixelsPerDegree=[p,-d,h],u.degreesPerPixel=[1/p,-1/d,1/h],a){var v=pe*Math.tan(n*pe)/f,g=l/de*v,m=g/d*h;u.pixelsPerDegree2=[0,-p*v/2,g],u.pixelsPerMeter2=[m,0,m],s&&(u.pixelsPerDegree2[1]=-u.pixelsPerDegree2[1],u.pixelsPerMeter2[1]=-u.pixelsPerMeter2[1])}return s&&(u.pixelsPerMeter[1]=-u.pixelsPerMeter[1],u.metersPerPixel[1]=-u.metersPerPixel[1],u.pixelsPerDegree[1]=-u.pixelsPerDegree[1],u.degreesPerPixel[1]=-u.degreesPerPixel[1]),u}var ve,ge,me,ye,be,_e,Ee,Se,Te,xe,Ae,Oe,we,ke,Ie,Pe,Ce,Re,Me,Ne,Le,je,De,Fe=n("HthE"),Be=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ue=(ve=Object(a.injectable)(),ge=Object(a.inject)(u.a.ICameraService),ve((ye=function(){function e(){d()(this,e),this.needRefresh=!0,ue()(this,"cameraService",be,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return v()(e,[{key:"refresh",value:function(){var e=this.cameraService.getZoom(),t=this.cameraService.getZoomScale(),n=this.cameraService.getCenter(),r=he({latitude:n[1],zoom:e}),i=r.pixelsPerMeter,o=r.pixelsPerDegree;this.viewportCenter=n,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=i,this.pixelsPerDegree=o,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Fe.a.LNGLAT||this.coordinateSystem===Fe.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Fe.a.LNGLAT_OFFSET?this.calculateLnglatOffset(n,e):this.coordinateSystem===Fe.a.P20_OFFSET&&this.calculateLnglatOffset(n,e,t,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(e){this.coordinateSystem=e}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(e,t,n,r){var i=he({latitude:e[1],zoom:t,scale:n,flipY:r,highPrecision:!0}),o=i.pixelsPerMeter,a=i.pixelsPerDegree,c=i.pixelsPerDegree2,s=this.cameraService.getViewMatrix(),u=this.cameraService.getProjectionMatrix(),l=X.b.multiply([],u,s),f=this.cameraService.projectFlat([Math.fround(e[0]),Math.fround(e[1])],Math.pow(2,t));this.viewportCenterProjection=X.e.transformMat4([],[f[0],f[1],0,1],l),s=this.cameraService.getViewMatrixUncentered()||s,l=X.b.multiply([],u,s),l=X.b.multiply([],l,Be),this.cameraService.setViewProjectionMatrix(l),this.pixelsPerMeter=o,this.pixelsPerDegree=a,this.pixelsPerDegree2=c}}]),e}(),be=fe()(ye.prototype,"cameraService",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=ye))||me),ze=n("PJYZ"),Ge=n.n(ze),Ve=n("yLV6"),He=n.n(Ve),Xe=n("V1cb"),We={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Ye=(_e=Object(a.injectable)(),Ee=Object(a.inject)(u.a.IMapService),Se=Object(a.inject)(u.a.ILogService),_e((xe=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){var e;d()(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),ue()(e,"mapService",Ae,Ge()(e)),ue()(e,"logger",Oe,Ge()(e)),e.hammertime=void 0,e.lastClickTime=0,e.lastClickXY=[-1,-1],e.clickTimer=void 0,e.$containter=void 0,e.onDrag=function(t){var n=e.interactionEvent(t);n.type=We[n.type],e.emit(Xe.a.Drag,n)},e.onHammer=function(t){t.srcEvent.stopPropagation();var n=e.interactionEvent(t);e.emit(Xe.a.Hover,n)},e.onTouch=function(t){var n=t.touches[0];e.onHover({x:n.pageX,y:n.pageY,type:"touch"})},e.onHover=function(t){var n=t.clientX,r=t.clientY,i=t.type,o=e.mapService.getMapContainer();if(o){var a=o.getBoundingClientRect();n=n-a.left-o.clientLeft,r=r-a.top-o.clientTop}var c=e.mapService.containerToLngLat([n,r]);if("click"!==i)"touch"!==i?"click"!==i&&"dblclick"!==i&&e.emit(Xe.a.Hover,{x:n,y:r,lngLat:c,type:i,target:t}):e.isDoubleTap(n,r,c);else{if("ontouchstart"in document.documentElement==1)return;e.isDoubleTap(n,r,c)}},e}return v()(i,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Xe.a.Hover)}},{key:"triggerHover",value:function(e){this.emit(Xe.a.Hover,{x:e.x,y:e.y})}},{key:"triggerSelect",value:function(e){this.emit(Xe.a.Select,{featureId:e})}},{key:"triggerActive",value:function(e){this.emit(Xe.a.Active,{featureId:e})}},{key:"addEventListenerOnMap",value:function(){var e=this.mapService.getMapContainer();if(e){var t=new He.a.Manager(e);t.add(new He.a.Tap({event:"dblclick",taps:2})),t.add(new He.a.Tap({event:"click"})),t.add(new He.a.Pan({threshold:0,pointers:0})),t.add(new He.a.Press({})),t.on("dblclick click",this.onHammer),t.on("panstart panmove panend pancancel",this.onDrag),e.addEventListener("mousemove",this.onHover),e.addEventListener("mousedown",this.onHover,!0),e.addEventListener("mouseup",this.onHover),e.addEventListener("contextmenu",this.onHover),this.hammertime=t,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var e=this.mapService.getMapContainer();e&&(e.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),e.removeEventListener("mousedown",this.onHover),e.removeEventListener("mouseup",this.onHover),e.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(e){var t,n,r=e.type;"touch"===e.pointerType?(n=Math.floor(e.pointers[0].clientY),t=Math.floor(e.pointers[0].clientX)):(n=Math.floor(e.srcEvent.y),t=Math.floor(e.srcEvent.x));var i=this.mapService.getMapContainer();if(i){var o=i.getBoundingClientRect();t-=o.left,n-=o.top}return{x:t,y:n,lngLat:this.mapService.containerToLngLat([t,n]),type:r,target:e.srcEvent}}},{key:"isDoubleTap",value:function(e,t,n){var r=this,i=(new Date).getTime();i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-e)<10&&Math.abs(this.lastClickXY[1]-t)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),this.emit(Xe.a.Hover,{x:e,y:t,lngLat:n,type:"dblclick"})):(this.lastClickTime=i,this.lastClickXY=[e,t],this.clickTimer=setTimeout(function(){r.emit(Xe.a.Hover,{x:e,y:t,lngLat:n,type:"click"})},400))}}]),i}(o.a),Ae=fe()(xe.prototype,"mapService",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=fe()(xe.prototype,"logger",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Te=xe))||Te),Ze=n("o0o1"),qe=n.n(Ze),Ke=n("yXPU"),Qe=n.n(Ke),Je=n("o+pz");function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var tt,nt,rt,it,ot,at,ct,st,ut,lt,ft,pt,dt,ht=(we=Object(a.injectable)(),ke=Object(a.inject)(u.a.IRendererService),Ie=Object(a.inject)(u.a.IGlobalConfigService),Pe=Object(a.inject)(u.a.IInteractionService),Ce=Object(a.inject)(u.a.ILayerService),we((Me=function(){function e(){var t=this;d()(this,e),ue()(this,"rendererService",Ne,this),ue()(this,"configService",Le,this),ue()(this,"interactionService",je,this),ue()(this,"layerService",De,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(e,n){var r,i=n.x,o=n.y,a=n.lngLat,c=n.type,s=n.target,u=!1,l=t.rendererService,f=l.readPixels,p=(0,l.getContainer)().getBoundingClientRect(),d=p.width,h=p.height;d*=g.a.DPR,h*=g.a.DPR;var v,m=e.getLayerConfig(),y=m.enableHighlight,b=m.enableSelect,_=i*g.a.DPR,E=o*g.a.DPR;if(_>d-1*g.a.DPR||_<0||E>h-1*g.a.DPR||E<0)return!1;if(0!==(v=f({x:Math.floor(_/t.pickBufferScale),y:Math.floor((h-(o+1)*g.a.DPR)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}))[0]||0!==v[1]||0!==v[2]){var S=Object(g.i)(v),T=e.getSource().getFeatureById(S);S!==e.getCurrentPickId()&&"mousemove"===c&&(c="mouseenter");var x={x:i,y:o,type:c,lngLat:a,featureId:S,feature:T,target:s};T&&(u=!0,e.setCurrentPickId(S),t.triggerHoverOnLayer(e,x))}else{var A={x:i,y:o,lngLat:a,type:null!==e.getCurrentPickId()&&"mousemove"===c?"mouseout":"un"+c,featureId:null,target:s,feature:null};t.triggerHoverOnLayer(e,et(et({},A),{},{type:"unpick"})),t.triggerHoverOnLayer(e,A),e.setCurrentPickId(null)}if(y&&t.highlightPickedFeature(e,v),b&&"click"===c&&(null===(r=v)||void 0===r?void 0:r.toString())!==[0,0,0,0].toString()){var O=Object(g.i)(v);null===e.getCurrentSelectedId()||O!==e.getCurrentSelectedId()?(t.selectFeature(e,v),e.setCurrentSelectedId(O)):(t.selectFeature(e,new Uint8Array([0,0,0,0])),e.setCurrentSelectedId(null))}return u}}var t,n,r;return v()(e,[{key:"init",value:function(e){var t=this.rendererService,n=t.createTexture2D,r=t.createFramebuffer,i=(0,t.getContainer)().getBoundingClientRect(),o=i.width,a=i.height;o*=g.a.DPR,a*=g.a.DPR,this.pickBufferScale=this.configService.getSceneConfig(e).pickBufferScale||1,this.pickingFBO=r({color:n({width:Math.round(o/this.pickBufferScale),height:Math.round(a/this.pickBufferScale),wrapS:Je.a.CLAMP_TO_EDGE,wrapT:Je.a.CLAMP_TO_EDGE})}),this.interactionService.on(Xe.a.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:(r=Qe()(qe.a.mark(function e(t,n,r){var i,o,a,c=this;return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=(i=this.rendererService).useFramebuffer,a=i.clear,this.resizePickingFBO(),o(this.pickingFBO,function(){a({framebuffer:c.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.hooks.beforePickingEncode.call(),t.renderModels(),t.hooks.afterPickingEncode.call();var e=c.pickBox(t,n);r(e)});case 3:case"end":return e.stop()}},e,this)})),function(e,t,n){return r.apply(this,arguments)})},{key:"pickBox",value:function(e,t){var n,r=this,i=t.map(function(e){return Math.floor((e<0?0:e)*g.a.DPR/r.pickBufferScale)}),o=H()(i,4),a=o[0],c=o[1],s=o[2],u=o[3],l=this.rendererService,f=l.readPixels,p=(0,l.getContainer)().getBoundingClientRect(),d=p.width,h=p.height;if(h*=g.a.DPR,a>((d*=g.a.DPR)-1)*g.a.DPR/this.pickBufferScale||s<0||c>(h-1)*g.a.DPR/this.pickBufferScale||u<0)return[];var v=Math.min(d/this.pickBufferScale,s)-a,m=Math.min(h/this.pickBufferScale,u)-c;n=f({x:a,y:Math.floor(h/this.pickBufferScale-(u+1)),width:v,height:m,data:new Uint8Array(v*m*4),framebuffer:this.pickingFBO});for(var y=[],b={},_=0;_<n.length/4;_+=1){var E=n.slice(4*_,4*_+4),S=Object(g.i)(E);if(-1!==S&&!b[S]){var T=e.getSource().getFeatureById(S);y.push(T),b[S]=!0}}return y}},{key:"pickingAllLayer",value:(n=Qe()(qe.a.mark(function e(t){return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alreadyInPicking&&!this.layerService.alreadyInRendering){e.next=2;break}return e.abrupt("return");case 2:return this.alreadyInPicking=!0,e.next=5,this.pickingLayers(t);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"resizePickingFBO",value:function(){var e=(0,this.rendererService.getContainer)().getBoundingClientRect(),t=e.width,n=e.height;n*=g.a.DPR,this.width===(t*=g.a.DPR)&&this.height===n||(this.pickingFBO.resize({width:Math.round(t/this.pickBufferScale),height:Math.round(n/this.pickBufferScale)}),this.width=t,this.height=n)}},{key:"pickingLayers",value:(t=Qe()(qe.a.mark(function e(t){var n,r,i,o=this;return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this.rendererService).useFramebuffer,i=n.clear,this.resizePickingFBO(),r(this.pickingFBO,function(){o.layerService.getLayers().filter(function(e){return e.needPick(t.type)}).reverse().some(function(e){return i({framebuffer:o.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),e.hooks.beforePickingEncode.call(),e.renderModels(),e.hooks.afterPickingEncode.call(),o.pickFromPickingFBO(e,t)&&!e.getLayerConfig().enablePropagation})});case 3:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"triggerHoverOnLayer",value:function(e,t){e.emit(t.type,t)}},{key:"highlightPickedFeature",value:function(e,t){var n=H()(t,3);e.hooks.beforeHighlight.call([n[0],n[1],n[2]])}},{key:"selectFeature",value:function(e,t){var n=H()(t,3);e.hooks.beforeSelect.call([n[0],n[1],n[2]])}}]),e}(),Ne=fe()(Me.prototype,"rendererService",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=fe()(Me.prototype,"configService",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=fe()(Me.prototype,"interactionService",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=fe()(Me.prototype,"layerService",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Me))||Re),vt=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];d()(this,e),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=t}return v()(e,[{key:"start",value:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}(),gt=(tt=Object(a.injectable)(),nt=Object(a.inject)(u.a.IRendererService),rt=Object(a.inject)(u.a.IGlobalConfigService),tt((ot=function(){function e(){d()(this,e),this.clock=new vt,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,ue()(this,"renderService",at,this),ue()(this,"configService",ct,this)}return v()(e,[{key:"add",value:function(e){this.sceneInited&&e.init(),this.layers.push(e)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(e){e.inited||e.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(e){return this.layers.find(function(t){return t.id===e})}},{key:"getLayerByName",value:function(e){return this.layers.find(function(t){return t.name===e})}},{key:"remove",value:function(e){var t=this.layers.indexOf(e);t>-1&&this.layers.splice(t,1),e.emit("remove",null),e.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(e){return e.inited}).filter(function(e){return e.isVisible()}).forEach(function(e){e.hooks.beforeRenderData.call(),e.hooks.beforeRender.call(),e.render(),e.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(e,t){return e.zIndex-t.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(e){return e.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),e}(),at=fe()(ot.prototype,"renderService",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=fe()(ot.prototype,"configService",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=ot))||it),mt=n("QILm"),yt=n.n(mt),bt=n("RIqP"),_t=n.n(bt),Et=n("J2iB"),St=n.n(Et),Tt=function(){function e(t){var n=this;d()(this,e),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:1/0},this.vertexAttribute=void 0,this.defaultCallback=function(e){var t;return 0===e.length?(null===(t=n.scale)||void 0===t?void 0:t.defaultValues)||[]:e.map(function(e,t){var r;return(null===(r=n.scale)||void 0===r?void 0:r.scalers[t].func)(e)})},this.setProps(t)}return v()(e,[{key:"setProps",value:function(e){Object.assign(this,e)}},{key:"mapping",value:function(e){var t;if(null===(t=this.scale)||void 0===t?void 0:t.callback){var n,r=null===(n=this.scale)||void 0===n?void 0:n.callback.apply(n,_t()(e));if(!St()(r))return[r]}return this.defaultCallback(e)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}();function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ot=(st={},f()(st,Je.a.FLOAT,4),f()(st,Je.a.UNSIGNED_BYTE,1),f()(st,Je.a.UNSIGNED_SHORT,2),st),wt=(ut=Object(a.injectable)(),lt=Object(a.inject)(u.a.IRendererService),ut((pt=function(){function e(){d()(this,e),this.attributesAndIndices=void 0,ue()(this,"rendererService",dt,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return v()(e,[{key:"registerStyleAttribute",value:function(e){var t=this.getLayerStyleAttribute(e.name||"");return t?t.setProps(e):(t=new Tt(e),this.attributes.push(t)),t}},{key:"updateStyleAttribute",value:function(e,t,n){var r=this.getLayerStyleAttribute(e);r||(r=this.registerStyleAttribute(At(At({},t),{},{name:e})));var i=t.scale;i&&r&&(r.scale=i,r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0,n&&n.featureRange&&(r.featureRange=n.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(e){return this.attributes.find(function(t){return t.name===e})}},{key:"getLayerAttributeScale",value:function(e){var t,n=this.getLayerStyleAttribute(e),r=null==n||null===(t=n.scale)||void 0===t?void 0:t.scalers;return r&&r[0]?r[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=this.attributes.find(function(t){return t.name===e});if(i&&i.descriptor){var o=i.descriptor,a=o.update,c=o.buffer,s=o.size,u=void 0===s?0:s,l=Ot[c.type||Je.a.FLOAT];if(a){var f=this.featureLayout,p=f.elements,d=f.sizePerElement,h=p.slice(n,r);if(!h.length)return;var v=h[0].offset,g=v*u*l,m=h.map(function(e,n){for(var r=e.featureIdx,i=e.vertices,o=e.normals,c=i.length/d,s=[],u=0;u<c;u++){var l=o?o.slice(3*u,3*u+3):[];s.push.apply(s,_t()(a(t[r],r,i.slice(u*d,u*d+d),n,l)))}return s}).reduce(function(e,t){return e.push.apply(e,_t()(t)),e},[]);i.vertexAttribute.updateBuffer({data:m,offset:g})}}}},{key:"createAttributesAndIndices",value:function(e,t){var n=this;this.featureLayout={sizePerElement:0,elements:[]},t&&(this.triangulation=t);var r=this.attributes.map(function(e){return e.resetDescriptor(),e.descriptor}),i=0,o=[];e.forEach(function(e,t){var a=n.triangulation(e),c=a.vertices,s=a.normals,u=a.size;a.indices.forEach(function(e){o.push(e+i)});var l=c.length/u;n.featureLayout.sizePerElement=u,n.featureLayout.elements.push({featureIdx:t,vertices:c,normals:s,offset:i}),i+=l;for(var f=function(n){var i=(null==s?void 0:s.slice(3*n,3*n+3))||[],o=c.slice(n*u,n*u+u);r.forEach(function(r,a){var c;r&&r.update&&(c=r.buffer.data).push.apply(c,_t()(r.update(e,t,o,n,i)))})},p=0;p<l;p++)f(p)});var a=this.rendererService,c=a.createAttribute,s=a.createBuffer,u=a.createElements,l={};r.forEach(function(e,t){if(e){var r=e.buffer,i=yt()(e,["buffer","update","name"]),o=c(At({buffer:s(r)},i));l[e.name||""]=o,n.attributes[t].vertexAttribute=o}});var f=u({data:o,type:Je.a.UNSIGNED_INT,count:o.length});return this.attributesAndIndices={attributes:l,elements:f},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var e;this.attributes.forEach(function(e){e.vertexAttribute&&e.vertexAttribute.destroy()}),null===(e=this.attributesAndIndices)||void 0===e||e.elements.destroy(),this.attributes=[]}}]),e}(),dt=fe()(pt.prototype,"rendererService",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft=pt))||ft),kt=n("U8pU"),It=n("a3WO"),Pt=n("BsWD");function Ct(e){return function(e){if(Array.isArray(e))return Object(It.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(Pt.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Rt=n("1OyB"),Mt=n("vuIU"),Nt="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",Lt=!("object"===("undefined"==typeof process?"undefined":Object(kt.a)(process))&&"[object process]"===String(process)&&!process.browser)||function(e){if("undefined"!=typeof window&&"object"===Object(kt.a)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===Object(kt.a)(process.versions)&&Boolean(process.versions.electron))return!0;var t="object"===("undefined"==typeof navigator?"undefined":Object(kt.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}();function jt(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(r){return null}}var Dt=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(Rt.a)(this,e),this.storage=jt(r),this.id=t,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(Mt.a)(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}]),e}();function Ft(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));var o=e.width*n,a=e.height*n,c=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),c]}var Bt={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Ut(e){return"string"==typeof e?Bt[e.toUpperCase()]||Bt.WHITE:e}function zt(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return Gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(e),i=Object.getOwnPropertyNames(r),o=zt(i);try{var a=function(){var r=t.value;"function"==typeof e[r]&&(n.find(function(e){return r===e})||(e[r]=e[r].bind(e)))};for(o.s();!(t=o.n()).done;)a()}catch(c){o.e(c)}finally{o.f()}}function Ht(e,t){if(!e)throw new Error(t||"Assertion failed")}var Xt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":Object(kt.a)(process))&&process},Wt=Xt.window||Xt.self||Xt.global,Yt=Xt.process||{};function Zt(){var e;if(Lt&&Wt.performance)e=Wt.performance.now();else if(Yt.hrtime){var t=Yt.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}console;var qt={debug:Lt&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Kt={enabled:!0,level:0};function Qt(){}var Jt={},$t={once:!0};function en(e){for(var t in e)for(var n in e[t])return n||"untitled";return"empty"}var tn,nn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.id;Object(Rt.a)(this,e),this.id=n,this.VERSION=Nt,this._startTs=Zt(),this._deltaTs=Zt(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Dt("__probe-".concat(this.id,"__"),Kt),this.userData={},this.timeStamp("".concat(this.id," started")),Vt(this),Object.seal(this)}return Object(Mt.a)(e,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Zt()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Zt()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({level:e}),this}},{key:"assert",value:function(e,t){Ht(e,t)}},{key:"warn",value:function(e){return this._getLogFunction(0,e,qt.warn,arguments,$t)}},{key:"error",value:function(e){return this._getLogFunction(0,e,qt.error,arguments)}},{key:"deprecated",value:function(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}},{key:"removed",value:function(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}},{key:"probe",value:function(e,t){return this._getLogFunction(e,t,qt.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(e,t){return this._getLogFunction(e,t,qt.debug,arguments)}},{key:"info",value:function(e,t){return this._getLogFunction(e,t,console.info,arguments)}},{key:"once",value:function(e,t){return this._getLogFunction(e,t,qt.debug||qt.info,arguments,$t)}},{key:"table",value:function(e,t,n){return t?this._getLogFunction(e,t,console.table||Qt,n&&[n],{tag:en(t)}):Qt}},{key:"image",value:function(e){var t=e.image,r=e.message,i=void 0===r?"":r,o=e.scale,a=void 0===o?1:o;return this._shouldLog(e.logLevel||e.priority)?Lt?function(e){var t=e.image,n=e.message,r=void 0===n?"":n,i=e.scale,o=void 0===i?1:i;if("string"==typeof t){var a=new Image;return a.onload=function(){var e,t=Ft(a,r,o);(e=console).log.apply(e,Ct(t))},a.src=t,Qt}var c,s=t.nodeName||"";if("img"===s.toLowerCase())return(c=console).log.apply(c,Ct(Ft(t,r,o))),Qt;if("canvas"===s.toLowerCase()){var u=new Image;return u.onload=function(){var e;return(e=console).log.apply(e,Ct(Ft(u,r,o)))},u.src=t.toDataURL(),Qt}return Qt}({image:t,message:i,scale:a}):function(e){var t=e.image,r=e.scale,i=void 0===r?1:r,o=null;try{o=n(4)}catch(a){}return o?function(){return o(t,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(e){return console.log(e)})}:Qt}({image:t,message:i,scale:a}):Qt}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(e){return this._storage.config[e]}},{key:"set",value:function(e,t){this._storage.updateConfiguration(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t))}},{key:"time",value:function(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}},{key:"timeEnd",value:function(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(e,t){return this._getLogFunction(e,t,console.timeStamp||Qt)}},{key:"group",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=n=on({logLevel:e,message:t,opts:n}),i=r.collapsed;return n.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}},{key:"groupCollapsed",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction(e,"",console.groupEnd||Qt)}},{key:"withGroup",value:function(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return this.isEnabled()&&this.getLevel()>=rn(e)}},{key:"_getLogFunction",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(e)){var o;i=on({logLevel:e,message:t,args:r,opts:i}),Ht(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Zt();var a=i.tag||i.message;if(i.once){if(Jt[a])return Qt;Jt[a]=Zt()}return t=an(this.id,i.message,i),(o=n).bind.apply(o,[console,t].concat(Ct(i.args)))}return Qt}},{key:"level",set:function(e){this.setLevel(e)},get:function(){return this.getLevel()}},{key:"priority",set:function(e){this.level=e},get:function(){return this.level}}]),e}();function rn(e){if(!e)return 0;var t;switch(Object(kt.a)(e)){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Ht(Number.isFinite(t)&&t>=0),t}function on(e){var t=e.logLevel,n=e.message;e.logLevel=rn(t);for(var r=e.args?Array.from(e.args):[];r.length&&r.shift()!==n;);switch(e.args=r,Object(kt.a)(t)){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());var i=Object(kt.a)(e.message);return Ht("string"===i||"object"===i),Object.assign(e,e.opts)}function an(e,t,n){if("string"==typeof t){var r=n.time?function(e){var t=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-e.length,0);return"".concat(" ".repeat(t)).concat(e)}((c=n.total)<10?"".concat(c.toFixed(2),"ms"):c<100?"".concat(c.toFixed(1),"ms"):c<1e3?"".concat(c.toFixed(0),"ms"):"".concat((c/1e3).toFixed(2),"s")):"";i=t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),o=n.color,a=n.background,Lt||"string"!=typeof i||(o&&(o=Ut(o),i="\x1b[".concat(o,"m").concat(i,"\x1b[39m")),a&&(o=Ut(a),i="\x1b[".concat(a+10,"m").concat(i,"\x1b[49m"))),t=i}var i,o,a,c;return t}nn.VERSION=Nt;var cn=new nn({id:"L7"}).enable(!1);cn.priority=5;var sn,un,ln,fn,pn,dn,hn,vn,gn,mn,yn,bn,_n,En,Sn,Tn,xn,An,On,wn,kn,In,Pn,Cn,Rn,Mn,Nn,Ln,jn,Dn,Fn,Bn,Un,zn,Gn,Vn=Object(a.injectable)()(tn=function(){function e(){d()(this,e)}return v()(e,[{key:"error",value:function(e){cn.error(e)()}},{key:"warn",value:function(e){cn.probe(1,e)()}},{key:"info",value:function(e){cn.info(3,e)()}},{key:"debug",value:function(e){cn.probe(4,e)()}}]),e}())||tn,Hn=n("xp6e"),Xn=n("iegG"),Wn=n.n(Xn),Yn=(window,0);function Zn(e){var t=e;if("string"==typeof e&&(t=document.getElementById(e)),t){var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",n.id="l7-scene-".concat(Yn++),n.classList.add("l7-scene"),t.appendChild(n),n}return null}var qn,Kn=(sn=Object(a.injectable)(),un=Object(a.inject)(u.a.SceneID),ln=Object(a.inject)(u.a.IIconService),fn=Object(a.inject)(u.a.IFontService),pn=Object(a.inject)(u.a.IControlService),dn=Object(a.inject)(u.a.ILogService),hn=Object(a.inject)(u.a.IGlobalConfigService),vn=Object(a.inject)(u.a.IMapService),gn=Object(a.inject)(u.a.ICoordinateSystemService),mn=Object(a.inject)(u.a.IRendererService),yn=Object(a.inject)(u.a.ILayerService),bn=Object(a.inject)(u.a.ICameraService),_n=Object(a.inject)(u.a.IInteractionService),En=Object(a.inject)(u.a.IPickingService),Sn=Object(a.inject)(u.a.IShaderModuleService),Tn=Object(a.inject)(u.a.IMarkerService),xn=Object(a.inject)(u.a.IPopupService),sn((On=function(e){D()(o,e);var t,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=z()(n);if(r){var i=z()(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return B()(this,e)});function o(){var e;return d()(this,o),(e=i.call(this)).destroyed=!1,e.loaded=!1,ue()(e,"id",wn,Ge()(e)),ue()(e,"iconService",kn,Ge()(e)),ue()(e,"fontService",In,Ge()(e)),ue()(e,"controlService",Pn,Ge()(e)),ue()(e,"logger",Cn,Ge()(e)),ue()(e,"configService",Rn,Ge()(e)),ue()(e,"map",Mn,Ge()(e)),ue()(e,"coordinateSystemService",Nn,Ge()(e)),ue()(e,"rendererService",Ln,Ge()(e)),ue()(e,"layerService",jn,Ge()(e)),ue()(e,"cameraService",Dn,Ge()(e)),ue()(e,"interactionService",Fn,Ge()(e)),ue()(e,"pickingService",Bn,Ge()(e)),ue()(e,"shaderModuleService",Un,Ge()(e)),ue()(e,"markerService",zn,Ge()(e)),ue()(e,"popupService",Gn,Ge()(e)),e.inited=!1,e.initPromise=void 0,e.rendering=!1,e.$container=void 0,e.canvas=void 0,e.markerContainer=void 0,e.hooks=void 0,e.handleWindowResized=function(){e.emit("resize"),e.$container&&(e.initContainer(),g.a.triggerResize(),e.coordinateSystemService.needRefresh=!0,e.render())},e.handleMapCameraChanged=function(t){e.cameraService.update(t),e.render()},e.hooks={init:new Hn.a},e}return v()(o,[{key:"init",value:function(e){var t=this;this.configService.setSceneConfig(this.id,e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",Qe()(qe.a.mark(function e(){return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){t.map.onCameraChanged(function(n){t.cameraService.init(),t.cameraService.update(n),e()}),t.map.init()});case 2:t.map.onCameraChanged(t.handleMapCameraChanged),t.map.addMarkerContainer(),t.markerService.addMarkers(),t.markerService.addMarkerLayers(),t.popupService.initPopup(),t.interactionService.init(),t.interactionService.on(Xe.a.Drag,t.addSceneEvent.bind(t)),t.logger.debug("map ".concat(t.id," loaded"));case 10:case"end":return e.stop()}},e)}))),this.hooks.init.tapPromise("initRenderer",Qe()(qe.a.mark(function e(){var n;return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Zn(t.configService.getSceneConfig(t.id).id||""),t.$container=n,!n){e.next=11;break}return t.canvas=g.a.create("canvas","",n),t.setCanvas(),e.next=7,t.rendererService.init(t.canvas,t.configService.getSceneConfig(t.id));case 7:Wn()(t.$container,t.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(t.handleWindowResized),e.next=12;break;case 11:t.logger.error("\u5bb9\u5668 id \u4e0d\u5b58\u5728");case 12:t.pickingService.init(t.id),t.logger.debug("scene ".concat(t.id," renderer loaded"));case 14:case"end":return e.stop()}},e)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(e){this.logger.debug("add layer ".concat(e.name," to scene ").concat(this.id)),this.layerService.add(e),this.render()}},{key:"render",value:(t=Qe()(qe.a.mark(function e(){return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rendering&&!this.destroyed){e.next=2;break}return e.abrupt("return");case 2:if(this.rendering=!0,this.inited){e.next=13;break}return e.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(e){var t,n=null===(t=this.$container)||void 0===t?void 0:t.getElementsByTagName("canvas")[0];return this.render(),"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png")}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var e=this.$container.parentElement;null!==e&&(this.markerContainer=g.a.create("div","l7-marker-container",e))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Xn.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)):this.destroyed=!0}},{key:"initContainer",value:function(){var e,t,n=g.a.DPR,r=(null===(e=this.$container)||void 0===e?void 0:e.clientWidth)||400,i=(null===(t=this.$container)||void 0===t?void 0:t.clientHeight)||300,o=this.canvas;o&&(o.width=r*n,o.height=i*n,o.style.width="".concat(r,"px"),o.style.height="".concat(i,"px")),this.rendererService.viewport({x:0,y:0,width:n*r,height:n*i})}},{key:"setCanvas",value:function(){var e,t,n=g.a.DPR,r=(null===(e=this.$container)||void 0===e?void 0:e.clientWidth)||400,i=(null===(t=this.$container)||void 0===t?void 0:t.clientHeight)||300,o=this.canvas;o.width=r*n,o.height=i*n,o.style.width="".concat(r,"px"),o.style.height="".concat(i,"px")}},{key:"addSceneEvent",value:function(e){this.emit(e.type,e)}}]),o}(i.EventEmitter),wn=fe()(On.prototype,"id",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=fe()(On.prototype,"iconService",[ln],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=fe()(On.prototype,"fontService",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pn=fe()(On.prototype,"controlService",[pn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=fe()(On.prototype,"logger",[dn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=fe()(On.prototype,"configService",[hn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=fe()(On.prototype,"map",[vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nn=fe()(On.prototype,"coordinateSystemService",[gn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=fe()(On.prototype,"rendererService",[mn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jn=fe()(On.prototype,"layerService",[yn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=fe()(On.prototype,"cameraService",[bn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fn=fe()(On.prototype,"interactionService",[_n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bn=fe()(On.prototype,"pickingService",[En],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Un=fe()(On.prototype,"shaderModuleService",[Sn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=fe()(On.prototype,"markerService",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=fe()(On.prototype,"popupService",[xn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=On))||An),Qn=n("7tbW"),Jn=n.n(Qn),$n=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function er(e){var t={};return{content:e=e.replace($n,function(e,n,r){var i=r.split(":"),o=i[0].trim(),a="";switch(i.length>1&&(a=i[1].trim()),n){case"bool":a="true"===a;break;case"float":case"int":a=Number(a);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":a=a?a.replace("[","").replace("]","").split(",").reduce(function(e,t){return e.push(Number(t.trim())),e},[]):new Array(function(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16}return t}(n)).fill(0)}return t[o]=a,"uniform ".concat(n," ").concat(o,";\n")}),uniforms:t}}function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var rr,ir,or,ar,cr,sr,ur,lr,fr,pr,dr,hr="#define PI 3.14159265359",vr=/precision\s+(high|low|medium)p\s+float/,gr=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,mr=Object(a.injectable)()(qn=function(){function e(){d()(this,e),this.moduleCache={},this.rawContentCache={}}return v()(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:hr,fs:hr}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("projection",{vs:"#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n  return position;\n\n  // TODO: \u74e6\u7247\u5750\u6807\u7cfb & \u5e38\u89c4\u4e16\u754c\u5750\u6807\u7cfb\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}\n\n",fs:""}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"})}},{key:"registerModule",value:function(e,t){if(!this.rawContentCache[e]){var n=t.fs,r=t.uniforms,i=er(t.vs),o=i.content,a=i.uniforms,c=er(n),s=c.uniforms;this.rawContentCache[e]={fs:c.content,uniforms:nr(nr(nr({},a),s),r),vs:o}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(e){var t=this;if(this.moduleCache[e])return this.moduleCache[e];var n=this.rawContentCache[e].fs,r=this.processModule(this.rawContentCache[e].vs,[],"vs"),i=r.content,o=r.includeList,a=this.processModule(n,[],"fs"),c=a.content,s=a.includeList,u=c,l=Jn()(o.concat(s).concat(e)).reduce(function(e,n){return nr(nr({},e),t.rawContentCache[n].uniforms)},{});return vr.test(c)||(u="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+c),this.moduleCache[e]={fs:u.trim(),uniforms:l,vs:i.trim()},this.moduleCache[e]}},{key:"processModule",value:function(e,t,n){var r=this;return{content:e.replace(gr,function(e,i){var o=i.split(" ")[0].replace(/"/g,"");if(t.indexOf(o)>-1)return"";var a=r.rawContentCache[o][n];return t.push(o),r.processModule(a,t,n).content}),includeList:t}}}]),e}())||qn,yr=n("iWIM"),br=n.n(yr),_r=n("bPkA"),Er=(rr=Object(a.injectable)(),ir=Object(a.inject)(u.a.IShaderModuleService),rr((ar=function(){function e(){d()(this,e),ue()(this,"shaderModuleService",cr,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return v()(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return _r.a.Normal}},{key:"init",value:function(e,t){this.config=t,this.rendererService=e.getContainer().get(u.a.IRendererService),this.cameraService=e.getContainer().get(u.a.ICameraService),this.mapService=e.getContainer().get(u.a.IMapService),this.interactionService=e.getContainer().get(u.a.IInteractionService),this.layerService=e.getContainer().get(u.a.ILayerService)}},{key:"render",value:function(e){}}]),e}(),cr=fe()(ar.prototype,"shaderModuleService",[ir],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),or=ar))||or),Sr=Object(a.injectable)()(sr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(e,t){br()(z()(i.prototype),"init",this).call(this,e,t)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),i}(Er))||sr;function Tr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ar,Or,wr,kr,Ir,Pr=(ur=Object(a.injectable)(),lr=Object(a.inject)(u.a.IPostProcessor),ur((pr=function(){function e(){d()(this,e),this.passes=[],ue()(this,"postProcessor",dr,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}var t;return v()(e,[{key:"setLayer",value:function(e){this.layer=e}},{key:"setRenderFlag",value:function(e){this.renderFlag=e}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:(t=Qe()(qe.a.mark(function e(){var t,n,r;return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Tr(this.passes),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r.render(this.layer);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:this.layer.renderModels();case 18:case"end":return e.stop()}},e,this,[[1,11,14,17]])})),function(){return t.apply(this,arguments)})},{key:"resize",value:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t)}},{key:"add",value:function(e,t){e.getType()===_r.a.PostProcessing?this.postProcessor.add(e,this.layer,t):(e.init(this.layer,t),this.passes.push(e))}},{key:"insert",value:function(e,t,n){e.init(this.layer,t),this.passes.splice(n,0,e)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),dr=fe()(pr.prototype,"postProcessor",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=pr))||fr);function Cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cr(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Mr,Nr=(Ar=Object(a.injectable)(),Or=Object(a.inject)(u.a.ILogService),Ar((kr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){var e;d()(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),ue()(e,"logger",Ir,Ge()(e)),e.pickingFBO=void 0,e.layer=void 0,e.width=0,e.height=0,e.alreadyInRendering=!1,e.pickFromPickingFBO=function(t){var n=t.x,r=t.y,i=t.lngLat,o=t.type;if(e.layer.isVisible()&&e.layer.needPick(o)){var a,c=e.rendererService,s=c.readPixels,u=c.useFramebuffer,l=(0,c.getViewportSize)(),f=l.width,p=l.height,d=e.layer.getLayerConfig(),h=d.enableHighlight,v=d.enableSelect,m=n*g.a.DPR,y=r*g.a.DPR;m>f||m<0||y>p||y<0||u(e.pickingFBO,function(){var t;if(0!==(a=s({x:Math.round(m),y:Math.round(p-(r+1)*g.a.DPR),width:1,height:1,data:new Uint8Array(4),framebuffer:e.pickingFBO}))[0]||0!==a[1]||0!==a[2]){e.logger.debug("picked");var c=Object(g.i)(a),u=e.layer.getSource().getFeatureById(c),l={x:n,y:r,type:o,lngLat:i,featureId:c,feature:u};u&&(e.layer.setCurrentPickId(c),e.triggerHoverOnLayer(l))}else{var f={x:n,y:r,lngLat:i,type:null===e.layer.getCurrentPickId()?"un"+o:"mouseout",featureId:null,feature:null};e.triggerHoverOnLayer(Rr(Rr({},f),{},{type:"unpick"})),e.triggerHoverOnLayer(f),e.layer.setCurrentPickId(null)}h&&e.highlightPickedFeature(a),v&&"click"===o&&(null===(t=a)||void 0===t?void 0:t.toString())!==[0,0,0,0].toString()&&e.selectFeature(a)})}},e}return v()(i,[{key:"getType",value:function(){return _r.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(e,t){br()(z()(i.prototype),"init",this).call(this,e,t),this.layer=e;var n=this.rendererService,r=n.createTexture2D,o=n.createFramebuffer,a=(0,n.getViewportSize)();this.pickingFBO=o({color:r({width:a.width,height:a.height,wrapS:Je.a.CLAMP_TO_EDGE,wrapT:Je.a.CLAMP_TO_EDGE})}),this.interactionService.on(Xe.a.Hover,this.pickFromPickingFBO),this.interactionService.on(Xe.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Xe.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(e){var t=this;if(!this.alreadyInRendering){var n=this.rendererService,r=n.useFramebuffer,i=n.clear,o=(0,n.getViewportSize)(),a=o.width,c=o.height;this.alreadyInRendering=!0,this.width===a&&this.height===c||(this.pickingFBO.resize({width:a,height:c}),this.width=a,this.height=c),r(this.pickingFBO,function(){i({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n=t.layer.multiPassRenderer.getRenderFlag();t.layer.multiPassRenderer.setRenderFlag(!1),e.hooks.beforePickingEncode.call(),e.render(),e.hooks.afterPickingEncode.call(),t.layer.multiPassRenderer.setRenderFlag(n),t.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(e){this.layer.emit(e.type,e)}},{key:"highlightPickedFeature",value:function(e){var t=H()(e,3);this.layer.hooks.beforeHighlight.call([t[0],t[1],t[2]]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(e){var t=H()(e,3);this.layer.hooks.beforeSelect.call([t[0],t[1],t[2]]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(e){var t=e.featureId,n=Object(g.j)(t);this.selectFeature(new Uint8Array(n))}},{key:"highlightFeatureHandle",value:function(e){var t=e.featureId,n=Object(g.j)(t);this.highlightPickedFeature(new Uint8Array(n))}}]),i}(Er),Ir=fe()(kr.prototype,"logger",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wr=kr))||wr),Lr=n("+em5");function jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jr(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Fr,Br=Object(a.injectable)()(Mr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var e=this.shaderModuleService.getModule("blur-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:Dr(Dr({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(e){var t={};return St()(e.blurRadius)||(t.u_BlurDir=[e.blurRadius,0]),t}}]),i}(Lr.a))||Mr;function Ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ur(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Gr,Vr=Object(a.injectable)()(Fr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var e=this.shaderModuleService.getModule("blur-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:zr(zr({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(e){var t={};return St()(e.blurRadius)||(t.u_BlurDir=[0,e.blurRadius]),t}}]),i}(Lr.a))||Fr;function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Wr,Yr,Zr=Object(a.injectable)()(Gr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});var e=this.shaderModuleService.getModule("colorhalftone-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:Xr(Xr({},r),{},{u_ViewportSize:[o,a]})}}}]),i}(Lr.a))||Gr,qr=Object(a.injectable)()(Wr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}]),i}(Lr.a))||Wr;function Kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kr(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Jr,$r=Object(a.injectable)()(Yr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var e=this.shaderModuleService.getModule("hexagonalpixelate-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:Qr(Qr({},r),{},{u_ViewportSize:[o,a]})}}}]),i}(Lr.a))||Yr;function ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ni,ri,ii,oi,ai,ci,si,ui,li,fi,pi,di,hi,vi,gi,mi,yi=Object(a.injectable)()(Jr=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var e=this.shaderModuleService.getModule("ink-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:ti(ti({},r),{},{u_ViewportSize:[o,a]})}}}]),i}(Lr.a))||Jr,bi=Object(a.injectable)()(ni=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}]),i}(Lr.a))||ni,_i=Object(a.injectable)()(ri=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}]),i}(Lr.a))||ri,Ei=(ii=Object(a.injectable)(),oi=Object(a.inject)(u.a.IRendererService),ai=Object(a.postConstruct)(),ii((si=function(){function e(){d()(this,e),ue()(this,"rendererService",ui,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}var t;return v()(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:(t=Qe()(qe.a.mark(function e(t){var n,r;return qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.passes.length)){e.next=10;break}return(r=this.passes[n]).setRenderToScreen(this.isLastEnabledPass(n)),e.next=6,r.render(t);case 6:n!==this.passes.length-1&&this.swap();case 7:n++,e.next=1;break;case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"resize",value:function(e,t){this.readFBO.resize({width:e,height:t}),this.writeFBO.resize({width:e,height:t})}},{key:"add",value:function(e,t,n){e.init(t,n),this.passes.push(e)}},{key:"insert",value:function(e,t,n,r){e.init(n,r),this.passes.splice(t,0,e)}},{key:"getPostProcessingPassByName",value:function(e){return this.passes.find(function(t){return t.getName()===e})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].isEnabled())return!1;return!0}},{key:"swap",value:function(){var e=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=e}}]),e}(),ui=fe()(si.prototype,"rendererService",[oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe()(si.prototype,"init",[ai],Object.getOwnPropertyDescriptor(si.prototype,"init"),si.prototype),ci=si))||ci),Si=Object(a.injectable)()(li=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){return d()(this,i),r.apply(this,arguments)}return v()(i,[{key:"getType",value:function(){return _r.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(e,t){br()(z()(i.prototype),"init",this).call(this,e,t)}},{key:"render",value:function(e){var t=this.rendererService,n=t.clear;(0,t.useFramebuffer)(null,function(){n({color:[0,0,0,0],depth:1,stencil:0}),e.multiPassRenderer.setRenderFlag(!1),e.render(),e.multiPassRenderer.setRenderFlag(!0)})}}]),i}(Er))||li;function Ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ti(Object(n),!0).forEach(function(t){f()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ti(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ai="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}";function Oi(e,t){for(var n=0,r=1/t,i=e;i>0;)n+=r*(i%t),i=Math.floor(i/t),r/=t;return n}var wi=1,ki=(fi=Object(a.injectable)(),pi=Object(a.inject)(u.a.IShaderModuleService),di=Object(a.inject)(u.a.ILogService),fi((vi=function(e){D()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=z()(t);if(n){var i=z()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return B()(this,e)});function i(){var e;d()(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),ue()(e,"shaderModuleService",gi,Ge()(e)),ue()(e,"logger",mi,Ge()(e)),e.haltonSequence=[],e.accumulatingId=0,e.frame=0,e.timer=void 0,e.sampleRenderTarget=void 0,e.prevRenderTarget=void 0,e.outputRenderTarget=void 0,e.copyRenderTarget=void 0,e.blendModel=void 0,e.outputModel=void 0,e.copyModel=void 0,e}return v()(i,[{key:"getType",value:function(){return _r.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(e,t){br()(z()(i.prototype),"init",this).call(this,e,t);var n=this.rendererService,r=n.createFramebuffer,o=n.createTexture2D;this.sampleRenderTarget=r({color:o({width:1,height:1,wrapS:Je.a.CLAMP_TO_EDGE,wrapT:Je.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=r({color:o({width:1,height:1,wrapS:Je.a.CLAMP_TO_EDGE,wrapT:Je.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=r({color:o({width:1,height:1,wrapS:Je.a.CLAMP_TO_EDGE,wrapT:Je.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=r({color:o({width:1,height:1,wrapS:Je.a.CLAMP_TO_EDGE,wrapT:Je.a.CLAMP_TO_EDGE})});for(var a=0;a<30;a++)this.haltonSequence.push([Oi(a,2),Oi(a,3)]);this.blendModel=this.createTriangleModel("blend-pass","uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n"),this.outputModel=this.createTriangleModel("copy-pass",Ai,{blend:{enable:!0,func:{srcRGB:Je.a.ONE,dstRGB:Je.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Je.a.ONE,dstAlpha:Je.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Je.a.FUNC_ADD,alpha:Je.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Ai)}},{key:"render",value:function(e){var t=this,n=this.rendererService,r=n.clear,i=n.useFramebuffer,o=(0,n.getViewportSize)(),a=o.width,c=o.height;this.sampleRenderTarget.resize({width:a,height:c}),this.prevRenderTarget.resize({width:a,height:c}),this.outputRenderTarget.resize({width:a,height:c}),this.copyRenderTarget.resize({width:a,height:c}),this.resetFrame(),this.stopAccumulating();var s=e.multiPassRenderer.getPostProcessor().getReadFBO();i(s,function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:s}),e.multiPassRenderer.setRenderFlag(!1),e.render(),e.multiPassRenderer.setRenderFlag(!0)});var u=function n(r){t.accumulatingId&&r===t.accumulatingId&&(t.isFinished()||(t.doRender(e),requestAnimationFrame(function(){n(r)})))};this.accumulatingId=wi++,this.timer=window.setTimeout(function(){u(t.accumulatingId)},50)}},{key:"doRender",value:function(e){var t=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var n=this.rendererService,r=n.clear,i=n.useFramebuffer,o=(0,n.getViewportSize)(),a=o.width,c=o.height,s=e.getLayerConfig().jitterScale,u=void 0===s?1:s,l=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*l[0]-1)/a*u,(2*l[1]-1)/c*u),e.multiPassRenderer.setRenderFlag(!1),e.hooks.beforeRender.call(),i(this.sampleRenderTarget,function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:t.sampleRenderTarget}),e.render()}),e.hooks.afterRender.call(),e.multiPassRenderer.setRenderFlag(!0);var f=e.getLayerConfig();i(this.outputRenderTarget,function(){t.blendModel.draw({uniforms:{u_opacity:f.opacity||1,u_MixRatio:0===t.frame?1:.9,u_Diffuse1:t.sampleRenderTarget,u_Diffuse2:0===t.frame?e.multiPassRenderer.getPostProcessor().getReadFBO():t.prevRenderTarget}})}),0===this.frame&&r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(i(this.copyRenderTarget,function(){t.outputModel.draw({uniforms:{u_Texture:t.outputRenderTarget}})}),i(e.multiPassRenderer.getPostProcessor().getReadFBO(),function(){t.copyModel.draw({uniforms:{u_Texture:t.copyRenderTarget}})}),e.multiPassRenderer.getPostProcessor().render(e));var p=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=p,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(e,t,n){this.shaderModuleService.registerModule(e,{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:t});var r=this.shaderModuleService.getModule(e),i=r.uniforms,o=this.rendererService;return(0,o.createModel)(xi({vs:r.vs,fs:r.fs,attributes:{a_Position:(0,o.createAttribute)({buffer:(0,o.createBuffer)({data:[-4,-4,4,-4,0,4],type:Je.a.FLOAT}),size:2})},uniforms:xi({},i),depth:{enable:!1},count:3},n))}}]),i}(Er),gi=fe()(vi.prototype,"shaderModuleService",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mi=fe()(vi.prototype,"logger",[di],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hi=vi))||hi),Ii=new a.Container;Ii.bind(u.a.IGlobalConfigService).to(ce).inSingletonScope(),Ii.bind(u.a.IShaderModuleService).to(mr).inSingletonScope(),Ii.bind(u.a.ILogService).to(Vn).inSingletonScope(),Object(a.decorate)(Object(a.injectable)(),i.EventEmitter),Ii.bind(u.a.IEventEmitter).to(i.EventEmitter);var Pi=s()(Ii,!1),Ci=function(e){var t=Pi.lazyInject(e);return function(e,n,r){t.call(this,e,n),r&&(r.initializer=function(){return e[n]})}},Ri=0;function Mi(){var e=new a.Container;return e.parent=Ii,e.bind(u.a.SceneID).toConstantValue("".concat(Ri++)),e.bind(u.a.ILayerService).to(gt).inSingletonScope(),e.bind(u.a.ISceneService).to(Kn).inSingletonScope(),e.bind(u.a.ICameraService).to(W).inSingletonScope(),e.bind(u.a.ICoordinateSystemService).to(Ue).inSingletonScope(),e.bind(u.a.IInteractionService).to(Ye).inSingletonScope(),e.bind(u.a.IPickingService).to(ht).inSingletonScope(),e.bind(u.a.IControlService).to(Q).inSingletonScope(),e.bind(u.a.IMarkerService).to(J).inSingletonScope(),e.bind(u.a.IIconService).to(G).inSingletonScope(),e.bind(u.a.IFontService).to(L).inSingletonScope(),e.bind(u.a.IPopupService).to($).inSingletonScope(),e.bind(u.a.INormalPass).to(Sr).whenTargetNamed("clear"),e.bind(u.a.INormalPass).to(Nr).whenTargetNamed("pixelPicking"),e.bind(u.a.INormalPass).to(Si).whenTargetNamed("render"),e.bind(u.a.INormalPass).to(ki).whenTargetNamed("taa"),e.bind(u.a.IFactoryNormalPass).toFactory(function(e){return function(t){return e.container.getNamed(u.a.INormalPass,t)}}),e.bind(u.a.IPostProcessingPass).to(qr).whenTargetNamed("copy"),e.bind(u.a.IPostProcessingPass).to(Br).whenTargetNamed("blurH"),e.bind(u.a.IPostProcessingPass).to(Vr).whenTargetNamed("blurV"),e.bind(u.a.IPostProcessingPass).to(bi).whenTargetNamed("noise"),e.bind(u.a.IPostProcessingPass).to(_i).whenTargetNamed("sepia"),e.bind(u.a.IPostProcessingPass).to(Zr).whenTargetNamed("colorHalftone"),e.bind(u.a.IPostProcessingPass).to($r).whenTargetNamed("hexagonalPixelate"),e.bind(u.a.IPostProcessingPass).to(yi).whenTargetNamed("ink"),e.bind(u.a.IFactoryPostProcessingPass).toFactory(function(e){return function(t){var n=e.container.getNamed(u.a.IPostProcessingPass,t);return n.setName(t),n}}),e}function Ni(e){var t=new a.Container;return t.parent=e,t.bind(u.a.IStyleAttributeService).to(wt).inSingletonScope(),t.bind(u.a.IMultiPassRenderer).to(Pr).inSingletonScope(),t.bind(u.a.IPostProcessor).to(Ei).inSingletonScope(),t}},fbrv:function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionName=t.getBaseClassDependencyCount=t.getDependencies=void 0;var i=n("Yk9n"),o=n("MON2"),a=n("FV85"),c=n("xfSm"),s=n("ujMp");Object.defineProperty(t,"getFunctionName",{enumerable:!0,get:function(){return s.getFunctionName}});var u=n("dX1H");function l(e,t,n,i){var a=e.getConstructorMetadata(n),c=a.compilerGeneratedMetadata;if(void 0===c)throw new Error(o.MISSING_INJECTABLE_ANNOTATION+" "+t+".");var s=a.userGeneratedMetadata,u=Object.keys(s),l=function(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var c=f(a,e,t,n,r);null!==c&&o.push(c)}return o}(i,t,c,s,0===n.length&&u.length>0?u.length:n.length),d=p(e,n);return r(l,d)}function f(e,t,n,r,c){var s=c[e.toString()]||[],l=d(s),f=!0!==l.unmanaged,p=r[e];if((p=l.inject||l.multiInject||p)instanceof i.LazyServiceIdentifer&&(p=p.unwrap()),f){if(!t&&(p===Object||p===Function||void 0===p))throw new Error(o.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".");var h=new u.Target(a.TargetTypeEnum.ConstructorArgument,l.targetName,p);return h.metadata=s,h}return null}function p(e,t){for(var n=e.getPropertiesMetadata(t),i=[],o=0,c=Object.keys(n);o<c.length;o++){var s=c[o],l=n[s],f=d(n[s]),h=new u.Target(a.TargetTypeEnum.ClassProperty,f.targetName||s,f.inject||f.multiInject);h.metadata=l,i.push(h)}var v=Object.getPrototypeOf(t.prototype).constructor;if(v!==Object){var g=p(e,v);i=r(i,g)}return i}function d(e){var t={};return e.forEach(function(e){t[e.key.toString()]=e.value}),{inject:t[c.INJECT_TAG],multiInject:t[c.MULTI_INJECT_TAG],targetName:t[c.NAME_TAG],unmanaged:t[c.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return l(e,s.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=l(t,s.getFunctionName(r),r,!0),o=i.map(function(e){return e.metadata.filter(function(e){return e.key===c.UNMANAGED_TAG})}),a=[].concat.apply([],o).length,u=i.length-a;return u>0?u:e(t,r)}return 0}},fbvF:function(e,t,n){e.exports=function(){"use strict";var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},n="\n";function r(e){var t=new Error("(regl) "+e);throw console.error(t),t}function i(e,t){e||r(t)}function o(e){return e?": "+e:""}function a(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function c(e,t,n){t.indexOf(e)<0&&r("invalid value"+o(n)+". must be one of: "+t)}var s=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function u(e,t){for(e+="";e.length<t;)e=" "+e;return e}function l(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function f(e,t){this.number=e,this.line=t,this.errors=[]}function p(e,t,n){this.file=e,this.line=t,this.message=n}function d(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function h(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function v(e,t){var n,r=e.split("\n"),i=1,o=0,a={unknown:new l,0:new l};a.unknown.name=a[0].name=t||d(),a.unknown.lines.push(new f(0,""));for(var c=0;c<r.length;++c){var s=r[c],u=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(s);if(u)switch(u[1]){case"line":var p=/(\d+)(\s+\d+)?/.exec(u[2]);p&&(i=0|p[1],p[2]&&((o=0|p[2])in a||(a[o]=new l)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(u[2]);h&&(a[o].name=h[1]?(n=h[2],"undefined"!=typeof atob?atob(n):"base64:"+n):h[2])}a[o].lines.push(new f(i++,s))}return Object.keys(a).forEach(function(e){var t=a[e];t.lines.forEach(function(e){t.index[e.number]=e})}),a}function g(e){e._commandRef=d()}function m(e,t){var n=h();r(e+" in command "+(t||d())+("unknown"===n?"":" called from "+n))}function y(e,t,n,r){a(e,t)||m("invalid parameter type"+o(n)+". expected "+t+", got "+typeof e,r||d())}var b=33071,_={};function E(e,t){return 32820===e||32819===e||33635===e?2:34042===e?4:_[e]*t}function S(e){return!(e&e-1||!e)}_[5120]=_[5121]=1,_[5122]=_[5123]=_[36193]=_[33635]=_[32819]=_[32820]=2,_[5124]=_[5125]=_[5126]=_[34042]=4;var T=t(i,{optional:function(e){e()},raise:r,commandRaise:m,command:function(e,t,n){e||m(t,n||d())},parameter:function(e,t,n){e in t||r("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join())},commandParameter:function(e,t,n,r){e in t||m("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join(),r||d())},constructor:function(e){Object.keys(e).forEach(function(e){s.indexOf(e)<0&&r('invalid regl constructor argument "'+e+'". must be one of '+s)})},type:function(e,t,n){a(e,t)||r("invalid parameter type"+o(n)+". expected "+t+", got "+typeof e)},commandType:y,isTypedArray:function(t,n){e(t)||r("invalid parameter type"+o(n)+". must be a typed array")},nni:function(e,t){e>=0&&(0|e)===e||r("invalid parameter type, ("+e+")"+o(t)+". must be a nonnegative integer")},oneOf:c,shaderError:function(e,t,r,o,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var c=e.getShaderInfoLog(t),s=o===e.FRAGMENT_SHADER?"fragment":"vertex";y(r,"string",s+" shader source must be a string",a);var l=v(r,a),f=function(e){var t=[];return e.split("\n").forEach(function(e){if(!(e.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);n?t.push(new p(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new p("unknown",0,e))}}),t}(c);(function(e,t){t.forEach(function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})})(l,f),Object.keys(l).forEach(function(e){var t=l[e];if(t.hasErrors){var r=[""],i=[""];o("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach(function(e){if(e.errors.length>0){o(u(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach(function(r){var i=r.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(a){var c=a[1];switch(i=a[2],c){case"assign":c="="}t=Math.max(e.line.indexOf(c,t),0)}else t=0;o(u("| ",6)),o(u("^^^",t+3)+n,"font-weight:bold"),o(u("| ",6)),o(i+n,"font-weight:bold")}),o(u("| ",6)+n)}else o(u(e.number,4)+"|  "),o(e.line+n,"color:red")}),"undefined"==typeof document||window.chrome?console.log(r.join("")):(i[0]=r.join("%c"),console.log.apply(console,i))}function o(e,t){r.push(e),i.push(t||"")}}),i.raise("Error compiling "+s+" shader, "+l[0].name)}},linkError:function(e,t,r,o,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var c=e.getProgramInfoLog(t),s=v(r,a),u='Error linking program with vertex shader, "'+v(o,a)[0].name+'", and fragment shader "'+s[0].name+'"';"undefined"!=typeof document?console.log("%c"+u+"\n%c"+c,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(u+n+c),i.raise(u)}},callSite:h,saveCommandRef:g,saveDrawInfo:function(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach(function(t){e[r.id(t)]=!0})}g(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var c=e._attributeSet={};o(c,n.static),o(c,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,n){e.texture?c(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):c(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:d,texture2D:function(e,t,n){var r,o=t.width,a=t.height,c=t.channels;i(o>0&&o<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),e.wrapS===b&&e.wrapT===b||i(S(o)&&S(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==o&&1!==a&&i(9984!==e.minFilter&&9986!==e.minFilter&&9985!==e.minFilter&&9987!==e.minFilter,"min filter requires mipmap"):(i(S(o)&&S(a),"texture must be a square power of 2 to support mipmapping"),i(t.mipmask===(o<<1)-1,"missing or incomplete mipmap data")),5126===t.type&&(n.extensions.indexOf("oes_texture_float_linear")<0&&i(9728===e.minFilter&&9728===e.magFilter,"filter not supported, must enable oes_texture_float_linear"),i(!e.genMipmaps,"mipmap generation not supported with float textures"));var s=t.images;for(r=0;r<16;++r)if(s[r]){var u=o>>r,l=a>>r;i(t.mipmask&1<<r,"missing mipmap data");var f=s[r];if(i(f.width===u&&f.height===l,"invalid shape for mip images"),i(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed);else if(f.data){var p=Math.ceil(E(f.type,c)*u/f.unpackAlignment)*f.unpackAlignment;i(f.data.byteLength===p*l,"invalid data for image, buffer size is inconsistent with image format")}}else e.genMipmaps||i(0==(t.mipmask&1<<r),"extra mipmap data");t.compressed&&i(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,n,r){var o=e.width,a=e.height,c=e.channels;i(o>0&&o<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),i(o===a,"cube map must be square"),i(t.wrapS===b&&t.wrapT===b,"wrap mode not supported by cube map");for(var s=0;s<n.length;++s){var u=n[s];i(u.width===o&&u.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(i(!u.compressed,"can not generate mipmap for compressed textures"),i(1===u.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=u.images,f=0;f<16;++f){var p=l[f];if(p){var d=o>>f,h=a>>f;i(u.mipmask&1<<f,"missing mipmap data"),i(p.width===d&&p.height===h,"invalid shape for mip images"),i(p.format===e.format&&p.internalformat===e.internalformat&&p.type===e.type,"incompatible type for mip image"),p.compressed||p.data&&i(p.data.byteLength===d*h*Math.max(E(p.type,c),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}}),x=0;function A(e,t){this.id=x++,this.type=e,this.data=t}function O(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function w(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+O(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return w(e.substr(0,r.index)).concat(w(r[1])).concat(w(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+O(e)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(w(i[a]));return o}function k(e){return"["+w(e).join("][")+"]"}var I={DynamicVariable:A,define:function(e,t){return new A(e,k(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof A},unbox:function e(t,n){return"function"==typeof t?new A(0,t):"number"==typeof t||"boolean"==typeof t?new A(5,t):Array.isArray(t)?new A(6,t.map((t,r)=>e(t,n+"["+r+"]"))):t instanceof A?t:void T(!1,"invalid option type in uniform "+n)},accessor:k},P={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},C="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function R(e){return"string"==typeof e?e.split():(T(Array.isArray(e),"invalid extension array"),e)}function M(e){return"string"==typeof e?(T("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function N(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function L(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1}function j(){var e=N(8,function(){return[]});function t(t){var n=function(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}(t),r=e[L(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(t){e[L(t.byteLength)>>2].push(t)}return{alloc:t,free:n,allocType:function(e,n){var r=null;switch(e){case 5120:r=new Int8Array(t(n),0,n);break;case 5121:r=new Uint8Array(t(n),0,n);break;case 5122:r=new Int16Array(t(2*n),0,n);break;case 5123:r=new Uint16Array(t(2*n),0,n);break;case 5124:r=new Int32Array(t(4*n),0,n);break;case 5125:r=new Uint32Array(t(4*n),0,n);break;case 5126:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(e){n(e.buffer)}}}var D=j();D.zero=j();var F=3553,B=6408,U=5126,z=36160;function G(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var V=function(e){return Object.keys(e).map(function(t){return e[t]})},H=function(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t},X=function(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var a=r||D.allocType(n,i);switch(t.length){case 0:break;case 1:!function(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}(e,t[0],a);break;case 2:!function(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var a=e[o],c=0;c<n;++c)r[i++]=a[c]}(e,t[0],t[1],a);break;case 3:W(e,t[0],t[1],t[2],a,0);break;default:Y(e,t,0,a,0)}return a};function W(e,t,n,r,i,o){for(var a=o,c=0;c<t;++c)for(var s=e[c],u=0;u<n;++u)for(var l=s[u],f=0;f<r;++f)i[a++]=l[f]}function Y(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var c=t[n];if(t.length-n==4){var s=t[n+1],u=t[n+2],l=t[n+3];for(a=0;a<c;++a)W(e[a],s,u,l,r,i),i+=o}else for(a=0;a<c;++a)Y(e[a],t,n+1,r,i),i+=o}var Z={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},q={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},K={dynamic:35048,stream:35040,static:35044},Q=X,J=H,$=5121,ee=5126,te=[];function ne(e){return 0|Z[Object.prototype.toString.call(e)]}function re(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function ie(e,t,n,r,i,o,a){for(var c=0,s=0;s<n;++s)for(var u=0;u<r;++u)e[c++]=t[i*s+o*u+a]}te[5120]=1,te[5122]=2,te[5124]=4,te[5121]=1,te[5123]=2,te[5125]=4,te[5126]=4;var oe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ae=5121,ce=5123,se=5125,ue=34963,le=new Float32Array(1),fe=new Uint32Array(le.buffer);function pe(e){for(var t=D.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{le[0]=e[n];var r=fe[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;t[n]=o<-24?i:o<-14?i+(a+1024>>-14-o):o>15?i+31744:i+(o+15<<10)+a}return t}function de(t){return Array.isArray(t)||e(t)}var he=function(e){return!(e&e-1||!e)},ve=3553,ge=34067,me=34069,ye=6408,be=6407,_e=6409,Ee=6410,Se=36193,Te=5121,xe=5126,Ae=33071,Oe=9728,we=9984,ke=9987,Ie=4352,Pe=33984,Ce=[we,9986,9985,ke],Re=[0,_e,Ee,be,ye],Me={};function Ne(e){return"[object "+e+"]"}Me[6409]=Me[6406]=Me[6402]=1,Me[34041]=Me[6410]=2,Me[6407]=Me[35904]=3,Me[6408]=Me[35906]=4;var Le=Ne("HTMLCanvasElement"),je=Ne("OffscreenCanvas"),De=Ne("CanvasRenderingContext2D"),Fe=Ne("ImageBitmap"),Be=Ne("HTMLImageElement"),Ue=Ne("HTMLVideoElement"),ze=Object.keys(Z).concat([Le,je,De,Fe,Be,Ue]),Ge=[];Ge[5121]=1,Ge[5126]=4,Ge[36193]=2,Ge[5123]=2,Ge[5125]=4;var Ve=[];function He(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Xe(e){return!!Array.isArray(e)&&!(0===e.length||!de(e[0]))}function We(e){return Object.prototype.toString.call(e)}function Ye(e){return We(e)===Le}function Ze(e){return We(e)===je}function qe(e){if(!e)return!1;var t=We(e);return ze.indexOf(t)>=0||He(e)||Xe(e)||G(e)}function Ke(e){return 0|Z[Object.prototype.toString.call(e)]}function Qe(e,t){return D.allocType(e.type===Se?xe:e.type,t)}function Je(e,t){e.type===Se?(e.data=pe(t),D.freeType(t)):e.data=t}function $e(e,t,n,r,i,o){var a;if(a=void 0!==Ve[e]?Ve[e]:Me[e]*Ge[t],o&&(a*=6),i){for(var c=0,s=n;s>=1;)c+=a*s*s,s/=2;return c}return a*n*r}Ve[32854]=2,Ve[32855]=2,Ve[36194]=2,Ve[34041]=4,Ve[33776]=.5,Ve[33777]=.5,Ve[33778]=1,Ve[33779]=1,Ve[35986]=.5,Ve[35987]=1,Ve[34798]=1,Ve[35840]=.5,Ve[35841]=.25,Ve[35842]=.5,Ve[35843]=.25,Ve[36196]=.5;var et=36161,tt=32854,nt=[];function rt(e,t,n){return nt[e]*t*n}nt[32854]=2,nt[32855]=2,nt[36194]=2,nt[33189]=2,nt[36168]=1,nt[34041]=4,nt[35907]=4,nt[34836]=16,nt[34842]=8,nt[34843]=6;var it=36160,ot=36161,at=3553,ct=34069,st=[6407,6408],ut=[];ut[6408]=4,ut[6407]=3;var lt=[];lt[5121]=1,lt[5126]=4,lt[36193]=2;var ft=[32854,32855,36194,35907,34842,34843,34836],pt={};function dt(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}pt[36053]="complete",pt[36054]="incomplete attachment",pt[36057]="incomplete dimensions",pt[36055]="incomplete, missing attachment",pt[36061]="unsupported";var ht=5121,vt=5126;function gt(e){return Array.prototype.slice.call(e)}function mt(e){return gt(e).join("")}var yt="xyzw".split(""),bt="dither",_t="blend.enable",Et="blend.color",St="blend.equation",Tt="blend.func",xt="depth.enable",At="depth.func",Ot="depth.range",wt="depth.mask",kt="colorMask",It="cull.enable",Pt="cull.face",Ct="frontFace",Rt="lineWidth",Mt="polygonOffset.enable",Nt="polygonOffset.offset",Lt="sample.alpha",jt="sample.enable",Dt="sample.coverage",Ft="stencil.enable",Bt="stencil.mask",Ut="stencil.func",zt="stencil.opFront",Gt="stencil.opBack",Vt="scissor.enable",Ht="scissor.box",Xt="viewport",Wt="profile",Yt="framebuffer",Zt="vert",qt="frag",Kt="elements",Qt="primitive",Jt="count",$t="offset",en="instances",tn="vao",nn=Yt+"Width",rn=Yt+"Height",on="drawingBufferWidth",an="drawingBufferHeight",cn=[Tt,St,Ut,zt,Gt,Dt,Xt,Ht,Nt],sn=34962,un=5126,ln=35664,fn=35665,pn=35666,dn=5124,hn=35667,vn=35668,gn=35669,mn=35670,yn=35671,bn=35672,_n=35673,En=35674,Sn=35675,Tn=35676,xn=35678,An=35680,On=1028,wn=1029,kn=2305,In=7680,Pn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Cn=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Rn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Mn={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Nn={frag:35632,vert:35633},Ln={cw:2304,ccw:kn};function jn(t){return Array.isArray(t)||e(t)||G(t)}function Dn(e){return e.sort(function(e,t){return e===Xt?-1:t===Xt?1:e<t?-1:1})}function Fn(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function Bn(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Un(e){return new Fn(!1,!1,!1,e)}function zn(e,t){var n=e.type;if(0===n){var r=e.data.length;return new Fn(!0,r>=1,r>=2,t)}if(4===n){var i=e.data;return new Fn(i.thisDep,i.contextDep,i.propDep,t)}if(5===n)return new Fn(!1,!1,!1,t);if(6===n){for(var o=!1,a=!1,c=!1,s=0;s<e.data.length;++s){var u=e.data[s];if(1===u.type)c=!0;else if(2===u.type)a=!0;else if(3===u.type)o=!0;else if(0===u.type){o=!0;var l=u.data;l>=1&&(a=!0),l>=2&&(c=!0)}else 4===u.type&&(o=o||u.data.thisDep,a=a||u.data.contextDep,c=c||u.data.propDep)}return new Fn(o,a,c,t)}return new Fn(3===n,2===n,1===n,t)}var Gn=new Fn(!1,!1,!1,function(){});function Vn(e,n,r,i,o,a,c,s,u,l,f,p,d,h,v){var g=l.Record,m={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(m.min=32775,m.max=32776);var y=r.angle_instanced_arrays,b=r.webgl_draw_buffers,_={dirty:!0,profile:v.profile},E={},S=[],x={},A={};function O(e){return e.replace(".","_")}function w(e,t,n){var r=O(e);S.push(e),E[r]=_[r]=!!n,x[r]=t}function k(e,t,n){var r=O(e);S.push(e),Array.isArray(n)?(_[r]=n.slice(),E[r]=n.slice()):_[r]=E[r]=n,A[r]=t}w(bt,3024),w(_t,3042),k(Et,"blendColor",[0,0,0,0]),k(St,"blendEquationSeparate",[32774,32774]),k(Tt,"blendFuncSeparate",[1,0,1,0]),w(xt,2929,!0),k(At,"depthFunc",513),k(Ot,"depthRange",[0,1]),k(wt,"depthMask",!0),k(kt,kt,[!0,!0,!0,!0]),w(It,2884),k(Pt,"cullFace",wn),k(Ct,Ct,kn),k(Rt,Rt,1),w(Mt,32823),k(Nt,"polygonOffset",[0,0]),w(Lt,32926),w(jt,32928),k(Dt,"sampleCoverage",[1,!1]),w(Ft,2960),k(Bt,"stencilMask",-1),k(Ut,"stencilFunc",[519,0,-1]),k(zt,"stencilOpSeparate",[On,In,In,In]),k(Gt,"stencilOpSeparate",[wn,In,In,In]),w(Vt,3089),k(Ht,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),k(Xt,Xt,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var P={gl:e,context:d,strings:n,next:E,current:_,draw:p,elements:a,buffer:o,shader:f,attributes:l.state,vao:l,uniforms:u,framebuffer:s,extensions:r,timer:h,isBufferArgs:jn},C={primTypes:oe,compareFuncs:Rn,blendFuncs:Pn,blendEquations:m,stencilOps:Mn,glTypes:q,orientationType:Ln};T.optional(function(){P.isArrayLike=de}),b&&(C.backBuffer=[wn],C.drawBuffer=N(i.maxDrawbuffers,function(e){return 0===e?[0]:N(e,function(e){return 36064+e})}));var R=0;function M(){var e=function(){var e=0,n=[],r=[];function i(){var n=[],r=[];return t(function(){n.push.apply(n,gt(arguments))},{def:function(){var t="v"+e++;return r.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,gt(arguments)),n.push(";")),t},toString:function(){return mt([r.length>0?"var "+r.join(",")+";":"",mt(n)])}})}function o(){var e=i(),n=i(),r=e.toString,o=n.toString;function a(t,r){n(t,r,"=",e.def(t,r),";")}return t(function(){e.apply(e,gt(arguments))},{def:e.def,entry:e,exit:n,save:a,set:function(t,n,r){a(t,n),e(t,n,"=",r,";")},toString:function(){return r()+o()}})}var a=i(),c={};return{global:a,link:function(t){for(var i=0;i<r.length;++i)if(r[i]===t)return n[i];var o="g"+e++;return n.push(o),r.push(t),o},block:i,proc:function(e,n){var r=[];function i(){var e="a"+r.length;return r.push(e),e}n=n||0;for(var a=0;a<n;++a)i();var s=o(),u=s.toString;return c[e]=t(s,{arg:i,toString:function(){return mt(["function(",r.join(),"){",u(),"}"])}})},scope:o,cond:function(){var e=mt(arguments),n=o(),r=o(),i=n.toString,a=r.toString;return t(n,{then:function(){return n.apply(n,gt(arguments)),this},else:function(){return r.apply(r,gt(arguments)),this},toString:function(){var t=a();return t&&(t="else{"+t+"}"),mt(["if(",e,"){",i(),"}",t])}})},compile:function(){var e=['"use strict";',a,"return {"];Object.keys(c).forEach(function(t){e.push('"',t,'":',c[t].toString(),",")}),e.push("}");var t=mt(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(t)).apply(null,r)}}}(),r=e.link,i=e.global;e.id=R++,e.batchId="0";var o=r(P),a=e.shared={props:"a0"};Object.keys(P).forEach(function(e){a[e]=i.def(o,".",e)}),T.optional(function(){e.CHECK=r(T),e.commandStr=T.guessCommand(),e.command=r(e.commandStr),e.assert=function(e,t,n){e("if(!(",t,"))",this.CHECK,".commandRaise(",r(n),",",this.command,");")},C.invalidBlendCombinations=Cn});var c=e.next={},s=e.current={};Object.keys(A).forEach(function(e){Array.isArray(_[e])&&(c[e]=i.def(a.next,".",e),s[e]=i.def(a.current,".",e))});var u=e.constants={};Object.keys(C).forEach(function(e){u[e]=i.def(JSON.stringify(C[e]))}),e.invoke=function(t,n){switch(n.type){case 0:var i=["this",a.context,a.props,e.batchId];return t.def(r(n.data),".call(",i.slice(0,Math.max(n.data.length+1,4)),")");case 1:return t.def(a.props,n.data);case 2:return t.def(a.context,n.data);case 3:return t.def("this",n.data);case 4:return n.data.append(e,t),n.data.ref;case 5:return n.data.toString();case 6:return n.data.map(function(n){return e.invoke(t,n)})}},e.attribCache={};var f={};return e.scopeAttrib=function(e){var t=n.id(e);if(t in f)return f[t];var i=l.scope[t];return i||(i=l.scope[t]=new g),f[t]=r(i)},e}function L(e,t,n){var r=e.shared.context,i=e.scope();Object.keys(n).forEach(function(o){t.save(r,"."+o);var a=n[o].append(e,t);Array.isArray(a)?i(r,".",o,"=[",a.join(),"];"):i(r,".",o,"=",a,";")}),t(i)}function j(e,t,n,r){var i,o=e.shared,a=o.gl,c=o.framebuffer;b&&(i=t.def(o.extensions,".webgl_draw_buffers"));var s,u=e.constants,l=u.drawBuffer,f=u.backBuffer;s=n?n.append(e,t):t.def(c,".next"),r||t("if(",s,"!==",c,".cur){"),t("if(",s,"){",a,".bindFramebuffer(",36160,",",s,".framebuffer);"),b&&t(i,".drawBuffersWEBGL(",l,"[",s,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",36160,",null);"),b&&t(i,".drawBuffersWEBGL(",f,");"),t("}",c,".cur=",s,";"),r||t("}")}function D(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,c=r.current,s=r.next,u=e.cond(c,".dirty");S.forEach(function(t){var r,l,f=O(t);if(!(f in n.state))if(f in a){r=a[f],l=o[f];var p=N(_[f].length,function(e){return u.def(r,"[",e,"]")});u(e.cond(p.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(i,".",A[f],"(",p,");",p.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else{r=u.def(s,".",f);var d=e.cond(r,"!==",c,".",f);u(d),f in x?d(e.cond(r).then(i,".enable(",x[f],");").else(i,".disable(",x[f],");"),c,".",f,"=",r,";"):d(i,".",A[f],"(",r,");",c,".",f,"=",r,";")}}),0===Object.keys(n.state).length&&u(c,".dirty=false;"),t(u)}function F(e,t,n,r){var i=e.shared,o=e.current,a=i.current,c=i.gl;Dn(Object.keys(n)).forEach(function(i){var s=n[i];if(!r||r(s)){var u=s.append(e,t);if(x[i]){var l=x[i];Bn(s)?t(c,u?".enable(":".disable(",l,");"):t(e.cond(u).then(c,".enable(",l,");").else(c,".disable(",l,");")),t(a,".",i,"=",u,";")}else if(de(u)){var f=o[i];t(c,".",A[i],"(",u,");",u.map(function(e,t){return f+"["+t+"]="+e}).join(";"),";")}else t(c,".",A[i],"(",u,");",a,".",i,"=",u,";")}})}function B(e,t){y&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function U(e,t,n,r,i){var o,a,c,s=e.shared,u=e.stats,l=s.current,f=s.timer,p=n.profile;function d(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function v(e){e(o=t.def(),"=",d(),";"),"string"==typeof i?e(u,".count+=",i,";"):e(u,".count++;"),h&&(r?e(a=t.def(),"=",f,".getNumPendingQueries();"):e(f,".beginQuery(",u,");"))}function g(e){e(u,".cpuTime+=",d(),"-",o,";"),h&&(r?e(f,".pushScopeStats(",a,",",f,".getNumPendingQueries(),",u,");"):e(f,".endQuery();"))}function m(e){var n=t.def(l,".profile");t(l,".profile=",e,";"),t.exit(l,".profile=",n,";")}if(p){if(Bn(p))return void(p.enable?(v(t),g(t.exit),m("true")):m("false"));m(c=p.append(e,t))}else c=t.def(l,".profile");var y=e.block();v(y),t("if(",c,"){",y,"}");var b=e.block();g(b),t.exit("if(",c,"){",b,"}")}function z(e,t,n,r,i){var o=e.shared;r.forEach(function(r){var a,c=r.name,s=n.attributes[c];if(s){if(!i(s))return;a=s.append(e,t)}else{if(!i(Gn))return;var u=e.scopeAttrib(c);T.optional(function(){e.assert(t,u+".state","missing attribute "+c)}),a={},Object.keys(new g).forEach(function(e){a[e]=t.def(u,".",e)})}!function(n,r,i){var a=o.gl,c=t.def(n,".location"),s=t.def(o.attributes,"[",c,"]"),u=i.state,l=i.buffer,f=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];function d(){t("if(!",s,".buffer){",a,".enableVertexAttribArray(",c,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",s,".type!==",o,"||",s,".size!==",n,"||",p.map(function(e){return s+"."+e+"!=="+i[e]}).join("||"),"){",a,".bindBuffer(",sn,",",l,".buffer);",a,".vertexAttribPointer(",[c,n,o,i.normalized,i.stride,i.offset],");",s,".type=",o,";",s,".size=",n,";",p.map(function(e){return s+"."+e+"="+i[e]+";"}).join(""),"}"),y){var u=i.divisor;t("if(",s,".divisor!==",u,"){",e.instancing,".vertexAttribDivisorANGLE(",[c,u],");",s,".divisor=",u,";}")}}function h(){t("if(",s,".buffer){",a,".disableVertexAttribArray(",c,");",s,".buffer=null;","}if(",yt.map(function(e,t){return s+"."+e+"!=="+f[t]}).join("||"),"){",a,".vertexAttrib4f(",c,",",f,");",yt.map(function(e,t){return s+"."+e+"="+f[t]+";"}).join(""),"}")}1===u?d():2===u?h():(t("if(",u,"===",1,"){"),d(),t("}else{"),h(),t("}"))}(e.link(r),function(e){switch(e){case ln:case hn:case yn:return 2;case fn:case vn:case bn:return 3;case pn:case gn:case _n:return 4;default:return 1}}(r.info.type),a)})}function G(e,t,r,i,o){for(var a,c=e.shared,s=c.gl,u=0;u<i.length;++u){var l,f=i[u],p=f.name,d=f.info.type,h=r.uniforms[p],v=e.link(f)+".location";if(h){if(!o(h))continue;if(Bn(h)){var g=h.value;if(T.command(null!=g,'missing uniform "'+p+'"',e.commandStr),d===xn||d===An){T.command("function"==typeof g&&(d===xn&&("texture2d"===g._reglType||"framebuffer"===g._reglType)||d===An&&("textureCube"===g._reglType||"framebufferCube"===g._reglType)),"invalid texture for uniform "+p,e.commandStr);var m=e.link(g._texture||g.color[0]._texture);t(s,".uniform1i(",v,",",m+".bind());"),t.exit(m,".unbind();")}else if(d===En||d===Sn||d===Tn){T.optional(function(){T.command(de(g),"invalid matrix for uniform "+p,e.commandStr),T.command(d===En&&4===g.length||d===Sn&&9===g.length||d===Tn&&16===g.length,"invalid length for matrix uniform "+p,e.commandStr)});var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),b=2;d===Sn?b=3:d===Tn&&(b=4),t(s,".uniformMatrix",b,"fv(",v,",false,",y,");")}else{switch(d){case un:T.commandType(g,"number","uniform "+p,e.commandStr),a="1f";break;case ln:T.command(de(g)&&2===g.length,"uniform "+p,e.commandStr),a="2f";break;case fn:T.command(de(g)&&3===g.length,"uniform "+p,e.commandStr),a="3f";break;case pn:T.command(de(g)&&4===g.length,"uniform "+p,e.commandStr),a="4f";break;case mn:T.commandType(g,"boolean","uniform "+p,e.commandStr),a="1i";break;case dn:T.commandType(g,"number","uniform "+p,e.commandStr),a="1i";break;case yn:case hn:T.command(de(g)&&2===g.length,"uniform "+p,e.commandStr),a="2i";break;case bn:case vn:T.command(de(g)&&3===g.length,"uniform "+p,e.commandStr),a="3i";break;case _n:case gn:T.command(de(g)&&4===g.length,"uniform "+p,e.commandStr),a="4i"}t(s,".uniform",a,"(",v,",",de(g)?Array.prototype.slice.call(g):g,");")}continue}l=h.append(e,t)}else{if(!o(Gn))continue;l=t.def(c.uniforms,"[",n.id(p),"]")}d===xn?(T(!Array.isArray(l),"must specify a scalar prop for textures"),t("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}")):d===An&&(T(!Array.isArray(l),"must specify a scalar prop for cube maps"),t("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}")),T.optional(function(){function n(n,r){e.assert(t,n,'bad data or missing for uniform "'+p+'".  '+r)}function r(e){T(!Array.isArray(l),"must not specify an array type for uniform"),n("typeof "+l+'==="'+e+'"',"invalid type, expected "+e)}function i(e,t){Array.isArray(l)?T(l.length===e,"must have length "+e):n(c.isArrayLike+"("+l+")&&"+l+".length==="+e,"invalid vector, should have length "+e)}function o(e){T(!Array.isArray(l),"must not specify a value type"),n("typeof "+l+'==="function"&&'+l+'._reglType==="texture'+(3553===e?"2d":"Cube")+'"',"invalid texture type")}switch(d){case dn:r("number");break;case hn:i(2);break;case vn:i(3);break;case gn:i(4);break;case un:r("number");break;case ln:i(2);break;case fn:i(3);break;case pn:i(4);break;case mn:r("boolean");break;case yn:i(2);break;case bn:i(3);break;case _n:case En:i(4);break;case Sn:i(9);break;case Tn:i(16);break;case xn:o(3553);break;case An:o(34067)}});var _=1;switch(d){case xn:case An:var E=t.def(l,"._texture");t(s,".uniform1i(",v,",",E,".bind());"),t.exit(E,".unbind();");continue;case dn:case mn:a="1i";break;case hn:case yn:a="2i",_=2;break;case vn:case bn:a="3i",_=3;break;case gn:case _n:a="4i",_=4;break;case un:a="1f";break;case ln:a="2f",_=2;break;case fn:a="3f",_=3;break;case pn:a="4f",_=4;break;case En:a="Matrix2fv";break;case Sn:a="Matrix3fv";break;case Tn:a="Matrix4fv"}if(t(s,".uniform",a,"(",v,","),"M"===a.charAt(0)){var S=Math.pow(d-En+2,2),x=e.global.def("new Float32Array(",S,")");Array.isArray(l)?t("false,(",N(S,function(e){return x+"["+e+"]="+l[e]}),",",x,")"):t("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",N(S,function(e){return x+"["+e+"]="+l+"["+e+"]"}),",",x,")")}else _>1?t(N(_,function(e){return Array.isArray(l)?l[e]:l+"["+e+"]"})):(T(!Array.isArray(l),"uniform value must not be an array"),t(l));t(");")}}function V(e,t,n,r){var i=e.shared,o=i.gl,a=i.draw,c=r.draw,s=function(){var i,s=c.elements,u=t;return s?((s.contextDep&&r.contextDynamic||s.propDep)&&(u=n),i=s.append(e,u)):i=u.def(a,".",Kt),i&&u("if("+i+")"+o+".bindBuffer(34963,"+i+".buffer.buffer);"),i}();function u(i){var o=c[i];return o?o.append(e,o.contextDep&&r.contextDynamic||o.propDep?n:t):t.def(a,".",i)}var l,f,p=u(Qt),d=u($t),h=function(){var i,o=c.count,s=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(s=n),i=o.append(e,s),T.optional(function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(s,i+">=0","missing vertex count")})):(i=s.def(a,".",Jt),T.optional(function(){e.assert(s,i+">=0","missing vertex count")})),i}();if("number"==typeof h){if(0===h)return}else n("if(",h,"){"),n.exit("}");y&&(l=u(en),f=e.instancing);var v=s+".type",g=c.elements&&Bn(c.elements);function m(){function e(){n(f,".drawElementsInstancedANGLE(",[p,h,v,d+"<<(("+v+"-5121)>>1)",l],");")}function t(){n(f,".drawArraysInstancedANGLE(",[p,d,h,l],");")}s?g?e():(n("if(",s,"){"),e(),n("}else{"),t(),n("}")):t()}function b(){function e(){n(o+".drawElements("+[p,h,v,d+"<<(("+v+"-5121)>>1)"]+");")}function t(){n(o+".drawArrays("+[p,d,h]+");")}s?g?e():(n("if(",s,"){"),e(),n("}else{"),t(),n("}")):t()}y&&("number"!=typeof l||l>=0)?"string"==typeof l?(n("if(",l,">0){"),m(),n("}else if(",l,"<0){"),b(),n("}")):m():b()}function H(e,t,n,r,i){var o=M(),a=o.proc("body",i);return T.optional(function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)}),y&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,r),o.compile().body}function X(e,t,n,r){B(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),z(e,t,n,r.attributes,function(){return!0})),G(e,t,n,r.uniforms,function(){return!0}),V(e,t,t,n)}function W(e,t,n,r){function i(){return!0}e.batchId="a1",B(e,t),z(e,t,n,r.attributes,i),G(e,t,n,r.uniforms,i),V(e,t,t,n)}function Y(e,t,n,r){B(e,t);var i=n.contextDep,o=t.def(),a=t.def();e.shared.props=a,e.batchId=o;var c=e.scope(),s=e.scope();function u(e){return e.contextDep&&i||e.propDep}function l(e){return!u(e)}if(t(c.entry,"for(",o,"=0;",o,"<","a1",";++",o,"){",a,"=","a0","[",o,"];",s,"}",c.exit),n.needsContext&&L(e,s,n.context),n.needsFramebuffer&&j(e,s,n.framebuffer),F(e,s,n.state,u),n.profile&&u(n.profile)&&U(e,s,n,!1,!0),r)n.useVAO?n.drawVAO?u(n.drawVAO)?s(e.shared.vao,".setVAO(",n.drawVAO.append(e,s),");"):c(e.shared.vao,".setVAO(",n.drawVAO.append(e,c),");"):c(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(c(e.shared.vao,".setVAO(null);"),z(e,c,n,r.attributes,l),z(e,s,n,r.attributes,u)),G(e,c,n,r.uniforms,l),G(e,s,n,r.uniforms,u),V(e,c,s,n);else{var f=e.global.def("{}"),p=n.shader.progVar.append(e,s),d=s.def(p,".id"),h=s.def(f,"[",d,"]");s(e.shared.gl,".useProgram(",p,".program);","if(!",h,"){",h,"=",f,"[",d,"]=",e.link(function(t){return H(W,e,n,t,2)}),"(",p,");}",h,".call(this,a0[",o,"],",o,");")}}function Z(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!de(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(I.isDynamic(e[t[n]]))return!0;return!1}}(r)){var i=e.global,o=Object.keys(r),a=!1,c=!1,s=!1,u=e.global.def("{}");o.forEach(function(t){var n=r[t];if(I.isDynamic(n)){"function"==typeof n&&(n=r[t]=I.unbox(n));var o=zn(n,null);a=a||o.thisDep,s=s||o.propDep,c=c||o.contextDep}else{switch(i(u,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}}),t.dynamic[n]=new I.DynamicVariable(4,{thisDep:a,contextDep:c,propDep:s,ref:u,append:function(e,t){o.forEach(function(n){var i=r[n];if(I.isDynamic(i)){var o=e.invoke(t,i);t(u,".",n,"=",o,";")}})}}),delete t.static[n]}}return{next:E,current:_,procs:function(){var e=M(),t=e.proc("poll"),n=e.proc("refresh"),o=e.block();t(o),n(o);var a,c=e.shared,s=c.gl,u=c.next,l=c.current;o(l,".dirty=false;"),j(e,t),j(e,n,null,!0),y&&(a=e.link(y)),r.oes_vertex_array_object&&n(e.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var f=0;f<i.maxAttributes;++f){var p=n.def(c.attributes,"[",f,"]"),d=e.cond(p,".buffer");d.then(s,".enableVertexAttribArray(",f,");",s,".bindBuffer(",sn,",",p,".buffer.buffer);",s,".vertexAttribPointer(",f,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(s,".disableVertexAttribArray(",f,");",s,".vertexAttrib4f(",f,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),n(d),y&&n(a,".vertexAttribDivisorANGLE(",f,",",p,".divisor);")}return n(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(x).forEach(function(r){var i=x[r],a=o.def(u,".",r),c=e.block();c("if(",a,"){",s,".enable(",i,")}else{",s,".disable(",i,")}",l,".",r,"=",a,";"),n(c),t("if(",a,"!==",l,".",r,"){",c,"}")}),Object.keys(A).forEach(function(r){var i,a,c=A[r],f=_[r],p=e.block();if(p(s,".",c,"("),de(f)){var d=f.length;i=e.global.def(u,".",r),a=e.global.def(l,".",r),p(N(d,function(e){return i+"["+e+"]"}),");",N(d,function(e){return a+"["+e+"]="+i+"["+e+"];"}).join("")),t("if(",N(d,function(e){return i+"["+e+"]!=="+a+"["+e+"]"}).join("||"),"){",p,"}")}else i=o.def(u,".",r),a=o.def(l,".",r),p(i,");",l,".",r,"=",i,";"),t("if(",i,"!==",a,"){",p,"}");n(p)}),e.compile()}(),compile:function(e,c,u,p,d){var h=M();h.stats=h.link(d),Object.keys(c.static).forEach(function(e){Z(h,c,e)}),cn.forEach(function(t){Z(h,e,t)});var v=function(e,t,c,u,p){var d=e.static,h=e.dynamic;T.optional(function(){var e=[Yt,Zt,qt,Kt,Qt,$t,Jt,en,Wt,tn].concat(S);function t(t){Object.keys(t).forEach(function(t){T.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',p.commandStr)})}t(d),t(h)});var v=function(e,t){var n=e.static;if("string"==typeof n[qt]&&"string"==typeof n[Zt]){if(Object.keys(t.dynamic).length>0)return null;var r=t.static,i=Object.keys(r);if(i.length>0&&"number"==typeof r[i[0]]){for(var o=[],a=0;a<i.length;++a)T("number"==typeof r[i[a]],"must specify all vertex attribute locations when using vaos"),o.push([0|r[i[a]],i[a]]);return o}}return null}(e,t),b=function(e,t){var n=e.static,r=e.dynamic;if(Yt in n){var i=n[Yt];return i?(i=s.getFramebuffer(i),T.command(i,"invalid framebuffer object"),Un(function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+nn,n+".width"),t.set(o,"."+rn,n+".height"),n})):Un(function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+nn,r+"."+on),t.set(r,"."+rn,r+"."+an),"null"})}if(Yt in r){var o=r[Yt];return zn(o,function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,a=t.def(i,".getFramebuffer(",n,")");T.optional(function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")}),t.set(i,".next",a);var c=r.context;return t.set(c,"."+nn,a+"?"+a+".width:"+c+"."+on),t.set(c,"."+rn,a+"?"+a+".height:"+c+"."+an),a})}return null}(e),_=function(e,t,n){var r=e.static,i=e.dynamic;function o(e){if(e in r){var o=r[e];T.commandType(o,"object","invalid "+e,n.commandStr);var a,c,s=!0,u=0|o.x,l=0|o.y;return"width"in o?T.command((a=0|o.width)>=0,"invalid "+e,n.commandStr):s=!1,"height"in o?T.command((c=0|o.height)>=0,"invalid "+e,n.commandStr):s=!1,new Fn(!s&&t&&t.thisDep,!s&&t&&t.contextDep,!s&&t&&t.propDep,function(e,t){var n=e.shared.context,r=a;"width"in o||(r=t.def(n,".",nn,"-",u));var i=c;return"height"in o||(i=t.def(n,".",rn,"-",l)),[u,l,r,i]})}if(e in i){var f=i[e],p=zn(f,function(t,n){var r=t.invoke(n,f);T.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var i=t.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),c=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",nn,"-",o,")"),s=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",rn,"-",a,")");return T.optional(function(){t.assert(n,c+">=0&&"+s+">=0","invalid "+e)}),[o,a,c,s]});return t&&(p.thisDep=p.thisDep||t.thisDep,p.contextDep=p.contextDep||t.contextDep,p.propDep=p.propDep||t.propDep),p}return t?new Fn(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",nn),t.def(n,".",rn)]}):null}var a=o(Xt);if(a){var c=a;a=new Fn(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=c.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:a,scissor_box:o(Ht)}}(e,b,p),E=function(e,t){var n=e.static,r=e.dynamic,i=function(){if(Kt in n){var e=n[Kt];jn(e)?e=a.getElements(a.create(e,!0)):e&&(e=a.getElements(e),T.command(e,"invalid elements",t.commandStr));var i=Un(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null});return i.value=e,i}if(Kt in r){var o=r[Kt];return zn(o,function(e,t){var n=e.shared,r=n.isBufferArgs,i=n.elements,a=e.invoke(t,o),c=t.def("null"),s=t.def(r,"(",a,")"),u=e.cond(s).then(c,"=",i,".createStream(",a,");").else(c,"=",i,".getElements(",a,");");return T.optional(function(){e.assert(u.else,"!"+a+"||"+c,"invalid elements")}),t.entry(u),t.exit(e.cond(s).then(i,".destroyStream(",c,");")),e.ELEMENTS=c,c})}return null}();function o(e,o){if(e in n){var a=0|n[e];return T.command(!o||a>=0,"invalid "+e,t.commandStr),Un(function(e,t){return o&&(e.OFFSET=a),a})}if(e in r){var c=r[e];return zn(c,function(t,n){var r=t.invoke(n,c);return o&&(t.OFFSET=r,T.optional(function(){t.assert(n,r+">=0","invalid "+e)})),r})}return o&&i?Un(function(e,t){return e.OFFSET="0",0}):null}var c=o($t,!0);return{elements:i,primitive:function(){if(Qt in n){var e=n[Qt];return T.commandParameter(e,oe,"invalid primitve",t.commandStr),Un(function(t,n){return oe[e]})}if(Qt in r){var o=r[Qt];return zn(o,function(e,t){var n=e.constants.primTypes,r=e.invoke(t,o);return T.optional(function(){e.assert(t,r+" in "+n,"invalid primitive, must be one of "+Object.keys(oe))}),t.def(n,"[",r,"]")})}return i?Bn(i)?Un(i.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return 4}):new Fn(i.thisDep,i.contextDep,i.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if(Jt in n){var e=0|n[Jt];return T.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),Un(function(){return e})}if(Jt in r){var o=r[Jt];return zn(o,function(e,t){var n=e.invoke(t,o);return T.optional(function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")}),n})}if(i){if(Bn(i)){if(i)return c?new Fn(c.thisDep,c.contextDep,c.propDep,function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return T.optional(function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")}),n}):Un(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var a=Un(function(){return-1});return T.optional(function(){a.MISSING=!0}),a}var s=new Fn(i.thisDep||c.thisDep,i.contextDep||c.contextDep,i.propDep||c.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")});return T.optional(function(){s.DYNAMIC=!0}),s}return null}(),instances:o(en,!1),offset:c}}(e,p),x=function(e,t){var n=e.static,r=e.dynamic,o={};return S.forEach(function(e){var a=O(e);function c(t,i){if(e in n){var c=t(n[e]);o[a]=Un(function(){return c})}else if(e in r){var s=r[e];o[a]=zn(s,function(e,t){return i(e,t,e.invoke(t,s))})}}switch(e){case It:case _t:case bt:case Ft:case xt:case Vt:case Mt:case Lt:case jt:case wt:return c(function(n){return T.commandType(n,"boolean",e,t.commandStr),n},function(t,n,r){return T.optional(function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)}),r});case At:return c(function(n){return T.commandParameter(n,Rn,"invalid "+e,t.commandStr),Rn[n]},function(t,n,r){var i=t.constants.compareFuncs;return T.optional(function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(Rn))}),n.def(i,"[",r,"]")});case Ot:return c(function(e){return T.command(de(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,n){return T.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")}),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]});case Tt:return c(function(e){T.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return T.commandParameter(n,Pn,a+".srcRGB",t.commandStr),T.commandParameter(r,Pn,a+".srcAlpha",t.commandStr),T.commandParameter(i,Pn,a+".dstRGB",t.commandStr),T.commandParameter(o,Pn,a+".dstAlpha",t.commandStr),T.command(-1===Cn.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[Pn[n],Pn[i],Pn[r],Pn[o]]},function(t,n,r){var i=t.constants.blendFuncs;function o(o,a){var c=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return T.optional(function(){t.assert(n,c+" in "+i,"invalid "+e+"."+o+a+", must be one of "+Object.keys(Pn))}),c}T.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var a=o("src","RGB"),c=o("dst","RGB");T.optional(function(){t.assert(n,t.constants.invalidBlendCombinations+".indexOf("+a+'+", "+'+c+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var s=n.def(i,"[",a,"]"),u=n.def(i,"[",o("src","Alpha"),"]");return[s,n.def(i,"[",c,"]"),u,n.def(i,"[",o("dst","Alpha"),"]")]});case St:return c(function(n){return"string"==typeof n?(T.commandParameter(n,m,"invalid "+e,t.commandStr),[m[n],m[n]]):"object"==typeof n?(T.commandParameter(n.rgb,m,e+".rgb",t.commandStr),T.commandParameter(n.alpha,m,e+".alpha",t.commandStr),[m[n.rgb],m[n.alpha]]):void T.commandRaise("invalid blend.equation",t.commandStr)},function(t,n,r){var i=t.constants.blendEquations,o=n.def(),a=n.def(),c=t.cond("typeof ",r,'==="string"');return T.optional(function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(m))}n(c.then,e,r),t.assert(c.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(c.else,e+".rgb",r+".rgb"),n(c.else,e+".alpha",r+".alpha")}),c.then(o,"=",a,"=",i,"[",r,"];"),c.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(c),[o,a]});case Et:return c(function(e){return T.command(de(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),N(4,function(t){return+e[t]})},function(e,t,n){return T.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),N(4,function(e){return t.def("+",n,"[",e,"]")})});case Bt:return c(function(e){return T.commandType(e,"number",a,t.commandStr),0|e},function(e,t,n){return T.optional(function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")}),t.def(n,"|0")});case Ut:return c(function(n){T.commandType(n,"object",a,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return T.commandParameter(r,Rn,e+".cmp",t.commandStr),T.commandType(i,"number",e+".ref",t.commandStr),T.commandType(o,"number",e+".mask",t.commandStr),[Rn[r],i,o]},function(e,t,n){var r=e.constants.compareFuncs;return T.optional(function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")}),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",In),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case zt:case Gt:return c(function(n){T.commandType(n,"object",a,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return T.commandParameter(r,Mn,e+".fail",t.commandStr),T.commandParameter(i,Mn,e+".zfail",t.commandStr),T.commandParameter(o,Mn,e+".zpass",t.commandStr),[e===Gt?wn:On,Mn[r],Mn[i],Mn[o]]},function(t,n,r){var i=t.constants.stencilOps;function o(o){return T.optional(function(){t.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+e+"."+o+", must be one of "+Object.keys(Mn))}),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",In)}return T.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[e===Gt?wn:On,o("fail"),o("zfail"),o("zpass")]});case Nt:return c(function(e){T.commandType(e,"object",a,t.commandStr);var n=0|e.factor,r=0|e.units;return T.commandType(n,"number",a+".factor",t.commandStr),T.commandType(r,"number",a+".units",t.commandStr),[n,r]},function(t,n,r){return T.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[n.def(r,".factor|0"),n.def(r,".units|0")]});case Pt:return c(function(e){var n=0;return"front"===e?n=On:"back"===e&&(n=wn),T.command(!!n,a,t.commandStr),n},function(e,t,n){return T.optional(function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),t.def(n,'==="front"?',On,":",wn)});case Rt:return c(function(e){return T.command("number"==typeof e&&e>=i.lineWidthDims[0]&&e<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],t.commandStr),e},function(e,t,n){return T.optional(function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")}),n});case Ct:return c(function(e){return T.commandParameter(e,Ln,a,t.commandStr),Ln[e]},function(e,t,n){return T.optional(function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),t.def(n+'==="cw"?2304:'+kn)});case kt:return c(function(e){return T.command(de(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,n){return T.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),N(4,function(e){return"!!"+n+"["+e+"]"})});case Dt:return c(function(e){T.command("object"==typeof e&&e,a,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return T.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]},function(e,t,n){return T.optional(function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")}),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]})}}),o}(e,p),A=function(e,t,r){var i=e.static,o=e.dynamic;function a(e){if(e in i){var t=n.id(i[e]);T.optional(function(){f.shader(Nn[e],t,T.guessCommand())});var r=Un(function(){return t});return r.id=t,r}if(e in o){var a=o[e];return zn(a,function(t,n){var r=t.invoke(n,a),i=n.def(t.shared.strings,".id(",r,")");return T.optional(function(){n(t.shared.shader,".shader(",Nn[e],",",i,",",t.command,");")}),i})}return null}var c,s=a(qt),u=a(Zt),l=null;return Bn(s)&&Bn(u)?(l=f.program(u.id,s.id,null,r),c=Un(function(e,t){return e.link(l)})):c=new Fn(s&&s.thisDep||u&&u.thisDep,s&&s.contextDep||u&&u.contextDep,s&&s.propDep||u&&u.propDep,function(e,t){var n,r=e.shared.shader;n=s?s.append(e,t):t.def(r,".",qt);var i=r+".program("+(u?u.append(e,t):t.def(r,".",Zt))+","+n;return T.optional(function(){i+=","+e.command}),t.def(i+")")}),{frag:s,vert:u,progVar:c,program:l}}(e,0,v);function w(e){var t=_[e];t&&(x[e]=t)}w(Xt),w(O(Ht));var k=Object.keys(x).length>0,I={framebuffer:b,draw:E,shader:A,state:x,dirty:k,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(I.profile=function(e){var t,n=e.static,r=e.dynamic;if(Wt in n){var i=!!n[Wt];(t=Un(function(e,t){return i})).enable=i}else if(Wt in r){var o=r[Wt];t=zn(o,function(e,t){return e.invoke(t,o)})}return t}(e),I.uniforms=function(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach(function(e){var r,o=n[e];if("number"==typeof o||"boolean"==typeof o)r=Un(function(){return o});else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=Un(function(e){return e.link(o)}):"framebuffer"===a||"framebufferCube"===a?(T.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=Un(function(e){return e.link(o.color[0])})):T.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else de(o)?r=Un(function(t){return t.global.def("[",N(o.length,function(n){return T.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+e,t.commandStr),o[n]}),"]")}):T.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=zn(t,function(e,n){return e.invoke(n,t)})}),i}(c,p),I.drawVAO=I.scopeVAO=function(e,t){var n=e.static,r=e.dynamic;if(tn in n){var i=n[tn];return null!==i&&null===l.getVAO(i)&&(i=l.createVAO(i)),Un(function(e){return e.link(l.getVAO(i))})}if(tn in r){var o=r[tn];return zn(o,function(e,t){var n=e.invoke(t,o);return t.def(e.shared.vao+".getVAO("+n+")")})}return null}(e),!I.drawVAO&&A.program&&!v&&r.angle_instanced_arrays){var P=!0,C=A.program.attributes.map(function(e){var n=t.static[e];return P=P&&!!n,n});if(P&&C.length>0){var R=l.getVAO(l.createVAO(C));I.drawVAO=new Fn(null,null,null,function(e,t){return e.link(R)}),I.useVAO=!0}}return v?I.useVAO=!0:I.attributes=function(e,t){var r=e.static,i=e.dynamic,a={};return Object.keys(r).forEach(function(e){var i=r[e],c=n.id(e),s=new g;if(jn(i))s.state=1,s.buffer=o.getBuffer(o.create(i,sn,!1,!0)),s.type=0;else{var u=o.getBuffer(i);if(u)s.state=1,s.buffer=u,s.type=0;else if(T.command("object"==typeof i&&i,"invalid data for attribute "+e,t.commandStr),"constant"in i){var l=i.constant;s.buffer="null",s.state=2,"number"==typeof l?s.x=l:(T.command(de(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+e,t.commandStr),yt.forEach(function(e,t){t<l.length&&(s[e]=l[t])}))}else{u=jn(i.buffer)?o.getBuffer(o.create(i.buffer,sn,!1,!0)):o.getBuffer(i.buffer),T.command(!!u,'missing buffer for attribute "'+e+'"',t.commandStr);var f=0|i.offset;T.command(f>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var p=0|i.stride;T.command(p>=0&&p<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var d=0|i.size;T.command(!("size"in i)||d>0&&d<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var h=!!i.normalized,v=0;"type"in i&&(T.commandParameter(i.type,q,"invalid type for attribute "+e,t.commandStr),v=q[i.type]);var m=0|i.divisor;"divisor"in i&&(T.command(0===m||y,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),T.command(m>=0,'invalid divisor for attribute "'+e+'"',t.commandStr)),T.optional(function(){var n=t.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach(function(t){T.command(r.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",n)})}),s.buffer=u,s.state=1,s.size=d,s.normalized=h,s.type=v||u.dtype,s.offset=f,s.stride=p,s.divisor=m}}a[e]=Un(function(e,t){var n=e.attribCache;if(c in n)return n[c];var r={isStream:!1};return Object.keys(s).forEach(function(e){r[e]=s[e]}),s.buffer&&(r.buffer=e.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[c]=r,r})}),Object.keys(i).forEach(function(e){var t=i[e];a[e]=zn(t,function(n,r){var i=n.invoke(r,t),o=n.shared,a=n.constants,c=o.isBufferArgs,s=o.buffer;T.optional(function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+c+"("+i+")||"+s+".getBuffer("+i+")||"+s+".getBuffer("+i+".buffer)||"+c+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')});var u={isStream:r.def(!1)},l=new g;l.state=1,Object.keys(l).forEach(function(e){u[e]=r.def(""+l[e])});var f=u.buffer,p=u.type;function d(e){r(u[e],"=",i,".",e,"|0;")}return r("if(",c,"(",i,")){",u.isStream,"=true;",f,"=",s,".createStream(",sn,",",i,");",p,"=",f,".dtype;","}else{",f,"=",s,".getBuffer(",i,");","if(",f,"){",p,"=",f,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",2,";","if(typeof "+i+'.constant === "number"){',u[yt[0]],"=",i,".constant;",yt.slice(1).map(function(e){return u[e]}).join("="),"=0;","}else{",yt.map(function(e,t){return u[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",c,"(",i,".buffer)){",f,"=",s,".createStream(",sn,",",i,".buffer);","}else{",f,"=",s,".getBuffer(",i,".buffer);","}",p,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",f,".dtype;",u.normalized,"=!!",i,".normalized;"),d("size"),d("offset"),d("stride"),d("divisor"),r("}}"),r.exit("if(",u.isStream,"){",s,".destroyStream(",f,");","}"),u})}),a}(t,p),I.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=Un(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=zn(t,function(e,n){return e.invoke(n,t)})}),r}(u),I}(e,c,u,p,h);return function(e,t){var n=e.proc("draw",1);B(e,n),L(e,n,t.context),j(e,n,t.framebuffer),D(e,n,t),F(e,n,t.state),U(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)X(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link(function(n){return H(X,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}(h,v),function(e,t){var r=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;function a(n){var o=t.shader[n];o&&r.set(i.shader,"."+n,o.append(e,r))}L(e,r,t.context),t.framebuffer&&t.framebuffer.append(e,r),Dn(Object.keys(t.state)).forEach(function(n){var o=t.state[n].append(e,r);de(o)?o.forEach(function(t,i){r.set(e.next[n],"["+i+"]",t)}):r.set(i.next,"."+n,o)}),U(e,r,t,!0,!0),[Kt,$t,Jt,en,Qt].forEach(function(n){var o=t.draw[n];o&&r.set(i.draw,"."+n,""+o.append(e,r))}),Object.keys(t.uniforms).forEach(function(o){var a=t.uniforms[o].append(e,r);Array.isArray(a)&&(a="["+a.join()+"]"),r.set(i.uniforms,"["+n.id(o)+"]",a)}),Object.keys(t.attributes).forEach(function(n){var i=t.attributes[n].append(e,r),o=e.scopeAttrib(n);Object.keys(new g).forEach(function(e){r.set(o,"."+e,i[e])})}),t.scopeVAO&&r.set(i.vao,".targetVAO",t.scopeVAO.append(e,r)),a(Zt),a(qt),Object.keys(t.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",e.shared.context,",a0,",e.batchId,");")}(h,v),function(e,t){var n=e.proc("batch",2);e.batchId="0",B(e,n);var r=!1,i=!0;Object.keys(t.context).forEach(function(e){r=r||t.context[e].propDep}),r||(L(e,n,t.context),i=!1);var o=t.framebuffer,a=!1;function c(e){return e.contextDep&&r||e.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||j(e,n,o)):j(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(r=!0),D(e,n,t),F(e,n,t.state,function(e){return!c(e)}),t.profile&&c(t.profile)||U(e,n,t,!1,"a1"),t.contextDep=r,t.needsContext=i,t.needsFramebuffer=a;var s=t.shader.progVar;if(s.contextDep&&r||s.propDep)Y(e,n,t,null);else{var u=s.append(e,n);if(n(e.shared.gl,".useProgram(",u,".program);"),t.shader.program)Y(e,n,t,t.shader.program);else{n(e.shared.vao,".setVAO(null);");var l=e.global.def("{}"),f=n.def(u,".id"),p=n.def(l,"[",f,"]");n(e.cond(p).then(p,".call(this,a0,a1);").else(p,"=",l,"[",f,"]=",e.link(function(n){return H(Y,e,t,n,2)}),"(",u,");",p,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}(h,v),t(h.compile(),{destroy:function(){v.shader.program.destroy()}})}}}var Hn="webglcontextlost",Xn="webglcontextrestored";function Wn(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}return function(n){var r=function(e){var n,r,i,o,a,c=e||{},s={},u=[],l=[],f="undefined"==typeof window?1:window.devicePixelRatio,p=!1,d=function(e){e&&T.raise(e)},h=function(){};if("string"==typeof c?(T("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),n=document.querySelector(c),T(n,"invalid query string for element")):"object"==typeof c?"string"==typeof(a=c).nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?n=c:function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(c)?i=(o=c).canvas:(T.constructor(c),"gl"in c?o=c.gl:"canvas"in c?i=M(c.canvas):"container"in c&&(r=M(c.container)),"attributes"in c&&T.type(s=c.attributes,"object","invalid context attributes"),"extensions"in c&&(u=R(c.extensions)),"optionalExtensions"in c&&(l=R(c.optionalExtensions)),"onDone"in c&&(T.type(c.onDone,"function","invalid or missing onDone callback"),d=c.onDone),"profile"in c&&(p=!!c.profile),"pixelRatio"in c&&T((f=+c.pixelRatio)>0,"invalid pixel ratio")):T.raise("invalid arguments to regl"),n&&("canvas"===n.nodeName.toLowerCase()?i=n:r=n),!o){if(!i){T("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var v=function(e,n,r){var i,o=document.createElement("canvas");function a(){var n=window.innerWidth,i=window.innerHeight;if(e!==document.body){var a=e.getBoundingClientRect();n=a.right-a.left,i=a.bottom-a.top}o.width=r*n,o.height=r*i,t(o.style,{width:n+"px",height:i+"px"})}return t(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver(function(){setTimeout(a)})).observe(e):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",a),e.removeChild(o)}}}(r||document.body,0,f);if(!v)return null;i=v.canvas,h=v.onDestroy}void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!0),o=function(e,t){function n(n){try{return e.getContext(n,t)}catch(r){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(i,s)}return o?{gl:o,canvas:i,container:r,extensions:u,optionalExtensions:l,pixelRatio:f,profile:p,onDone:d,onDestroy:h}:(h(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(n);if(!r)return null;var i=r.gl,o=i.getContextAttributes(),a=i.isContextLost(),c=function(e,t){var n={};function r(t){T.type(t,"string","extension name must be string");var r,i=t.toLowerCase();try{r=n[i]=e.getExtension(i)}catch(o){}return!!r}for(var i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!r(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach(function(e){if(n[e]&&!r(e))throw new Error("(regl): error restoring extension "+e)})}}}(i,r);if(!c)return null;var s,u,l=(s={"":0},u=[""],{id:function(e){var t=s[e];return t||(t=s[e]=u.length,u.push(e),t)},str:function(e){return u[e]}}),f={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},p=c.extensions,d=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function r(e){n.push(e)}var i=[];function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var a=[];function c(e){a.push(e)}var s=[];function u(e,t,n){var r=a.pop()||new o;r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,s.push(r)}var l=[],f=[];return{beginQuery:function(e){var r=n.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,r),i.push(r),u(i.length-1,i.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:u,update:function(){var e,n,o=i.length;if(0!==o){f.length=Math.max(f.length,o+1),l.length=Math.max(l.length,o+1),l[0]=0,f[0]=0;var a=0;for(e=0,n=0;n<i.length;++n){var u=i[n];t.ext_disjoint_timer_query.getQueryObjectEXT(u,34919)?(a+=t.ext_disjoint_timer_query.getQueryObjectEXT(u,34918),r(u)):i[e++]=u,l[n+1]=a,f[n+1]=e}for(i.length=e,e=0,n=0;n<s.length;++n){var p=s[n],d=p.startQueryIndex,h=p.endQueryIndex;p.sum+=l[h]-l[d];var v=f[d],g=f[h];g===v?(p.stats.gpuTime+=p.sum/1e6,c(p)):(p.startQueryIndex=v,p.endQueryIndex=g,s[e++]=p)}s.length=e}},getNumPendingQueries:function(){return i.length},clear:function(){n.push.apply(n,i);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);i.length=0,n.length=0},restore:function(){i.length=0,n.length=0}}}(0,p),h=C(),v=i.drawingBufferWidth,g=i.drawingBufferHeight,m={tick:0,time:0,viewportWidth:v,viewportHeight:g,framebufferWidth:v,framebufferHeight:g,drawingBufferWidth:v,drawingBufferHeight:g,pixelRatio:r.pixelRatio},y=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063));var o=!!t.oes_texture_float;if(o){var a=e.createTexture();e.bindTexture(F,a),e.texImage2D(F,0,B,1,1,0,B,U,null);var c=e.createFramebuffer();if(e.bindFramebuffer(z,c),e.framebufferTexture2D(z,36064,F,a,0),e.bindTexture(F,null),36053!==e.checkFramebufferStatus(z))o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var s=D.allocType(U,4);e.readPixels(0,0,1,1,B,U,s),e.getError()?o=!1:(e.deleteFramebuffer(c),e.deleteTexture(a),o=1===s[0]),D.freeType(s)}}var u=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var l=e.createTexture(),f=D.allocType(5121,36);e.activeTexture(33984),e.bindTexture(34067,l),e.texImage2D(34069,0,B,3,3,0,B,5121,f),D.freeType(f),e.bindTexture(34067,null),e.deleteTexture(l),u=!e.getError()}return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:o,npotTextureCube:u}}(i,p),b=function(t,n,r,i){var o=0,a={};function c(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=$,this.persistentData=null,r.profile&&(this.stats={size:0})}c.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},c.prototype.destroy=function(){f(this)};var s=[];function u(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function l(t,n,r,i,o,a){var c,s;if(t.usage=r,Array.isArray(n)){if(t.dtype=i||ee,n.length>0)if(Array.isArray(n[0])){c=J(n);for(var l=1,f=1;f<c.length;++f)l*=c[f];t.dimension=l,u(t,s=Q(n,c,t.dtype),r),a?t.persistentData=s:D.freeType(s)}else if("number"==typeof n[0]){t.dimension=o;var p=D.allocType(t.dtype,n.length);re(p,n),u(t,p,r),a?t.persistentData=p:D.freeType(p)}else e(n[0])?(t.dimension=n[0].length,t.dtype=i||ne(n[0])||ee,u(t,s=Q(n,[n.length,n[0].length],t.dtype),r),a?t.persistentData=s:D.freeType(s)):T.raise("invalid buffer data")}else if(e(n))t.dtype=i||ne(n),t.dimension=o,u(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(G(n)){var d=n.stride,h=n.offset,v=0,g=0,m=0,y=0;1===(c=n.shape).length?(v=c[0],g=1,m=d[0],y=0):2===c.length?(v=c[0],g=c[1],m=d[0],y=d[1]):T.raise("invalid shape"),t.dtype=i||ne(n.data)||ee,t.dimension=g;var b=D.allocType(t.dtype,v*g);ie(b,n.data,v,g,m,y,h),u(t,b,r),a?t.persistentData=b:D.freeType(b)}else n instanceof ArrayBuffer?(t.dtype=$,t.dimension=o,u(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):T.raise("invalid buffer data")}function f(e){n.bufferCount--,function(e){_.destroyBuffer(e)}(e);var r=e.buffer;T(r,"buffer must not be deleted already"),t.deleteBuffer(r),e.buffer=null,delete a[e.id]}return r.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(a).forEach(function(t){e+=a[t].stats.size}),e}),{create:function(i,o,s,u){n.bufferCount++;var p=new c(o);function d(n){var i=35044,o=null,a=0,c=0,s=1;return Array.isArray(n)||e(n)||G(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?a=0|n:n&&(T.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(T(null===o||Array.isArray(o)||e(o)||G(o),"invalid data for buffer"),o=n.data),"usage"in n&&(T.parameter(n.usage,K,"invalid buffer usage"),i=K[n.usage]),"type"in n&&(T.parameter(n.type,q,"invalid buffer type"),c=q[n.type]),"dimension"in n&&(T.type(n.dimension,"number","invalid dimension"),s=0|n.dimension),"length"in n&&(T.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),p.bind(),o?l(p,o,i,c,s,u):(a&&t.bufferData(p.type,a,i),p.dtype=c||$,p.usage=i,p.dimension=s,p.byteLength=a),r.profile&&(p.stats.size=p.byteLength*te[p.dtype]),d}function h(e,n){T(n+e.byteLength<=p.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+p.byteLength),t.bufferSubData(p.type,n,e)}return a[p.id]=p,s||d(i),d._reglType="buffer",d._buffer=p,d.subdata=function(t,n){var r,i=0|(n||0);if(p.bind(),e(t)||t instanceof ArrayBuffer)h(t,i);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var o=D.allocType(p.dtype,t.length);re(o,t),h(o,i),D.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){r=J(t);var a=Q(t,r,p.dtype);h(a,i),D.freeType(a)}else T.raise("invalid buffer data")}else if(G(t)){var c=t.stride,s=0,u=0,l=0,f=0;1===(r=t.shape).length?(s=r[0],u=1,l=c[0],f=0):2===r.length?(s=r[0],u=r[1],l=c[0],f=c[1]):T.raise("invalid shape");var v=Array.isArray(t.data)?p.dtype:ne(t.data),g=D.allocType(v,s*u);ie(g,t.data,s,u,l,f,t.offset),h(g,i),D.freeType(g)}else T.raise("invalid data for buffer subdata");return d},r.profile&&(d.stats=p.stats),d.destroy=function(){f(p)},d},createStream:function(e,t){var n=s.pop();return n||(n=new c(e)),n.bind(),l(n,t,35040,0,1,!1),n},destroyStream:function(e){s.push(e)},clear:function(){V(a).forEach(f),s.forEach(f)},getBuffer:function(e){return e&&e._buffer instanceof c?e._buffer:null},restore:function(){V(a).forEach(function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:l}}(i,f,r),_=function(t,n,r,i,o){for(var a=r.maxAttributes,c=new Array(a),s=0;s<a;++s)c[s]=new dt;var u=0,l={},f={Record:dt,scope:{},state:c,currentVAO:null,targetVAO:null,restore:p()?function(){p()&&V(l).forEach(function(e){e.refresh()})}:function(){},createVAO:function(t){var r=new h;function c(t){T(Array.isArray(t),"arguments to vertex array constructor must be an array"),T(t.length<a,"too many attributes"),T(t.length>0,"must specify at least one attribute");var i={},s=r.attributes;s.length=t.length;for(var u=0;u<t.length;++u){var l,f=t[u],p=s[u]=new dt,d=f.data||f;Array.isArray(d)||e(d)||G(d)?(r.buffers[u]&&(l=r.buffers[u],e(d)&&l._buffer.byteLength>=d.byteLength?l.subdata(d):(l.destroy(),r.buffers[u]=null)),r.buffers[u]||(l=r.buffers[u]=o.create(f,34962,!1,!0)),p.buffer=o.getBuffer(l),p.size=0|p.buffer.dimension,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1,i[u]=1):o.getBuffer(f)?(p.buffer=o.getBuffer(f),p.size=0|p.buffer.dimension,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1):o.getBuffer(f.buffer)?(p.buffer=o.getBuffer(f.buffer),p.size=0|(+f.size||p.buffer.dimension),p.normalized=!!f.normalized||!1,"type"in f?(T.parameter(f.type,q,"invalid buffer type"),p.type=q[f.type]):p.type=p.buffer.dtype,p.offset=0|(f.offset||0),p.stride=0|(f.stride||0),p.divisor=0|(f.divisor||0),p.state=1,T(p.size>=1&&p.size<=4,"size must be between 1 and 4"),T(p.offset>=0,"invalid offset"),T(p.stride>=0&&p.stride<=255,"stride must be between 0 and 255"),T(p.divisor>=0,"divisor must be positive"),T(!p.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in f?(T(u>0,"first attribute must not be a constant"),p.x=+f.x||0,p.y=+f.y||0,p.z=+f.z||0,p.w=+f.w||0,p.state=2):T(!1,"invalid attribute spec for location "+u)}for(var h=0;h<r.buffers.length;++h)!i[h]&&r.buffers[h]&&(r.buffers[h].destroy(),r.buffers[h]=null);return r.refresh(),c}return i.vaoCount+=1,c.destroy=function(){for(var e=0;e<r.buffers.length;++e)r.buffers[e]&&r.buffers[e].destroy();r.buffers.length=0,r.destroy()},c._vao=r,c._reglType="vao",c(t)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(e){for(var n=0;n<c.length;++n){var r=c[n];r.buffer===e&&(t.disableVertexAttribArray(n),r.buffer=null)}},setVAO:p()?function(e){e!==f.currentVAO&&(p().bindVertexArrayOES(e?e.vao:null),f.currentVAO=e)}:function(e){if(e!==f.currentVAO){if(e)e.bindAttrs();else for(var n=d(),r=0;r<c.length;++r){var i=c[r];i.buffer?(t.enableVertexAttribArray(r),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}f.currentVAO=e}},clear:p()?function(){V(l).forEach(function(e){e.destroy()})}:function(){}};function p(){return n.oes_vertex_array_object}function d(){return n.angle_instanced_arrays}function h(){this.id=++u,this.attributes=[];var e=p();this.vao=e?e.createVertexArrayOES():null,l[this.id]=this,this.buffers=[]}return h.prototype.bindAttrs=function(){for(var e=d(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(t.enableVertexAttribArray(r),t.bindBuffer(34962,i.buffer.buffer),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),e&&i.divisor&&e.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<a;++o)t.disableVertexAttribArray(o)},h.prototype.refresh=function(){var e=p();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),f.currentVAO=this)},h.prototype.destroy=function(){if(this.vao){var e=p();this===f.currentVAO&&(f.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}l[this.id]&&(delete l[this.id],i.vaoCount-=1)},f}(i,p,y,f,b),E=function(t,n,r,i){var o={},a=0,c={uint8:ae,uint16:ce};function s(e){this.id=a++,o[this.id]=this,this.buffer=e,this.primType=4,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(c.uint32=se),s.prototype.bind=function(){this.buffer.bind()};var u=[];function l(i,o,a,c,s,u,l){var f;if(i.buffer.bind(),o){var p=l;l||e(o)&&(!G(o)||e(o.data))||(p=n.oes_element_index_uint?se:ce),r._initBuffer(i.buffer,o,a,p,3)}else t.bufferData(ue,u,a),i.buffer.dtype=f||ae,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=u;if(f=l,!l){switch(i.buffer.dtype){case ae:case 5120:f=ae;break;case ce:case 5122:f=ce;break;case se:case 5124:f=se;break;default:T.raise("unsupported type for element array")}i.buffer.dtype=f}i.type=f,T(f!==se||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=s;d<0&&(d=i.buffer.byteLength,f===ce?d>>=1:f===se&&(d>>=2)),i.vertCount=d;var h=c;if(c<0){h=4;var v=i.buffer.dimension;1===v&&(h=0),2===v&&(h=1),3===v&&(h=4)}i.primType=h}function f(e){i.elementsCount--,T(null!==e.buffer,"must not double destroy elements"),delete o[e.id],e.buffer.destroy(),e.buffer=null}return{create:function(t,n){var o=r.create(null,ue,!0),a=new s(o._buffer);function u(t){if(t)if("number"==typeof t)o(t),a.primType=4,a.vertCount=0|t,a.type=ae;else{var n=null,r=35044,i=-1,s=-1,f=0,p=0;Array.isArray(t)||e(t)||G(t)?n=t:(T.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,T(Array.isArray(n)||e(n)||G(n),"invalid data for element buffer")),"usage"in t&&(T.parameter(t.usage,K,"invalid element buffer usage"),r=K[t.usage]),"primitive"in t&&(T.parameter(t.primitive,oe,"invalid element buffer primitive"),i=oe[t.primitive]),"count"in t&&(T("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),s=0|t.count),"type"in t&&(T.parameter(t.type,c,"invalid buffer type"),p=c[t.type]),"length"in t?f=0|t.length:(f=s,p===ce||5122===p?f*=2:p!==se&&5124!==p||(f*=4))),l(a,n,r,i,s,f,p)}else o(),a.primType=4,a.vertCount=0,a.type=ae;return u}return i.elementsCount++,u(t),u._reglType="elements",u._elements=a,u.subdata=function(e,t){return o.subdata(e,t),u},u.destroy=function(){f(a)},u},createStream:function(e){var t=u.pop();return t||(t=new s(r.create(null,ue,!0,!1)._buffer)),l(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){u.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof s?e._elements:null},clear:function(){V(o).forEach(f)}}}(i,p,b,f),S=function(e,n,r,i){var o={},a={};function c(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function s(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function u(t,r,i){var c=35632===t?o:a,s=c[r];if(!s){var u=n.str(r);s=e.createShader(t),e.shaderSource(s,u),e.compileShader(s),T.shaderError(e,s,u,t,i),c[r]=s}return s}var l={},f=[],p=0;function d(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function h(t,r,o){var a,l,f=u(35632,t.fragId),p=u(35633,t.vertId),d=t.program=e.createProgram();if(e.attachShader(d,f),e.attachShader(d,p),o)for(a=0;a<o.length;++a){var h=o[a];e.bindAttribLocation(d,h[0],h[1])}e.linkProgram(d),T.linkError(e,d,n.str(t.fragId),n.str(t.vertId),r);var v=e.getProgramParameter(d,35718);i.profile&&(t.stats.uniformsCount=v);var g=t.uniforms;for(a=0;a<v;++a)if(l=e.getActiveUniform(d,a))if(l.size>1)for(var m=0;m<l.size;++m){var y=l.name.replace("[0]","["+m+"]");s(g,new c(y,n.id(y),e.getUniformLocation(d,y),l))}else s(g,new c(l.name,n.id(l.name),e.getUniformLocation(d,l.name),l));var b=e.getProgramParameter(d,35721);i.profile&&(t.stats.attributesCount=b);var _=t.attributes;for(a=0;a<b;++a)(l=e.getActiveAttrib(d,a))&&s(_,new c(l.name,n.id(l.name),e.getAttribLocation(d,l.name),l))}return i.profile&&(r.getMaxUniformsCount=function(){var e=0;return f.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},r.getMaxAttributesCount=function(){var e=0;return f.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);V(o).forEach(t),o={},V(a).forEach(t),a={},f.forEach(function(t){e.deleteProgram(t.program)}),f.length=0,l={},r.shaderCount=0},program:function(n,i,c,s){T.command(n>=0,"missing vertex shader",c),T.command(i>=0,"missing fragment shader",c);var u=l[i];u||(u=l[i]={});var p=u[n];if(p&&(p.refCount++,!s))return p;var v=new d(i,n);return r.shaderCount++,h(v,c,s),p||(u[n]=v),f.push(v),t(v,{destroy:function(){if(v.refCount--,v.refCount<=0){e.deleteProgram(v.program);var t=f.indexOf(v);f.splice(t,1),r.shaderCount--}u[v.vertId].refCount<=0&&(e.deleteShader(a[v.vertId]),delete a[v.vertId],delete l[v.fragId][v.vertId]),Object.keys(l[v.fragId]).length||(e.deleteShader(o[v.fragId]),delete o[v.fragId],delete l[v.fragId])}})},restore:function(){o={},a={};for(var e=0;e<f.length;++e)h(f[e],null,f[e].attributes.map(function(e){return[e.location,e.name]}))},shader:u,frag:-1,vert:-1}}(i,l,f,r),x=function(n,r,i,o,a,c,s){var u={"don't care":Ie,"dont care":Ie,nice:4354,fast:4353},l={repeat:10497,clamp:Ae,mirror:33648},f={nearest:Oe,linear:9729},p=t({mipmap:ke,"nearest mipmap nearest":we,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":ke},f),d={none:0,browser:37444},h={uint8:Te,rgba4:32819,rgb565:33635,"rgb5 a1":32820},v={alpha:6406,luminance:_e,"luminance alpha":Ee,rgb:be,rgba:ye,rgba4:32854,"rgb5 a1":32855,rgb565:36194},g={};r.ext_srgb&&(v.srgb=35904,v.srgba=35906),r.oes_texture_float&&(h.float32=h.float=xe),r.oes_texture_half_float&&(h.float16=h["half float"]=Se),r.webgl_depth_texture&&(t(v,{depth:6402,"depth stencil":34041}),t(h,{uint16:5123,uint32:5125,"depth stencil":34042})),r.webgl_compressed_texture_s3tc&&t(g,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),r.webgl_compressed_texture_atc&&t(g,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),r.webgl_compressed_texture_pvrtc&&t(g,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),r.webgl_compressed_texture_etc1&&(g["rgb etc1"]=36196);var m=Array.prototype.slice.call(n.getParameter(34467));Object.keys(g).forEach(function(e){var t=g[e];m.indexOf(t)>=0&&(v[e]=t)});var y=Object.keys(v);i.textureFormats=y;var b=[];Object.keys(v).forEach(function(e){b[v[e]]=e});var _=[];Object.keys(h).forEach(function(e){_[h[e]]=e});var E=[];Object.keys(f).forEach(function(e){E[f[e]]=e});var S=[];Object.keys(p).forEach(function(e){S[p[e]]=e});var x=[];Object.keys(l).forEach(function(e){x[l[e]]=e});var A=y.reduce(function(e,t){var n=v[t];return e[n]=n===_e||6406===n||n===_e||n===Ee||6402===n||34041===n||r.ext_srgb&&(35904===n||35906===n)?n:32855===n||t.indexOf("rgba")>=0?ye:be,e},{});function O(){this.internalformat=ye,this.format=ye,this.type=Te,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function w(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function k(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(T.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(T.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(T.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(T.parameter(t.colorSpace,d,"invalid colorSpace"),e.colorSpace=d[t.colorSpace]),"type"in t){var n=t.type;T(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),T(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),T(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),T.parameter(n,h,"invalid texture type"),e.type=h[n]}var o=e.width,a=e.height,c=e.channels,s=!1;"shape"in t?(T(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),o=t.shape[0],a=t.shape[1],3===t.shape.length&&(T((c=t.shape[2])>0&&c<=4,"invalid number of channels"),s=!0),T(o>=0&&o<=i.maxTextureSize,"invalid width"),T(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in t&&(o=a=t.radius,T(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in t&&T((o=t.width)>=0&&o<=i.maxTextureSize,"invalid width"),"height"in t&&T((a=t.height)>=0&&a<=i.maxTextureSize,"invalid height"),"channels"in t&&(T((c=t.channels)>0&&c<=4,"invalid number of channels"),s=!0)),e.width=0|o,e.height=0|a,e.channels=0|c;var u=!1;if("format"in t){var l=t.format;T(r.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),T.parameter(l,v,"invalid texture format");var f=e.internalformat=v[l];e.format=A[f],l in h&&("type"in t||(e.type=h[l])),l in g&&(e.compressed=!0),u=!0}!s&&u?e.channels=Me[e.format]:s&&!u?e.channels!==Re[e.format]&&(e.format=e.internalformat=Re[e.channels]):u&&s&&T(e.channels===Me[e.format],"number of channels inconsistent with specified format")}}function I(e){n.pixelStorei(37440,e.flipY),n.pixelStorei(37441,e.premultiplyAlpha),n.pixelStorei(37443,e.colorSpace),n.pixelStorei(3317,e.unpackAlignment)}function P(){O.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function C(t,n){var r=null;if(qe(n)?r=n:n&&(T.type(n,"object","invalid pixel data type"),k(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),qe(n.data)&&(r=n.data)),T(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){T(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,c=a.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||c-t.yOffset,t.needsCopy=!0,T(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<c&&t.width>0&&t.width<=o&&t.height>0&&t.height<=c,"copy texture read out of bounds")}else if(r){if(e(r))t.channels=t.channels||4,t.data=r,"type"in n||t.type!==Te||(t.type=Ke(r));else if(He(r))t.channels=t.channels||4,function(e,t){var n=t.length;switch(e.type){case Te:case 5123:case 5125:case xe:var r=D.allocType(e.type,n);r.set(t),e.data=r;break;case Se:e.data=pe(t);break;default:T.raise("unsupported texture type, must specify a typed array")}}(t,r),t.alignment=1,t.needsFree=!0;else if(G(r)){var s=r.data;Array.isArray(s)||t.type!==Te||(t.type=Ke(s));var u,l,f,p,d,h,v=r.shape,g=r.stride;3===v.length?(f=v[2],h=g[2]):(T(2===v.length,"invalid ndarray pixel data, must be 2 or 3D"),f=1,h=1),u=v[0],l=v[1],p=g[0],d=g[1],t.alignment=1,t.width=u,t.height=l,t.channels=f,t.format=t.internalformat=Re[f],t.needsFree=!0,function(e,t,n,r,i,o){for(var a=e.width,c=e.height,s=e.channels,u=Qe(e,a*c*s),l=0,f=0;f<c;++f)for(var p=0;p<a;++p)for(var d=0;d<s;++d)u[l++]=t[n*p+r*f+i*d+o];Je(e,u)}(t,s,p,d,h,r.offset)}else if(Ye(r)||Ze(r)||We(r)===De)t.element=Ye(r)||Ze(r)?r:r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(We(r)===Fe)t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(We(r)===Be)t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(function(e){return We(e)===Ue}(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(Xe(r)){var m=t.width||r[0].length,y=t.height||r.length,b=t.channels;b=de(r[0][0])?b||r[0][0].length:b||1;for(var _=H(r),E=1,S=0;S<_.length;++S)E*=_[S];var x=Qe(t,E);X(r,_,"",x),Je(t,x),t.alignment=1,t.width=m,t.height=y,t.channels=b,t.format=t.internalformat=Re[b],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===xe?T(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Se&&T(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function R(e,t,r){var i=e.element,a=e.data,c=e.internalformat,s=e.format,u=e.type,l=e.width,f=e.height;I(e),i?n.texImage2D(t,r,s,s,u,i):e.compressed?n.compressedTexImage2D(t,r,c,l,f,0,a):e.needsCopy?(o(),n.copyTexImage2D(t,r,s,e.xOffset,e.yOffset,l,f,0)):n.texImage2D(t,r,s,l,f,0,s,u,a||null)}function M(e,t,r,i,a){var c=e.element,s=e.data,u=e.internalformat,l=e.format,f=e.type,p=e.width,d=e.height;I(e),c?n.texSubImage2D(t,a,r,i,l,f,c):e.compressed?n.compressedTexSubImage2D(t,a,r,i,u,p,d,s):e.needsCopy?(o(),n.copyTexSubImage2D(t,a,r,i,e.xOffset,e.yOffset,p,d)):n.texSubImage2D(t,a,r,i,p,d,l,f,s)}var N=[];function L(){return N.pop()||new P}function j(e){e.needsFree&&D.freeType(e.data),P.call(e),N.push(e)}function F(){O.call(this),this.genMipmaps=!1,this.mipmapHint=Ie,this.mipmask=0,this.images=Array(16)}function B(e,t,n){var r=e.images[0]=L();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function U(e,t){var n=null;if(qe(t))w(n=e.images[0]=L(),e),C(n,t),e.mipmask=1;else if(k(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)w(n=e.images[i]=L(),e),n.width>>=i,n.height>>=i,C(n,r[i]),e.mipmask|=1<<i;else w(n=e.images[0]=L(),e),C(n,t),e.mipmask=1;w(e,e.images[0]),!e.compressed||33776!==e.internalformat&&33777!==e.internalformat&&33778!==e.internalformat&&33779!==e.internalformat||T(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function z(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;R(n[r],t,r)}}var W=[];function Y(){var e=W.pop()||new F;O.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function Z(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&j(t[n]),t[n]=null;W.push(e)}function q(){this.minFilter=Oe,this.magFilter=Oe,this.wrapS=Ae,this.wrapT=Ae,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ie}function K(e,t){if("min"in t){var n=t.min;T.parameter(n,p),e.minFilter=p[n],Ce.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var r=t.mag;T.parameter(r,f),e.magFilter=f[r]}var o=e.wrapS,a=e.wrapT;if("wrap"in t){var c=t.wrap;"string"==typeof c?(T.parameter(c,l),o=a=l[c]):Array.isArray(c)&&(T.parameter(c[0],l),T.parameter(c[1],l),o=l[c[0]],a=l[c[1]])}else{if("wrapS"in t){var s=t.wrapS;T.parameter(s,l),o=l[s]}if("wrapT"in t){var d=t.wrapT;T.parameter(d,l),a=l[d]}}if(e.wrapS=o,e.wrapT=a,"anisotropic"in t){var h=t.anisotropic;T("number"==typeof h&&h>=1&&h<=i.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var v=!1;switch(typeof t.mipmap){case"string":T.parameter(t.mipmap,u,"invalid mipmap hint"),e.mipmapHint=u[t.mipmap],e.genMipmaps=!0,v=!0;break;case"boolean":v=e.genMipmaps=t.mipmap;break;case"object":T(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,v=!0;break;default:T.raise("invalid mipmap type")}v&&!("min"in t)&&(e.minFilter=we)}}function Q(e,t){n.texParameteri(t,10241,e.minFilter),n.texParameteri(t,10240,e.magFilter),n.texParameteri(t,10242,e.wrapS),n.texParameteri(t,10243,e.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(n.hint(33170,e.mipmapHint),n.generateMipmap(t))}var J=0,$={},ee=i.maxTextureUnits,te=Array(ee).map(function(){return null});function ne(e){O.call(this),this.mipmask=0,this.internalformat=ye,this.id=J++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new q,s.profile&&(this.stats={size:0})}function re(e){n.activeTexture(Pe),n.bindTexture(e.target,e.texture)}function ie(){var e=te[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(ve,null)}function oe(e){var t=e.texture;T(t,"must not double destroy texture");var r=e.unit,i=e.target;r>=0&&(n.activeTexture(Pe+r),n.bindTexture(i,null),te[r]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete $[e.id],c.textureCount--}return t(ne.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var r=0;r<ee;++r){var i=te[r];if(i){if(i.bindCount>0)continue;i.unit=-1}te[r]=e,t=r;break}t>=ee&&T.raise("insufficient number of texture units"),s.profile&&c.maxTextureUnits<t+1&&(c.maxTextureUnits=t+1),e.unit=t,n.activeTexture(Pe+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&oe(this)}}),s.profile&&(c.getTotalTextureSize=function(){var e=0;return Object.keys($).forEach(function(t){e+=$[t].stats.size}),e}),{create2D:function(e,t){var r=new ne(ve);function o(e,t){var n=r.texInfo;q.call(n);var a=Y();return"number"==typeof e?B(a,0|e,"number"==typeof t?0|t:0|e):e?(T.type(e,"object","invalid arguments to regl.texture"),K(n,e),U(a,e)):B(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,w(r,a),T.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,re(r),z(a,ve),Q(n,ve),ie(),Z(a),s.profile&&(r.stats.size=$e(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=b[r.internalformat],o.type=_[r.type],o.mag=E[n.magFilter],o.min=S[n.minFilter],o.wrapS=x[n.wrapS],o.wrapT=x[n.wrapT],o}return $[r.id]=r,c.textureCount++,o(e,t),o.subimage=function(e,t,n,i){T(!!e,"must specify image data");var a=0|t,c=0|n,s=0|i,u=L();return w(u,r),u.width=0,u.height=0,C(u,e),u.width=u.width||(r.width>>s)-a,u.height=u.height||(r.height>>s)-c,T(r.type===u.type&&r.format===u.format&&r.internalformat===u.internalformat,"incompatible format for texture.subimage"),T(a>=0&&c>=0&&a+u.width<=r.width&&c+u.height<=r.height,"texture.subimage write out of bounds"),T(r.mipmask&1<<s,"missing mipmap data"),T(u.data||u.element||u.needsCopy,"missing image data"),re(r),M(u,ve,a,c,s),ie(),j(u),o},o.resize=function(e,t){var i=0|e,a=0|t||i;if(i===r.width&&a===r.height)return o;o.width=r.width=i,o.height=r.height=a,re(r);for(var c=0;r.mipmask>>c;++c){var u=i>>c,l=a>>c;if(!u||!l)break;n.texImage2D(ve,c,r.format,u,l,0,r.format,r.type,null)}return ie(),s.profile&&(r.stats.size=$e(r.internalformat,r.type,i,a,!1,!1)),o},o._reglType="texture2d",o._texture=r,s.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o},createCube:function(e,t,r,o,a,u){var l=new ne(ge);$[l.id]=l,c.cubeCount++;var f=new Array(6);function p(e,t,n,r,o,a){var c,u=l.texInfo;for(q.call(u),c=0;c<6;++c)f[c]=Y();if("number"!=typeof e&&e)if("object"==typeof e)if(t)U(f[0],e),U(f[1],t),U(f[2],n),U(f[3],r),U(f[4],o),U(f[5],a);else if(K(u,e),k(l,e),"faces"in e){var d=e.faces;for(T(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),c=0;c<6;++c)T("object"==typeof d[c]&&!!d[c],"invalid input for cube map face"),w(f[c],l),U(f[c],d[c])}else for(c=0;c<6;++c)U(f[c],e);else T.raise("invalid arguments to cube map");else{var h=0|e||1;for(c=0;c<6;++c)B(f[c],h,h)}for(w(l,f[0]),i.npotTextureCube||T(he(l.width)&&he(l.height),"your browser does not support non power or two texture dimensions"),l.mipmask=u.genMipmaps?(f[0].width<<1)-1:f[0].mipmask,T.textureCube(l,u,f,i),l.internalformat=f[0].internalformat,p.width=f[0].width,p.height=f[0].height,re(l),c=0;c<6;++c)z(f[c],me+c);for(Q(u,ge),ie(),s.profile&&(l.stats.size=$e(l.internalformat,l.type,p.width,p.height,u.genMipmaps,!0)),p.format=b[l.internalformat],p.type=_[l.type],p.mag=E[u.magFilter],p.min=S[u.minFilter],p.wrapS=x[u.wrapS],p.wrapT=x[u.wrapT],c=0;c<6;++c)Z(f[c]);return p}return p(e,t,r,o,a,u),p.subimage=function(e,t,n,r,i){T(!!t,"must specify image data"),T("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|r,c=0|i,s=L();return w(s,l),s.width=0,s.height=0,C(s,t),s.width=s.width||(l.width>>c)-o,s.height=s.height||(l.height>>c)-a,T(l.type===s.type&&l.format===s.format&&l.internalformat===s.internalformat,"incompatible format for texture.subimage"),T(o>=0&&a>=0&&o+s.width<=l.width&&a+s.height<=l.height,"texture.subimage write out of bounds"),T(l.mipmask&1<<c,"missing mipmap data"),T(s.data||s.element||s.needsCopy,"missing image data"),re(l),M(s,me+e,o,a,c),ie(),j(s),p},p.resize=function(e){var t=0|e;if(t!==l.width){p.width=l.width=t,p.height=l.height=t,re(l);for(var r=0;r<6;++r)for(var i=0;l.mipmask>>i;++i)n.texImage2D(me+r,i,l.format,t>>i,t>>i,0,l.format,l.type,null);return ie(),s.profile&&(l.stats.size=$e(l.internalformat,l.type,p.width,p.height,!1,!0)),p}},p._reglType="textureCube",p._texture=l,s.profile&&(p.stats=l.stats),p.destroy=function(){l.decRef()},p},clear:function(){for(var e=0;e<ee;++e)n.activeTexture(Pe+e),n.bindTexture(ve,null),te[e]=null;V($).forEach(oe),c.cubeCount=0,c.textureCount=0},getTexture:function(e){return null},restore:function(){for(var e=0;e<ee;++e){var t=te[e];t&&(t.bindCount=0,t.unit=-1,te[e]=null)}V($).forEach(function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===ve)n.texImage2D(ve,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)n.texImage2D(me+r,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);Q(e.texInfo,e.target)})},refresh:function(){for(var e=0;e<ee;++e){var t=te[e];t&&(t.bindCount=0,t.unit=-1,te[e]=null),n.activeTexture(Pe+e),n.bindTexture(ve,null),n.bindTexture(ge,null)}}}}(i,p,y,function(){w.procs.poll()},m,f,r),A=function(e,t,n,r,i){var o={rgba4:tt,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(o.srgba=35907),t.ext_color_buffer_half_float&&(o.rgba16f=34842,o.rgb16f=34843),t.webgl_color_buffer_float&&(o.rgba32f=34836);var a=[];Object.keys(o).forEach(function(e){a[o[e]]=e});var c=0,s={};function u(e){this.id=c++,this.refCount=1,this.renderbuffer=e,this.format=tt,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function l(t){var n=t.renderbuffer;T(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(et,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete s[t.id],r.renderbufferCount--}return u.prototype.decRef=function(){--this.refCount<=0&&l(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(s).forEach(function(t){e+=s[t].stats.size}),e}),{create:function(t,c){var l=new u(e.createRenderbuffer());function f(t,r){var c=0,s=0,u=tt;if("object"==typeof t&&t){var p=t;if("shape"in p){var d=p.shape;T(Array.isArray(d)&&d.length>=2,"invalid renderbuffer shape"),c=0|d[0],s=0|d[1]}else"radius"in p&&(c=s=0|p.radius),"width"in p&&(c=0|p.width),"height"in p&&(s=0|p.height);"format"in p&&(T.parameter(p.format,o,"invalid renderbuffer format"),u=o[p.format])}else"number"==typeof t?(c=0|t,s="number"==typeof r?0|r:c):t?T.raise("invalid arguments to renderbuffer constructor"):c=s=1;if(T(c>0&&s>0&&c<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),c!==l.width||s!==l.height||u!==l.format)return f.width=l.width=c,f.height=l.height=s,l.format=u,e.bindRenderbuffer(et,l.renderbuffer),e.renderbufferStorage(et,u,c,s),T(0===e.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=rt(l.format,l.width,l.height)),f.format=a[l.format],f}return s[l.id]=l,r.renderbufferCount++,f(t,c),f.resize=function(t,r){var o=0|t,a=0|r||o;return o===l.width&&a===l.height||(T(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),f.width=l.width=o,f.height=l.height=a,e.bindRenderbuffer(et,l.renderbuffer),e.renderbufferStorage(et,l.format,o,a),T(0===e.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=rt(l.format,l.width,l.height))),f},f._reglType="renderbuffer",f._renderbuffer=l,i.profile&&(f.stats=l.stats),f.destroy=function(){l.decRef()},f},clear:function(){V(s).forEach(l)},restore:function(){V(s).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(et,t.renderbuffer),e.renderbufferStorage(et,t.format,t.width,t.height)}),e.bindRenderbuffer(et,null)}}}(i,p,y,f,r),O=function(e,n,r,i,o,a){var c={cur:null,next:null,dirty:!1,setFBO:null},s=["rgba"],u=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&u.push("srgba"),n.ext_color_buffer_half_float&&u.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&u.push("rgba32f");var l=["uint8"];function f(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function p(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function d(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);T(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;T(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function h(t,n){n&&(n.texture?e.framebufferTexture2D(it,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(it,t,ot,n.renderbuffer._renderbuffer.renderbuffer))}function v(e){var t=at,n=null,r=null,i=e;"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),T.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,T(t===at)):"textureCube"===o?(n=i,T(t>=ct&&t<34075,"invalid cube map target")):"renderbuffer"===o?(r=i,t=ot):T.raise("invalid regl object for attachment"),new f(t,n,r)}function g(e,t,n,r,a){if(n){var c=i.create2D({width:e,height:t,format:r,type:a});return c._texture.refCount=0,new f(at,c,null)}var s=o.create({width:e,height:t,format:r});return s._renderbuffer.refCount=0,new f(ot,null,s)}function m(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&l.push("half float","float16"),n.oes_texture_float&&l.push("float","float32");var b=0,_={};function E(){this.id=b++,_[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function S(e){e.colorAttachments.forEach(p),p(e.depthAttachment),p(e.stencilAttachment),p(e.depthStencilAttachment)}function x(t){var n=t.framebuffer;T(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete _[t.id]}function A(t){var n;e.bindFramebuffer(it,t.framebuffer);var i=t.colorAttachments;for(n=0;n<i.length;++n)h(36064+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(it,36064+n,at,null,0);e.framebufferTexture2D(it,33306,at,null,0),e.framebufferTexture2D(it,36096,at,null,0),e.framebufferTexture2D(it,36128,at,null,0),h(36096,t.depthAttachment),h(36128,t.stencilAttachment),h(33306,t.depthStencilAttachment);var o=e.checkFramebufferStatus(it);e.isContextLost()||36053===o||T.raise("framebuffer configuration not supported, status = "+pt[o]),e.bindFramebuffer(it,c.next?c.next.framebuffer:null),c.cur=c.next,e.getError()}function O(e,i){var o=new E;function f(e,t){var i;T(c.next!==o,"can not update framebuffer which is currently in use");var a=0,p=0,h=!0,y=!0,b=null,_=!0,E="rgba",x="uint8",O=1,w=null,k=null,I=null,P=!1;if("number"==typeof e)a=0|e,p=0|t||a;else if(e){T.type(e,"object","invalid arguments for framebuffer");var C=e;if("shape"in C){var R=C.shape;T(Array.isArray(R)&&R.length>=2,"invalid shape for framebuffer"),a=R[0],p=R[1]}else"radius"in C&&(a=p=C.radius),"width"in C&&(a=C.width),"height"in C&&(p=C.height);("color"in C||"colors"in C)&&(b=C.color||C.colors,Array.isArray(b)&&T(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in C&&T((O=0|C.colorCount)>0,"invalid color buffer count"),"colorTexture"in C&&(_=!!C.colorTexture,E="rgba4"),"colorType"in C&&(x=C.colorType,_?(T(n.oes_texture_float||!("float"===x||"float32"===x),"you must enable OES_texture_float in order to use floating point framebuffer objects"),T(n.oes_texture_half_float||!("half float"===x||"float16"===x),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===x||"float16"===x?(T(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),E="rgba16f"):"float"!==x&&"float32"!==x||(T(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),E="rgba32f"),T.oneOf(x,l,"invalid color type")),"colorFormat"in C&&(s.indexOf(E=C.colorFormat)>=0?_=!0:u.indexOf(E)>=0?_=!1:_?T.oneOf(C.colorFormat,s,"invalid color format for texture"):T.oneOf(C.colorFormat,u,"invalid color format for renderbuffer"))),("depthTexture"in C||"depthStencilTexture"in C)&&T(!(P=!(!C.depthTexture&&!C.depthStencilTexture))||n.webgl_depth_texture,"webgl_depth_texture extension not supported"),"depth"in C&&("boolean"==typeof C.depth?h=C.depth:(w=C.depth,y=!1)),"stencil"in C&&("boolean"==typeof C.stencil?y=C.stencil:(k=C.stencil,h=!1)),"depthStencil"in C&&("boolean"==typeof C.depthStencil?h=y=C.depthStencil:(I=C.depthStencil,h=!1,y=!1))}else a=p=1;var M=null,N=null,L=null,j=null;if(Array.isArray(b))M=b.map(v);else if(b)M=[v(b)];else for(M=new Array(O),i=0;i<O;++i)M[i]=g(a,p,_,E,x);T(n.webgl_draw_buffers||M.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),T(M.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||M[0].width,p=p||M[0].height,w?N=v(w):h&&!y&&(N=g(a,p,P,"depth","uint32")),k?L=v(k):y&&!h&&(L=g(a,p,!1,"stencil","uint8")),I?j=v(I):!w&&!k&&y&&h&&(j=g(a,p,P,"depth stencil","depth stencil")),T(!!w+!!k+!!I<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var D=null;for(i=0;i<M.length;++i)if(d(M[i],a,p),T(!M[i]||M[i].texture&&st.indexOf(M[i].texture._texture.format)>=0||M[i].renderbuffer&&ft.indexOf(M[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),M[i]&&M[i].texture){var F=ut[M[i].texture._texture.format]*lt[M[i].texture._texture.type];null===D?D=F:T(D===F,"all color attachments much have the same number of bits per pixel.")}return d(N,a,p),T(!N||N.texture&&6402===N.texture._texture.format||N.renderbuffer&&33189===N.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),d(L,a,p),T(!L||L.renderbuffer&&36168===L.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),d(j,a,p),T(!j||j.texture&&34041===j.texture._texture.format||j.renderbuffer&&34041===j.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),S(o),o.width=a,o.height=p,o.colorAttachments=M,o.depthAttachment=N,o.stencilAttachment=L,o.depthStencilAttachment=j,f.color=M.map(m),f.depth=m(N),f.stencil=m(L),f.depthStencil=m(j),f.width=o.width,f.height=o.height,A(o),f}return a.framebufferCount++,f(e,i),t(f,{resize:function(e,t){T(c.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===o.width&&r===o.height)return f;for(var i=o.colorAttachments,a=0;a<i.length;++a)y(i[a],n,r);return y(o.depthAttachment,n,r),y(o.stencilAttachment,n,r),y(o.depthStencilAttachment,n,r),o.width=f.width=n,o.height=f.height=r,A(o),f},_reglType:"framebuffer",_framebuffer:o,destroy:function(){x(o),S(o)},use:function(e){c.setFBO({framebuffer:f},e)}})}return t(c,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof E)return t}return null},create:O,createCube:function(e){var o=Array(6);function a(e){var r;T(o.indexOf(c.next)<0,"can not update framebuffer which is currently in use");var u,f={color:null},p=0,d=null,h="rgba",v="uint8",g=1;if("number"==typeof e)p=0|e;else if(e){T.type(e,"object","invalid arguments for framebuffer");var m=e;if("shape"in m){var y=m.shape;T(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),T(y[0]===y[1],"cube framebuffer must be square"),p=y[0]}else"radius"in m&&(p=0|m.radius),"width"in m?(p=0|m.width,"height"in m&&T(m.height===p,"must be square")):"height"in m&&(p=0|m.height);("color"in m||"colors"in m)&&(d=m.color||m.colors,Array.isArray(d)&&T(1===d.length||n.webgl_draw_buffers,"multiple render targets not supported")),d||("colorCount"in m&&T((g=0|m.colorCount)>0,"invalid color buffer count"),"colorType"in m&&(T.oneOf(m.colorType,l,"invalid color type"),v=m.colorType),"colorFormat"in m&&(h=m.colorFormat,T.oneOf(m.colorFormat,s,"invalid color format for texture"))),"depth"in m&&(f.depth=m.depth),"stencil"in m&&(f.stencil=m.stencil),"depthStencil"in m&&(f.depthStencil=m.depthStencil)}else p=1;if(d)if(Array.isArray(d))for(u=[],r=0;r<d.length;++r)u[r]=d[r];else u=[d];else{u=Array(g);var b={radius:p,format:h,type:v};for(r=0;r<g;++r)u[r]=i.createCube(b)}for(f.color=Array(u.length),r=0;r<u.length;++r){var _=u[r];T("function"==typeof _&&"textureCube"===_._reglType,"invalid cube map"),T(_.width===(p=p||_.width)&&_.height===p,"invalid cube map shape"),f.color[r]={target:ct,data:u[r]}}for(r=0;r<6;++r){for(var E=0;E<u.length;++E)f.color[E].target=ct+r;r>0&&(f.depth=o[0].depth,f.stencil=o[0].stencil,f.depthStencil=o[0].depthStencil),o[r]?o[r](f):o[r]=O(f)}return t(a,{width:p,height:p,color:u})}return a(e),t(a,{faces:o,resize:function(e){var t,n=0|e;if(T(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(t=0;t<i.length;++t)i[t].resize(n);for(t=0;t<6;++t)o[t].resize(n);return a.width=a.height=n,a},_reglType:"framebufferCube",destroy:function(){o.forEach(function(e){e.destroy()})}})},clear:function(){V(_).forEach(x)},restore:function(){c.cur=null,c.next=null,c.dirty=!0,V(_).forEach(function(t){t.framebuffer=e.createFramebuffer(),A(t)})}})}(i,p,y,x,A,f),w=Vn(i,l,p,y,b,E,0,O,{},_,S,{elements:null,primitive:4,count:-1,offset:0,instances:-1},m,d,r),k=function(t,n,r,i,o,a,c){function s(s){var u;null===n.next?(T(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=ht):(T(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=n.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(T(u===ht||u===vt,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),u===vt&&T(c.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):T(u===ht,"Reading from a framebuffer is only allowed for the type 'uint8'"));var l=0,f=0,p=i.framebufferWidth,d=i.framebufferHeight,h=null;e(s)?h=s:s&&(T.type(s,"object","invalid arguments to regl.read()"),f=0|s.y,T((l=0|s.x)>=0&&l<i.framebufferWidth,"invalid x offset for regl.read"),T(f>=0&&f<i.framebufferHeight,"invalid y offset for regl.read"),p=0|(s.width||i.framebufferWidth-l),d=0|(s.height||i.framebufferHeight-f),h=s.data||null),h&&(u===ht?T(h instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===vt&&T(h instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),T(p>0&&p+l<=i.framebufferWidth,"invalid width for read pixels"),T(d>0&&d+f<=i.framebufferHeight,"invalid height for read pixels"),r();var v=p*d*4;return h||(u===ht?h=new Uint8Array(v):u===vt&&(h=h||new Float32Array(v))),T.isTypedArray(h,"data buffer for regl.read() must be a typedarray"),T(h.byteLength>=v,"data buffer for regl.read() too small"),t.pixelStorei(3333,4),t.readPixels(l,f,p,d,6408,u,h),h}return function(e){return e&&"framebuffer"in e?function(e){var t;return n.setFBO({framebuffer:e.framebuffer},function(){t=s(e)}),t}(e):s(e)}}(i,O,w.procs.poll,m,o,p,y),N=w.next,L=i.canvas,j=[],W=[],Y=[],Z=[r.onDestroy],le=null;function fe(){if(0===j.length)return d&&d.update(),void(le=null);le=P.next(fe),yt();for(var e=j.length-1;e>=0;--e){var t=j[e];t&&t(m,null,0)}i.flush(),d&&d.update()}function Ne(){!le&&j.length>0&&(le=P.next(fe))}function Le(){le&&(P.cancel(fe),le=null)}function je(e){e.preventDefault(),a=!0,Le(),W.forEach(function(e){e()})}function ze(e){i.getError(),a=!1,c.restore(),S.restore(),b.restore(),x.restore(),A.restore(),O.restore(),_.restore(),d&&d.restore(),w.procs.refresh(),Ne(),Y.forEach(function(e){e()})}function Ge(e){function n(e,t){var n={},r={};return Object.keys(e).forEach(function(i){var o=e[i];if(I.isDynamic(o))r[i]=I.unbox(o,i);else{if(t&&Array.isArray(o))for(var a=0;a<o.length;++a)if(I.isDynamic(o[a]))return void(r[i]=I.unbox(o,i));n[i]=o}}),{dynamic:r,static:n}}T(!!e,"invalid args to regl({...})"),T.type(e,"object","invalid args to regl({...})");var r=n(e.context||{},!0),i=n(e.uniforms||{},!0),o=n(e.attributes||{},!1),c=n(function(e){var n=t({},e);function r(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in e&&(n.vao=e.vao),n}(e),!1),s={gpuTime:0,cpuTime:0,count:0},u=w.compile(c,o,i,r,s),l=u.draw,f=u.batch,p=u.scope,d=[];return t(function(e,t){var n;if(a&&T.raise("context lost"),"function"==typeof e)return p.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)p.call(this,null,t,n);else{if(!Array.isArray(e))return p.call(this,e,t,0);for(n=0;n<e.length;++n)p.call(this,e[n],t,n)}else if("number"==typeof e){if(e>0)return f.call(this,function(e){for(;d.length<e;)d.push(null);return d}(0|e),0|e)}else{if(!Array.isArray(e))return l.call(this,e);if(e.length)return f.call(this,e,e.length)}},{stats:s,destroy:function(){u.destroy()}})}L&&(L.addEventListener(Hn,je,!1),L.addEventListener(Xn,ze,!1));var Ve=O.setFBO=Ge({framebuffer:I.define.call(null,1,"framebuffer")});function nt(e,t){var n=0;w.procs.poll();var r=t.color;r&&(i.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(i.clearDepth(+t.depth),n|=256),"stencil"in t&&(i.clearStencil(0|t.stencil),n|=1024),T(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function gt(e){return T.type(e,"function","regl.frame() callback must be a function"),j.push(e),Ne(),{cancel:function(){var t=Wn(j,e);T(t>=0,"cannot cancel a frame twice"),j[t]=function e(){var t=Wn(j,e);j[t]=j[j.length-1],j.length-=1,j.length<=0&&Le()}}}}function mt(){var e=N.viewport,t=N.scissor_box;e[0]=e[1]=t[0]=t[1]=0,m.viewportWidth=m.framebufferWidth=m.drawingBufferWidth=e[2]=t[2]=i.drawingBufferWidth,m.viewportHeight=m.framebufferHeight=m.drawingBufferHeight=e[3]=t[3]=i.drawingBufferHeight}function yt(){m.tick+=1,m.time=_t(),mt(),w.procs.poll()}function bt(){x.refresh(),mt(),w.procs.refresh(),d&&d.update()}function _t(){return(C()-h)/1e3}bt();var Et=t(Ge,{clear:function(e){if(T("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)Ve(t({framebuffer:e.framebuffer.faces[n]},e),nt);else Ve(e,nt);else nt(0,e)},prop:I.define.bind(null,1),context:I.define.bind(null,2),this:I.define.bind(null,3),draw:Ge({}),buffer:function(e){return b.create(e,34962,!1,!1)},elements:function(e){return E.create(e,!1)},texture:x.create2D,cube:x.createCube,renderbuffer:A.create,framebuffer:O.create,framebufferCube:O.createCube,vao:_.createVAO,attributes:o,frame:gt,on:function(e,t){var n;switch(T.type(t,"function","listener callback must be a function"),e){case"frame":return gt(t);case"lost":n=W;break;case"restore":n=Y;break;case"destroy":n=Z;break;default:T.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}},limits:y,hasExtension:function(e){return y.extensions.indexOf(e.toLowerCase())>=0},read:k,destroy:function(){j.length=0,Le(),L&&(L.removeEventListener(Hn,je),L.removeEventListener(Xn,ze)),S.clear(),O.clear(),A.clear(),x.clear(),E.clear(),b.clear(),_.clear(),d&&d.clear(),Z.forEach(function(e){e()})},_gl:i,_refresh:bt,poll:function(){yt(),d&&d.update()},now:_t,stats:f});return r.onDone(null,Et),Et}}()},fmRc:function(e,t,n){var r=n("Xi7e"),i=n("77Zs"),o=n("L8xA"),a=n("gCq4"),c=n("VaNO"),s=n("0Cz8");function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=c,u.prototype.set=s,e.exports=u},fo6e:function(e,t){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return n.test(e)}},ftKO:function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},g4R6:function(e,t){e.exports=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},gCq4:function(e,t){e.exports=function(e){return this.__data__.get(e)}},gQMU:function(e,t,n){var r=n("0ZTe")("toUpperCase");e.exports=r},gzZq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingToSyntax=void 0;var r=n("MON2"),i=n("FV85"),o=n("D9lx"),a=n("LKzl"),c=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=e,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);return this.to(this._binding.serviceIdentifier)},e.prototype.toConstantValue=function(e){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(r.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=i.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},new a.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},e}();t.BindingToSyntax=c},h1nZ:function(e,t,n){"use strict";var r=n("fX6N");n.d(t,"createSceneContainer",function(){return r.b}),n.d(t,"createLayerContainer",function(){return r.a}),n.d(t,"lazyInject",function(){return r.c}),n("+em5");var i=n("bB6j");n.d(t,"TYPES",function(){return i.a}),n("8/Fi"),n("PUg6"),n("cZlC");var o=n("O1je");n.o(o,"CoordinateSystem")&&n.d(t,"CoordinateSystem",function(){return o.CoordinateSystem}),n.o(o,"MapServiceEvent")&&n.d(t,"MapServiceEvent",function(){return o.MapServiceEvent}),n.o(o,"PositionType")&&n.d(t,"PositionType",function(){return o.PositionType}),n.o(o,"Scene")&&n.d(t,"Scene",function(){return o.Scene}),n.o(o,"SceneEventList")&&n.d(t,"SceneEventList",function(){return o.SceneEventList}),n.o(o,"gl")&&n.d(t,"gl",function(){return o.gl});var a=n("L56e");n.d(t,"MapServiceEvent",function(){return a.a});var c=n("HthE");n.d(t,"CoordinateSystem",function(){return c.a});var s=n("/33/");n.o(s,"PositionType")&&n.d(t,"PositionType",function(){return s.PositionType}),n.o(s,"Scene")&&n.d(t,"Scene",function(){return s.Scene}),n.o(s,"SceneEventList")&&n.d(t,"SceneEventList",function(){return s.SceneEventList}),n.o(s,"gl")&&n.d(t,"gl",function(){return s.gl}),n("EfZ0");var u=n("riiI");n.o(u,"PositionType")&&n.d(t,"PositionType",function(){return u.PositionType}),n.o(u,"Scene")&&n.d(t,"Scene",function(){return u.Scene}),n.o(u,"SceneEventList")&&n.d(t,"SceneEventList",function(){return u.SceneEventList}),n.o(u,"gl")&&n.d(t,"gl",function(){return u.gl});var l=n("eg+a");n.d(t,"SceneEventList",function(){return l.a});var f=n("bYl4");n.o(f,"PositionType")&&n.d(t,"PositionType",function(){return f.PositionType}),n.o(f,"Scene")&&n.d(t,"Scene",function(){return f.Scene}),n.o(f,"gl")&&n.d(t,"gl",function(){return f.gl});var p=n("FI6e");n.o(p,"PositionType")&&n.d(t,"PositionType",function(){return p.PositionType}),n.o(p,"Scene")&&n.d(t,"Scene",function(){return p.Scene}),n.o(p,"gl")&&n.d(t,"gl",function(){return p.gl});var d=n("D+ow");n.o(d,"PositionType")&&n.d(t,"PositionType",function(){return d.PositionType}),n.o(d,"Scene")&&n.d(t,"Scene",function(){return d.Scene}),n.o(d,"gl")&&n.d(t,"gl",function(){return d.gl});var h=n("AFH1");n.d(t,"PositionType",function(){return h.a});var v=n("8uyu");n.o(v,"Scene")&&n.d(t,"Scene",function(){return v.Scene}),n.o(v,"gl")&&n.d(t,"gl",function(){return v.gl});var g=n("J7lC");n.o(g,"Scene")&&n.d(t,"Scene",function(){return g.Scene}),n.o(g,"gl")&&n.d(t,"gl",function(){return g.gl});var m=n("QGbF");n.o(m,"Scene")&&n.d(t,"Scene",function(){return m.Scene}),n.o(m,"gl")&&n.d(t,"gl",function(){return m.gl}),n("V1cb");var y=n("4kj+");n.o(y,"Scene")&&n.d(t,"Scene",function(){return y.Scene}),n.o(y,"gl")&&n.d(t,"gl",function(){return y.gl});var b=n("bzyH");n.o(b,"Scene")&&n.d(t,"Scene",function(){return b.Scene}),n.o(b,"gl")&&n.d(t,"gl",function(){return b.gl});var _=n("0eqD");n.o(_,"Scene")&&n.d(t,"Scene",function(){return _.Scene}),n.o(_,"gl")&&n.d(t,"gl",function(){return _.gl});var E=n("/Uc5");n.o(E,"Scene")&&n.d(t,"Scene",function(){return E.Scene}),n.o(E,"gl")&&n.d(t,"gl",function(){return E.gl});var S=n("RMtq");n.o(S,"Scene")&&n.d(t,"Scene",function(){return S.Scene}),n.o(S,"gl")&&n.d(t,"gl",function(){return S.gl});var T=n("1jvM");n.o(T,"Scene")&&n.d(t,"Scene",function(){return T.Scene}),n.o(T,"gl")&&n.d(t,"gl",function(){return T.gl}),n("bPkA");var x=n("PSsN");n.o(x,"Scene")&&n.d(t,"Scene",function(){return x.Scene}),n.o(x,"gl")&&n.d(t,"gl",function(){return x.gl});var A=n("6NqC");n.o(A,"Scene")&&n.d(t,"Scene",function(){return A.Scene}),n.o(A,"gl")&&n.d(t,"gl",function(){return A.gl});var O=n("bTtR");n.o(O,"Scene")&&n.d(t,"Scene",function(){return O.Scene}),n.o(O,"gl")&&n.d(t,"gl",function(){return O.gl});var w=n("o+pz");n.d(t,"gl",function(){return w.a})},h7MG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBindingDictionary=t.createMockRequest=t.plan=void 0;var r=n("doU7"),i=n("MON2"),o=n("FV85"),a=n("xfSm"),c=n("qK8v"),s=n("ujMp"),u=n("oy+k"),l=n("GXnB"),f=n("yMAV"),p=n("fbrv"),d=n("xiII"),h=n("dX1H");function v(e){return e._bindingDictionary}function g(e,t,n,o,a){var c,u=y(n.container,a.serviceIdentifier);return u.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&e.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),u=y(n.container,a.serviceIdentifier)),c=t?u:u.filter(function(e){var t=new d.Request(e.serviceIdentifier,n,o,e,a);return e.constraint(t)}),function(e,t,n,o){switch(t.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var a=s.getServiceIdentifierAsString(e),c=i.NOT_REGISTERED;throw c+=s.listMetadataForTarget(a,n),c+=s.listRegisteredBindingsForServiceIdentifier(o,a,y),new Error(c);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;throw a=s.getServiceIdentifierAsString(e),c=i.AMBIGUOUS_MATCH+" "+a,c+=s.listRegisteredBindingsForServiceIdentifier(o,a,y),new Error(c)}}(a.serviceIdentifier,c,a,n.container),c}function m(e,t,n,r,a,c){var s,u;if(null===a){s=g(e,t,r,null,c),u=new d.Request(n,r,null,s,c);var l=new f.Plan(r,u);r.addPlan(l)}else s=g(e,t,r,a,c),u=a.addChildRequest(c.serviceIdentifier,s,c);s.forEach(function(t){var n=null;if(c.isArray())n=u.addChildRequest(t.serviceIdentifier,t,c);else{if(t.cache)return;n=u}if(t.type===o.BindingTypeEnum.Instance&&null!==t.implementationType){var a=p.getDependencies(e,t.implementationType);if(!r.container.options.skipBaseClassChecks){var s=p.getBaseClassDependencyCount(e,t.implementationType);if(a.length<s){var l=i.ARGUMENTS_LENGTH_MISMATCH(p.getFunctionName(t.implementationType));throw new Error(l)}}a.forEach(function(t){m(e,!1,t.serviceIdentifier,r,n,t)})}})}function y(e,t){var n=[],r=v(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=y(e.parent,t)),n}t.getBindingDictionary=v,t.plan=function(e,t,n,r,i,o,f,p){void 0===p&&(p=!1);var d=new u.Context(t),v=function(e,t,n,r,i,o){var c=new l.Metadata(e?a.MULTI_INJECT_TAG:a.INJECT_TAG,n),s=new h.Target(t,"",n,c);if(void 0!==i){var u=new l.Metadata(i,o);s.metadata.push(u)}return s}(n,r,i,0,o,f);try{return m(e,p,i,d,null,v),d}catch(g){throw c.isStackOverflowExeption(g)&&d.plan&&s.circularDependencyToException(d.plan.rootRequest),g}},t.createMockRequest=function(e,t,n,r){var i=new h.Target(o.TargetTypeEnum.Variable,"",t,new l.Metadata(n,r)),a=new u.Context(e);return new d.Request(t,a,null,[],i)}},heNW:function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},hi0z:function(e,t,n){"use strict";e.exports=function(){function e(e){var r=[];return e.AMapUI&&r.push(t(e.AMapUI)),e.Loca&&r.push(n(e.Loca)),Promise.all(r)}function t(e){return new Promise(function(t,n){var i=[];if(e.plugins)for(var s=0;s<e.plugins.length;s+=1)-1==o.AMapUI.plugins.indexOf(e.plugins[s])&&i.push(e.plugins[s]);if(a.AMapUI===r.failed)n("\u524d\u6b21\u8bf7\u6c42 AMapUI \u5931\u8d25");else if(a.AMapUI===r.notload){a.AMapUI=r.loading,o.AMapUI.version=e.version||o.AMapUI.version,s=o.AMapUI.version;var u=document.body||document.head,l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/ui/"+s+"/main.js",l.onerror=function(e){a.AMapUI=r.failed,n("\u8bf7\u6c42 AMapUI \u5931\u8d25")},l.onload=function(){if(a.AMapUI=r.loaded,i.length)window.AMapUI.loadUI(i,function(){for(var e=0,n=i.length;e<n;e++){var r=i[e].split("/").slice(-1)[0];window.AMapUI[r]=arguments[e]}for(t();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()});else for(t();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()},u.appendChild(l)}else a.AMapUI===r.loaded?e.version&&e.version!==o.AMapUI.version?n("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c AMapUI \u6df7\u7528"):i.length?window.AMapUI.loadUI(i,function(){for(var e=0,n=i.length;e<n;e++){var r=i[e].split("/").slice(-1)[0];window.AMapUI[r]=arguments[e]}t()}):t():e.version&&e.version!==o.AMapUI.version?n("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c AMapUI \u6df7\u7528"):c.AMapUI.push(function(e){e?n(e):i.length?window.AMapUI.loadUI(i,function(){for(var e=0,n=i.length;e<n;e++){var r=i[e].split("/").slice(-1)[0];window.AMapUI[r]=arguments[e]}t()}):t()})})}function n(e){return new Promise(function(t,n){if(o.AMap.version.startsWith("2.0"))n("Loca \u6682\u4e0d\u9002\u914d JSAPI 2.0,\u8bf7\u4f7f\u7528 1.4.15");else if(a.Loca===r.failed)n("\u524d\u6b21\u8bf7\u6c42 Loca \u5931\u8d25");else if(a.Loca===r.notload){a.Loca=r.loading,o.Loca.version=e.version||o.Loca.version;var i=o.Loca.version,s=o.key,u=document.body||document.head,l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/loca?v="+i+"&key="+s,l.onerror=function(e){a.Loca=r.failed,n("\u8bf7\u6c42 AMapUI \u5931\u8d25")},l.onload=function(){for(a.Loca=r.loaded,t();c.Loca.length;)c.Loca.splice(0,1)[0]()},u.appendChild(l)}else a.Loca===r.loaded?e.version&&e.version!==o.Loca.version?n("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c Loca \u6df7\u7528"):t():e.version&&e.version!==o.Loca.version?n("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c Loca \u6df7\u7528"):c.Loca.push(function(e){e?n(e):n()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var r,i;(i=r||(r={})).notload="notload",i.loading="loading",i.loaded="loaded",i.failed="failed";var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},c={AMap:[],AMapUI:[],Loca:[]},s=[];return{load:function(t){return new Promise(function(n,i){if(a.AMap==r.failed)i("");else if(a.AMap==r.notload){var c=t.key,u=t.version,l=t.plugins;c?(window.AMap&&"lbs.amap.com"!==location.host&&i("\u7981\u6b62\u591a\u79cdAPI\u52a0\u8f7d\u65b9\u5f0f\u6df7\u7528"),o.key=c,o.AMap.version=u||o.AMap.version,o.AMap.plugins=l||o.AMap.plugins,a.AMap=r.loading,u=document.body||document.head,window.___onAPILoaded=function(o){if(delete window.___onAPILoaded,o)a.AMap=r.failed,i(o);else for(a.AMap=r.loaded,e(t).then(function(){n(window.AMap)}).catch(i);s.length;)s.splice(0,1)[0]()},(l=document.createElement("script")).type="text/javascript",l.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+c+"&plugin="+o.AMap.plugins.join(","),l.onerror=function(e){a.AMap=r.failed,i(e)},u.appendChild(l)):i("\u8bf7\u586b\u5199key")}else if(a.AMap==r.loaded)if(t.key&&t.key!==o.key)i("\u591a\u4e2a\u4e0d\u4e00\u81f4\u7684 key");else if(t.version&&t.version!==o.AMap.version)i("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c JSAPI \u6df7\u7528");else{if(c=[],t.plugins)for(u=0;u<t.plugins.length;u+=1)-1==o.AMap.plugins.indexOf(t.plugins[u])&&c.push(t.plugins[u]);c.length?window.AMap.plugin(c,function(){e(t).then(function(){n(window.AMap)}).catch(i)}):e(t).then(function(){n(window.AMap)}).catch(i)}else if(t.key&&t.key!==o.key)i("\u591a\u4e2a\u4e0d\u4e00\u81f4\u7684 key");else if(t.version&&t.version!==o.AMap.version)i("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c JSAPI \u6df7\u7528");else{var f=[];if(t.plugins)for(u=0;u<t.plugins.length;u+=1)-1==o.AMap.plugins.indexOf(t.plugins[u])&&f.push(t.plugins[u]);!function(e){a.AMap===r.loaded?e(window):s.push(e)}(function(){f.length?window.AMap.plugin(f,function(){e(t).then(function(){n(window.AMap)}).catch(i)}):e(t).then(function(){n(window.AMap)}).catch(i)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},c={AMap:[],AMapUI:[],Loca:[]}}}}()},hypo:function(e,t,n){var r=n("O0oS");e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},iWIM:function(e,t,n){var r=n("n3AX");function i(t,n,o){return e.exports=i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},iegG:function(e,t){function n(e){var t=e.target||e.srcElement;t.__resizeRAF__&&cancelAnimationFrame(t.__resizeRAF__),t.__resizeRAF__=requestAnimationFrame(function(){var n=t.__resizeTrigger__,r=n&&n.__resizeListeners__;r&&r.forEach(function(t){t.call(n,e)})})}t=function(e,t){var r,i=this.document,o=i.attachEvent;if("undefined"!=typeof navigator&&(r=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!e.__resizeListeners__)if(e.__resizeListeners__=[],o)e.__resizeTrigger__=e,e.attachEvent("onresize",n);else{"static"===getComputedStyle(e).position&&(e.style.position="relative");var a=e.__resizeTrigger__=i.createElement("object");a.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),a.setAttribute("class","resize-sensor"),a.setAttribute("tabindex","-1"),a.__resizeElement__=e,a.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",n)},a.type="text/html",r&&e.appendChild(a),a.data="about:blank",r||e.appendChild(a)}e.__resizeListeners__.push(t)},e.exports="undefined"==typeof window?t:t.bind(window),e.exports.unbind=function(e,t){var r=document.attachEvent,i=e.__resizeListeners__||[];if(t){var o=i.indexOf(t);-1!==o&&i.splice(o,1)}else i=e.__resizeListeners__=[];if(!i.length){if(r)e.detachEvent("onresize",n);else if(e.__resizeTrigger__){var a=e.__resizeTrigger__.contentDocument,c=a&&a.defaultView;c&&(c.removeEventListener("resize",n),delete c.__resizeTrigger__),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)}delete e.__resizeListeners__}}},itsj:function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},"jIg/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiInject=void 0;var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");t.multiInject=function(e){return function(t,n,a){var c=new i.Metadata(r.MULTI_INJECT_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,c):o.tagProperty(t,n,c)}}},jYx5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.optional=void 0;var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");t.optional=function(){return function(e,t,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(e,t,n,a):o.tagProperty(e,t,a)}}},"jbM+":function(e,t,n){var r=n("R/W3");e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},jeLo:function(e,t,n){var r=n("juv8"),i=n("mTTR");e.exports=function(e){return r(e,i(e))}},juv8:function(e,t,n){var r=n("MrPd"),i=n("hypo");e.exports=function(e,t,n,o){var a=!n;n||(n={});for(var c=-1,s=t.length;++c<s;){var u=t[c],l=o?o(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),a?i(n,u,l):r(n,u,l)}return n}},"k+1r":function(e,t,n){var r=n("QkVE");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},"k5/I":function(e,t,n){"use strict";n.d(t,"a",function(){return A});var r,i=n("lSNA"),o=n.n(i),a=n("lwsE"),c=n.n(a),s=n("W8MJ"),u=n.n(s),l=n("7W2i"),f=n.n(l),p=n("a1gu"),d=n.n(p),h=n("Nsbk"),v=n.n(h),g=n("h1nZ"),m=n("Hel2"),y=n("uhBA");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}!function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft"}(r||(r={}));var E=0,S=function(e){f()(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function o(e){var t;return c()(this,o),(t=i.call(this)).controlOption=void 0,t.container=void 0,t.sceneContainer=void 0,t.mapsService=void 0,t.renderService=void 0,t.layerService=void 0,t.controlService=void 0,t.isShow=void 0,t.controlOption=_(_({},t.getDefault()),e||{}),t}return u()(o,[{key:"getDefault",value:function(){return{position:r.TOPRIGHT,name:"".concat(E++)}}},{key:"setPosition",value:function(e){var t=this.controlService;return t&&t.removeControl(this),this.controlOption.position=e,t&&t.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(e){this.mapsService=e.get(g.TYPES.IMapService),this.renderService=e.get(g.TYPES.IRendererService),this.layerService=e.get(g.TYPES.ILayerService),this.controlService=e.get(g.TYPES.IControlService),this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd();var t=this.container,n=this.controlOption.position,r=this.controlService.controlCorners[n];return m.a.addClass(t,"l7-control"),-1!==n.indexOf("bottom")?r.insertBefore(t,r.firstChild):r.appendChild(t),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){m.a.addClass(this.container,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){m.a.removeClass(this.container,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;m.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(e){if(this.mapsService&&e&&e.screenX>0&&e.screenY>0){var t=this.mapsService.getContainer();null!==t&&t.focus()}}}]),o}(y.EventEmitter),T=n("PJYZ"),x=n.n(T);!function(e){f()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function i(e){var t;return c()(this,i),(t=r.call(this,e)).layerControlInputs=void 0,t.layers=void 0,t.lastZIndex=void 0,t.handlingClick=void 0,t.layersLink=void 0,t.baseLayersList=void 0,t.separator=void 0,t.overlaysList=void 0,t.form=void 0,t.layerControlInputs=[],t.layers=[],t.lastZIndex=0,t.handlingClick=!1,t.initLayers(),Object(m.g)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],x()(t)),t}u()(i,[{key:"getDefault",value:function(){return{collapsed:!0,position:g.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var e=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(t){t.layer.on("remove",e.onLayerChange),t.layer.on("add",e.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(e,t){return this.addLayer(e,t,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var e=this.renderService.getViewportSize().height;m.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var t=e-(this.container.offsetTop+50);return t<this.form.clientHeight?(m.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=t+"px"):m.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return m.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var e=this;this.mapsService&&(this.mapsService.off("click",this.collapse),this.layers.forEach(function(t){t.layer.off("remove",e.onLayerChange),t.layer.off("add",e.onLayerChange)}))}},{key:"initLayout",value:function(){var e="l7-control-layers",t=this.container=m.a.create("div",e),n=this.controlOption.collapsed;t.setAttribute("aria-haspopup","true");var r=this.form=m.a.create("form",e+"-list");n&&(this.mapsService.on("click",this.collapse),t.addEventListener("mouseenter",this.expand),t.addEventListener("mouseleave",this.collapse)),this.layersLink=m.a.create("a",e+"-toggle",t),this.layersLink.title="Layers",n||this.expand(),this.baseLayersList=m.a.create("div",e+"-base",r),this.separator=m.a.create("div",e+"-separator",r),this.overlaysList=m.a.create("div",e+"-overlays",r),t.appendChild(r)}},{key:"initLayers",value:function(){var e=this,t=this.controlOption,n=t.baseLayers,r=void 0===n?{}:n,i=t.overlayers,o=void 0===i?{}:i;Object.keys(r).forEach(function(t,n){e.addLayer(r[t],t,!1)}),Object.keys(o).forEach(function(t,n){e.addLayer(o[t],t,!0)})}},{key:"update",value:function(){if(!this.container)return this;var e,t,n,r;m.a.empty(this.baseLayersList),m.a.empty(this.overlaysList),this.layerControlInputs=[];var i=0;for(n=0;n<this.layers.length;n++)this.addItem(r=this.layers[n]),t=t||r.overlay,e=e||!r.overlay,i+=r.overlay?0:1;return this.controlOption.hideSingleBase&&(this.baseLayersList.style.display=(e=e&&i>1)?"":"none"),this.separator.style.display=t&&e?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var e,t,n=this.layerControlInputs,r=this.mapsService.getZoom(),i=n.length-1;i>=0;i--)if((t=this.layerService.getLayer((e=n[i]).layerId))&&t.inited){var o=t.getMinZoom(),a=t.getMaxZoom();e.disabled=r<o||r>a}}},{key:"addLayer",value:function(e,t,n){this.mapsService&&(e.on("add",this.onLayerChange),e.on("remove",this.onLayerChange)),this.layers.push({layer:e,name:t,overlay:n});var r=this.controlOption,i=r.sortFunction,o=r.autoZIndex;r.sortLayers&&this.layers.sort(function(e,t){return i(e.layer,t.layer,e.name,t.name)}),o&&e.setZIndex&&(this.lastZIndex++,e.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(e){this.handlingClick||this.update();var t=this.layerService.getLayer(e.target.layerId),n=(null==t?void 0:t.overlay)?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this.emit(n,t)}},{key:"createRadioElement",value:function(e,t){var n='<input type="radio" class="l7-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild}},{key:"addItem",value:function(e){var t,n=document.createElement("label"),r=this.layerService.getLayer(e.layer.id),i=r&&r.inited&&e.layer.isVisible();e.overlay?((t=document.createElement("input")).type="checkbox",t.className="l7-control-layers-selector",t.defaultChecked=i):t=this.createRadioElement("l7-base-layers",i),this.layerControlInputs.push(t),t.layerId=e.layer.id,t.addEventListener("click",this.onInputClick);var o=document.createElement("span");o.innerHTML=" "+e.name;var a=document.createElement("div");return n.appendChild(a),a.appendChild(t),a.appendChild(o),(e.overlay?this.overlaysList:this.baseLayersList).appendChild(n),this.checkDisabledLayers(),n}},{key:"onInputClick",value:function(){var e,t,n=this.layerControlInputs,r=[],i=[];this.handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=this.layerService.getLayer((e=n[o]).layerId),e.checked?r.push(t):e.checked||i.push(t);i.forEach(function(e){e.hide()}),r.forEach(function(e){e.show()}),this.handlingClick=!1}}])}(S);var A=function(e){f()(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function o(){return c()(this,o),i.apply(this,arguments)}return u()(o,[{key:"getDefault",value:function(){return{position:r.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var e=m.a.create("div","l7-control-logo"),t=m.a.create("a","l7-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://antv.alipay.com/l7",t.setAttribute("aria-label","AntV logo"),t.setAttribute("rel","noopener nofollow"),e.appendChild(t),e}},{key:"onRemove",value:function(){return null}}]),o}(S);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}!function(e){f()(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function o(e){var t;return c()(this,o),(t=i.call(this,e)).mScale=void 0,t.iScale=void 0,Object(m.g)(["update"],x()(t)),t}u()(o,[{key:"getDefault",value:function(){return{position:r.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var e="l7-control-scale",t=m.a.create("div",e);this.addScales(e+"-line",t);var n=this.controlOption.updateWhenIdle;return this.mapsService.on(n?"moveend":"mapmove",this.update),this.mapsService.on(n?"zoomend":"zoomchange",this.update),this.update(),t}},{key:"onRemove",value:function(){var e=this.controlOption.updateWhenIdle;this.mapsService.off(e?"zoomend":"zoomchange",this.update),this.mapsService.off(e?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var e=this.mapsService,t=this.controlOption.maxWidth,n=e.getSize()[1]/2,r=e.containerToLngLat([0,n]),i=e.containerToLngLat([t,n]),o=Object(m.k)([r.lng,r.lat],[i.lng,i.lat]);this.updateScales(o)}},{key:"updateScales",value:function(e){var t=this.controlOption,n=t.imperial;t.metric&&e&&this.updateMetric(e),n&&e&&this.updateImperial(e)}},{key:"updateMetric",value:function(e){var t=this.getRoundNum(e);this.updateScale(this.mScale,t<1e3?t+" m":t/1e3+" km",t/e)}},{key:"updateImperial",value:function(e){var t,n,r,i=3.2808399*e;i>5280?(n=this.getRoundNum(t=i/5280),this.updateScale(this.iScale,n+" mi",n/t)):(r=this.getRoundNum(i),this.updateScale(this.iScale,r+" ft",r/i))}},{key:"updateScale",value:function(e,t,n){e.style.width=Math.round(this.controlOption.maxWidth*n)+"px",e.innerHTML=t}},{key:"getRoundNum",value:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}},{key:"addScales",value:function(e,t){var n=this.controlOption,r=n.imperial;n.metric&&(this.mScale=m.a.create("div",e,t)),r&&(this.iScale=m.a.create("div",e,t))}}])}(S),function(e){f()(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function o(e){var t;return c()(this,o),(t=i.call(this,e)).disabled=void 0,t.zoomInButton=void 0,t.zoomOutButton=void 0,Object(m.g)(["updateDisabled","zoomIn","zoomOut"],x()(t)),t}u()(o,[{key:"getDefault",value:function(){return{position:r.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var e="l7-control-zoom",t=m.a.create("div",e+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,e+"-in",t,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,e+"-out",t,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),t}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(e,t,n,r,i){var o=m.a.create("a",n,r);return o.innerHTML=e,o.title=t,o.href="javascript:void(0)",o.addEventListener("click",i),o}},{key:"updateDisabled",value:function(){var e=this.mapsService,t="l7-disabled";m.a.removeClass(this.zoomInButton,t),m.a.removeClass(this.zoomOutButton,t),(this.disabled||e.getZoom()<=e.getMinZoom())&&m.a.addClass(this.zoomOutButton,t),(this.disabled||e.getZoom()>=e.getMaxZoom())&&m.a.addClass(this.zoomInButton,t)}}])}(S);var k=function(e){f()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function i(e){var t;return c()(this,i),(t=r.call(this)).markerOption=void 0,t.defaultMarker=void 0,t.popup=void 0,t.mapsService=void 0,t.sceneSerive=void 0,t.lngLat=void 0,t.scene=void 0,t.added=!1,t.eventHandle=function(e){t.emit(e.type,{target:e,data:t.markerOption.extData,lngLat:t.lngLat})},t.markerOption=w(w({},t.getDefault()),e),Object(m.g)(["update","onMove","onUp","addDragHandler","onMapClick"],x()(t)),t.init(),t}return u()(i,[{key:"getDefault",value:function(){return{element:void 0,anchor:m.e.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(e){this.scene=e,this.mapsService=e.get(g.TYPES.IMapService),this.sceneSerive=e.get(g.TYPES.ISceneService);var t=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(t),this.registerMarkerEvent(t),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var e=this.markerOption.element;return e&&m.a.remove(e),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(e){var t=this;if(!this.added)return this.once("added",function(){t.setElement(e)}),this;var n=this.markerOption.element;return n&&m.a.remove(n),this.markerOption.element=e,this.init(),this.mapsService.getMarkerContainer().appendChild(e),this.registerMarkerEvent(e),this.update(),this}},{key:"openPopup",value:function(){var e=this;if(!this.added)return this.once("added",function(){e.openPopup()}),this;var t=this.popup;return t?(t.isOpen()||t.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var e=this;this.added||this.once("added",function(){e.closePopup()});var t=this.popup;return t&&t.remove(),this}},{key:"setPopup",value:function(e){return this.popup=e,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var e=this.popup;return e?(e.isOpen()?e.remove():e.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(e){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(e){this.markerOption.extData=e}},{key:"update",value:function(){if(this.mapsService){var e=this.markerOption,t=e.element,n=e.anchor;this.updatePosition(),m.a.setTransform(t,"".concat(m.d[n]))}}},{key:"onMapClick",value:function(e){this.popup&&this.markerOption.element&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var e=this.markerOption,t=e.element,n=e.offsets,r=this.lngLat,i=r.lng,o=r.lat,a=this.mapsService.getBounds(),c=this.mapsService.getZoom();if((i<a[0][0]||i>a[1][0]||o<a[0][1]||o>a[1][1])&&c>3)t&&(t.style.display="none");else{var s=this.mapsService.lngLatToContainer([i,o]);t&&(t.style.display="block",t.style.left=s.x+n[0]+"px",t.style.top=s.y-n[1]+"px")}}}},{key:"init",value:function(){var e=this,t=this.markerOption.element,n=this.markerOption,r=n.color,i=n.anchor;if(!t){this.defaultMarker=!0,t=m.a.create("div"),this.markerOption.element=t;var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","48px"),o.setAttributeNS(null,"width","48px"),o.setAttributeNS(null,"viewBox","0 0 1024 1024");var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),a.setAttributeNS(null,"fill",r),o.appendChild(a),t.appendChild(o)}m.a.addClass(t,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(n){var r,i,o=(null===(r=e.markerOption)||void 0===r?void 0:r.style)&&(null===(i=e.markerOption)||void 0===i?void 0:i.style[n]);t&&(t.style[n]=o)}),t.addEventListener("click",function(t){e.onMapClick(t)}),t.addEventListener("click",this.eventHandle),Object(m.f)(t,i,"marker")}},{key:"registerMarkerEvent",value:function(e){e.addEventListener("mousemove",this.eventHandle),e.addEventListener("click",this.eventHandle),e.addEventListener("mousedown",this.eventHandle),e.addEventListener("mouseup",this.eventHandle),e.addEventListener("dblclick",this.eventHandle),e.addEventListener("contextmenu",this.eventHandle),e.addEventListener("mouseover",this.eventHandle),e.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var e=this.getElement();e.removeEventListener("mousemove",this.eventHandle),e.removeEventListener("click",this.eventHandle),e.removeEventListener("mousedown",this.eventHandle),e.removeEventListener("mouseup",this.eventHandle),e.removeEventListener("dblclick",this.eventHandle),e.removeEventListener("contextmenu",this.eventHandle),e.removeEventListener("mouseover",this.eventHandle),e.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(e){throw new Error("Method not implemented.")}},{key:"onUp",value:function(e){throw new Error("Method not implemented.")}}]),i}(y.EventEmitter),I=n("QkVN"),P=n.n(I),C=n("mpbz"),R=n.n(C);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}!function(e){f()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function i(e){var t,n;return c()(this,i),(n=r.call(this)).markers=[],n.markerLayerOption=void 0,n.clusterIndex=void 0,n.points=[],n.clusterMarkers=[],n.mapsService=void 0,n.scene=void 0,n.zoom=void 0,n.bbox=void 0,n.markerLayerOption=P()(n.getDefault(),e),Object(m.g)(["update"],x()(n)),n.zoom=(null===(t=n.markerLayerOption.clusterOption)||void 0===t?void 0:t.zoom)||-99,n}u()(i,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(e){return this.scene=e,this.mapsService=e.get(g.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(e){this.markerLayerOption.cluster&&this.addPoint(e,this.markers.length),this.markers.push(e)}},{key:"removeMarker",value:function(e){this.markers.indexOf(e);var t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}},{key:"getMarkers",value:function(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var e=this;this.getMarkers().forEach(function(t){t.addTo(e.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(e){e.remove()}),this.clusterMarkers.forEach(function(e){e.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(e,t){var n=e.getLnglat(),r={geometry:{type:"Point",coordinates:[n.lng,n.lat]},properties:N(N({},e.getExtData()),{},{marker_id:t})};this.points.push(r)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var e=this.markerLayerOption.clusterOption,t=e.minZoom;this.clusterIndex=new R.a({radius:e.radius,minZoom:void 0===t?0:t,maxZoom:e.maxZoom}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(e,t){var n=this,r=e[0].concat(e[1]),i=this.clusterIndex.getClusters(r,t);this.clusterMarkers.forEach(function(e){e.remove()}),this.clusterMarkers=[],i.forEach(function(e){var t,r=n.markerLayerOption.clusterOption,i=r.field,a=r.method;if(e.properties&&(null===(t=e.properties)||void 0===t?void 0:t.cluster_id)){var c,s=n.getLeaves(null===(c=e.properties)||void 0===c?void 0:c.cluster_id);if(e.properties.clusterData=s,i&&a){var u=null==s?void 0:s.map(function(e){return o()({},i,e.properties[i])}),l=m.c.getColumn(u,i),f=m.c.getSatByColumn(a,l);e.properties["point_"+a]=f.toFixed(2)}}var p=n.clusterMarker(e);n.clusterMarkers.push(p),p.addTo(n.scene)})}},{key:"getLeaves",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e?this.clusterIndex.getLeaves(e,t,n):null}},{key:"clusterMarker",value:function(e){var t=this.markerLayerOption.clusterOption.element,n=void 0===t?this.generateElement.bind(this):t;return new k({element:n(e)}).setLnglat({lng:e.geometry.coordinates[0],lat:e.geometry.coordinates[1]})}},{key:"normalMarker",value:function(e){return this.markers[e.properties.marker_id]}},{key:"update",value:function(){var e=this.mapsService.getZoom(),t=this.mapsService.getBounds();(!this.bbox||Math.abs(e-this.zoom)>=1||!Object(m.h)(this.bbox,t))&&(this.bbox=Object(m.l)(t,.5),this.zoom=Math.floor(e),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(e){var t=m.a.create("div","l7-marker-cluster"),n=m.a.create("div","",t),r=m.a.create("span","",n),i=this.markerLayerOption.clusterOption,o=i.field,a=i.method;return e.properties.point_count=e.properties.point_count||1,r.textContent=o&&a?e.properties["point_"+a]||e.properties[o]:e.properties.point_count,t}}])}(y.EventEmitter),function(e){f()(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=v()(t);if(n){var i=v()(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return d()(this,e)});function i(e){var t;return c()(this,i),(t=r.call(this)).popupOption=void 0,t.mapsService=void 0,t.sceneSerive=void 0,t.lngLat=void 0,t.content=void 0,t.closeButton=void 0,t.timeoutInstance=void 0,t.container=void 0,t.tip=void 0,t.scene=void 0,t.popupOption=j(j({},t.getdefault()),e),Object(m.g)(["update","onClickClose","remove"],x()(t)),t}u()(i,[{key:"addTo",value:function(e){var t=this;return this.mapsService=e.get(g.TYPES.IMapService),this.sceneSerive=e.get(g.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=e,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){t.mapsService.on("click",t.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(e){var t,n=window.document.createDocumentFragment(),r=window.document.createElement("body");for(r.innerHTML=e;t=r.firstChild;)n.appendChild(t);return this.setDOMContent(n)}},{key:"setLnglat",value:function(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(e){return this.setDOMContent(window.document.createTextNode(e))}},{key:"setMaxWidth",value:function(e){return this.popupOption.maxWidth=e,this.update(),this}},{key:"setDOMContent",value:function(e){return this.createContent(),this.content.appendChild(e),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&m.a.remove(this.content),this.content=m.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=m.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(e,t,n){var r=window.document.createElement(e);return void 0!==t&&(r.className=t),n&&n.appendChild(r),r}},{key:"removeDom",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:m.e.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(e){e.stopPropagation&&e.stopPropagation(),this.remove()}},{key:"update",value:function(){var e=this,t=this.popupOption,n=t.className,r=t.maxWidth,i=t.anchor;if(this.mapsService&&this.lngLat&&this.content){var o=this.mapsService.getMarkerContainer();!this.container&&o&&(this.container=this.creatDom("div","l7-popup",o),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),n&&n.split(" ").forEach(function(t){return e.container.classList.add(t)}),this.popupOption.stopPropagation&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(t){e.container.addEventListener(t,function(e){e.stopPropagation()})})),r&&this.container.style.maxWidth!==r&&(this.container.style.maxWidth=r),this.updatePosition(),m.a.setTransform(this.container,"".concat(m.d[i])),Object(m.f)(this.container,i,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var e=this.lngLat,t=this.popupOption.offsets,n=this.mapsService.lngLatToContainer([e.lng,e.lat]);this.container.style.left=n.x+t[0]+"px",this.container.style.top=n.y-t[1]+"px"}}}])}(y.EventEmitter),n("BGjm")('/* @antv/l7-component */\n.l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n }\n\n.l7-marker {\n\tposition: absolute !important;\n\ttop: 0;\n\tleft: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n    -webkit-flex-direction: column-reverse;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: reverse;\n        -ms-flex-direction: column-reverse;\n            flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n\t/* layers control */\n\n.l7-control-layers {\n\t-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);\n\t        box-shadow: 0 1px 5px rgba(0,0,0,0.4);\n\tbackground: #fff;\n\tborder-radius: 5px;\n\t}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n    -webkit-flex-direction: column;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n\n\n.l7-popup-anchor-left {\n    -webkit-flex-direction: row;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n    -webkit-flex-direction: row-reverse;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: reverse;\n        -ms-flex-direction: row-reverse;\n            flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-flex;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-top: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n\t-webkit-align-self: flex-start;\n\t-ms-flex-item-align: start;\n\t    align-self: flex-start;\n\tborder-top: none;\n\tborder-left: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n\t-webkit-align-self: flex-end;\n\t-ms-flex-item-align: end;\n\t    align-self: flex-end;\n\tborder-top: none;\n\tborder-right: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-bottom: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n\t-webkit-align-self: flex-start;\n\t-ms-flex-item-align: start;\n\t    align-self: flex-start;\n\tborder-bottom: none;\n\tborder-left: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n\t-webkit-align-self: flex-end;\n\t-ms-flex-item-align: end;\n\t    align-self: flex-end;\n\tborder-bottom: none;\n\tborder-right: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-left: none;\n\tborder-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-right: none;\n\tborder-left-color: #fff;\n}\n\n.l7-popup-close-button {\n\tposition: absolute;\n\tright: 0;\n\ttop: 0;\n\tborder: 0;\n\tpadding: 0;\n\tfont-size: 25px;\n\tline-height: 20px;\n\tborder-radius: 0 3px 0 0;\n\tcursor: pointer;\n\tbackground-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n\tbackground-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n\tposition: relative;\n\tbackground: #fff;\n\tborder-radius: 3px;\n\t-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\t        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\tpadding: 10px 10px 15px;\n\tpointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n\tborder-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n\tborder-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n\tborder-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n\tborder-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n\tdisplay: none;\n}\n\n.l7-popup-track-pointer * {\n\tpointer-events: none;\n\t-webkit-user-select: none;\n\t   -moz-user-select: none;\n\t    -ms-user-select: none;\n\t        user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n\tdisplay: -webkit-box;\n\tdisplay: -webkit-flex;\n\tdisplay: -ms-flexbox;\n\tdisplay: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n\tdisplay: none;\n}\n\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n\t-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);\n\t        box-shadow: 0 1px 5px rgba(0,0,0,0.65);\n\tborder-radius: 4px;\n\t}\n.l7-bar a,\n.l7-bar a:hover {\n\tbackground-color: #fff;\n\twidth: 30px;\n\theight: 30px;\n  font-size: 20px;\n\tdisplay: block;\n\ttext-align: center;\n\ttext-decoration: none;\n\tcolor: #8E9DAB;\n\t}\n.l7-bar a,\n.l7-control-layers-toggle {\n\tbackground-position: 50% 50%;\n\tbackground-repeat: no-repeat;\n\tdisplay: block;\n\t}\n.l7-bar a:hover {\n\tbackground-color: #f4f4f4;\n\t}\n.l7-bar a:first-child {\n\tborder-top-left-radius: 2px;\n\tborder-top-right-radius: 2px;\n\t}\n.l7-bar a:last-child {\n\tborder-bottom-left-radius: 2px;\n\tborder-bottom-right-radius: 2px;\n\tborder-bottom: none;\n\t}\n.l7-bar a.l7-disabled {\n\tcursor: default;\n\tbackground-color: #f4f4f4;\n\tcolor: #bbb;\n\t}\n\n\n/* control positioning */\n\n.l7-control-container {\n\tfont: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n\tdisplay: none;\n}\n.l7-control {\n\tposition: relative;\n\tz-index: 800;\n\tpointer-events: visiblePainted; /* IE 9-10 doesn\'t have auto */\n\tpointer-events: auto;\n\t}\n.l7-control {\n\tfloat: left;\n\tclear: both;\n\t}.l7-top,\n  .l7-bottom {\n    position: absolute;\n    z-index: 1000;\n    pointer-events: none;\n    }\n  .l7-top {\n    top: 0;\n    }\n  .l7-right {\n    right: 0;\n    }\n  .l7-bottom {\n    bottom: 0;\n    }\n  .l7-left {\n    left: 0;\n    }\n\n  .l7-control {\n    float: left;\n    clear: both;\n    }\n  .l7-right .l7-control {\n    float: right;\n    }\n  .l7-top .l7-control {\n    margin-top: 10px;\n    }\n  .l7-bottom .l7-control {\n    margin-bottom: 10px;\n    }\n  .l7-left .l7-control {\n    margin-left: 10px;\n    }\n  .l7-right .l7-control {\n    margin-right: 10px;\n    }\n\n  /* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n\tbackground: #fff;\n\tbackground: rgba(255, 255, 255, 0.7);\n\tmargin: 0;\n\t}\n.l7-control-attribution,\n.l7-control-scale-line {\n\tpadding: 0 5px;\n  color: #333;\n\t}\n.l7-control-attribution a {\n\ttext-decoration: none;\n\t}\n.l7-control-attribution a:hover {\n\ttext-decoration: underline;\n\t}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n\t}\n.l7-left .l7-control-scale {\n\tmargin-left: 5px;\n\t}\n.l7-bottom .l7-control-scale {\n\tmargin-bottom: 5px;\n\t}\n.l7-control-scale-line {\n\tborder: 2px solid #000;\n  border-top: none;\n  color: #000;\n\tline-height: 1.1;\n\tpadding: 2px 5px 1px;\n\tfont-size: 11px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\t-webkit-box-sizing: border-box;\n\t        box-sizing: border-box;\n\n\tbackground: #fff;\n\t}\n.l7-control-scale-line:not(:first-child) {\n\tborder-top: 2px solid #777;\n\tborder-bottom: none;\n\tmargin-top: -2px;\n\t}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n\tborder-bottom: 2px solid #777;\n\t}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n\t-webkit-box-shadow: none;\n\t        box-shadow: none;\n\t}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n\tborder: 2px solid rgba(0,0,0,0.2);\n\tbackground-clip: padding-box;\n  }\n  /*logo */\n\n  .l7-ctrl-logo {\n    background-size: 100% 100%;\n    width: 89px;\n    height: 16px;\n    margin: 0 0 -3px -3px;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    background-repeat: no-repeat;\n    cursor: pointer;\n    background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC\');\n}\n\n\n\t/* layers control */\n\n.l7-control-layers {\n\t-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);\n\t        box-shadow: 0 1px 8px rgba(0,0,0,0.4);\n\tbackground: #fff;\n\tborder-radius: 2px;\n\t}\n.l7-control-layers-toggle {\n\tbackground-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC\');\n\twidth: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n\t}\n\n.l7-touch .l7-control-layers-toggle {\n\twidth: 44px;\n\theight: 44px;\n\t}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n\tdisplay: none;\n\t}\n.l7-control-layers-expanded .l7-control-layers-list {\n\tdisplay: block;\n\tposition: relative;\n\t}\n.l7-control-layers-expanded {\n\tpadding: 6px 10px 6px 6px;\n\tcolor: #59626B;\n\tbackground: #fff;\n\t}\n.l7-control-layers-scrollbar {\n\toverflow-y: scroll;\n\toverflow-x: hidden;\n\tpadding-right: 5px;\n\t}\n.l7-control-layers-selector {\n\tmargin-top: 2px;\n\tposition: relative;\n\ttop: 1px;\n\t}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n  }\n  .l7-control-layers label input[type="radio"],\n  .l7-control-layers label input[type="checkbox"] {\n  width: 14px;\n  height: 14px;\n  margin: 0;\n}\n.l7-control-layers-separator {\n\theight: 0;\n\tborder-top: 1px solid #D8D8D8;\n\tmargin: 5px -10px 5px -6px;\n}\n.mapboxgl-ctrl-logo {\n  display: none !important;\n }\n .amap-logo{\n  display: none !important;\n }\n\n\n')},"kQ+U":function(e,t,n){"use strict";n.d(t,"a",function(){return fe});var r,i,o,a,c,s,u,l,f,p,d,h,v,g,m=n("lSNA"),y=n.n(m),b=n("lwsE"),_=n.n(b),E=n("W8MJ"),S=n.n(E),T=n("k5/I"),x=n("h1nZ"),A=n("o0o1"),O=n.n(A),w=n("yXPU"),k=n.n(w),I=n("4cb6"),P=n("fbvF"),C=n.n(P),R=function(){function e(t,n){_()(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,o=n.stride,a=n.normalized,c=n.size,s=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:s||0},c&&(this.attribute.size=c)}return S()(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),M=(r={},y()(r,x.gl.POINTS,"points"),y()(r,x.gl.LINES,"lines"),y()(r,x.gl.LINE_LOOP,"line loop"),y()(r,x.gl.LINE_STRIP,"line strip"),y()(r,x.gl.TRIANGLES,"triangles"),y()(r,x.gl.TRIANGLE_FAN,"triangle fan"),y()(r,x.gl.TRIANGLE_STRIP,"triangle strip"),r),N=(i={},y()(i,x.gl.STATIC_DRAW,"static"),y()(i,x.gl.DYNAMIC_DRAW,"dynamic"),y()(i,x.gl.STREAM_DRAW,"stream"),i),L=(o={},y()(o,x.gl.BYTE,"int8"),y()(o,x.gl.UNSIGNED_INT,"int16"),y()(o,x.gl.INT,"int32"),y()(o,x.gl.UNSIGNED_BYTE,"uint8"),y()(o,x.gl.UNSIGNED_SHORT,"uint16"),y()(o,x.gl.UNSIGNED_INT,"uint32"),y()(o,x.gl.FLOAT,"float"),o),j=(a={},y()(a,x.gl.ALPHA,"alpha"),y()(a,x.gl.LUMINANCE,"luminance"),y()(a,x.gl.LUMINANCE_ALPHA,"luminance alpha"),y()(a,x.gl.RGB,"rgb"),y()(a,x.gl.RGBA,"rgba"),y()(a,x.gl.RGBA4,"rgba4"),y()(a,x.gl.RGB5_A1,"rgb5 a1"),y()(a,x.gl.RGB565,"rgb565"),y()(a,x.gl.DEPTH_COMPONENT,"depth"),y()(a,x.gl.DEPTH_STENCIL,"depth stencil"),a),D=(c={},y()(c,x.gl.DONT_CARE,"dont care"),y()(c,x.gl.NICEST,"nice"),y()(c,x.gl.FASTEST,"fast"),c),F=(s={},y()(s,x.gl.NEAREST,"nearest"),y()(s,x.gl.LINEAR,"linear"),y()(s,x.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),y()(s,x.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),y()(s,x.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),y()(s,x.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),s),B=(u={},y()(u,x.gl.REPEAT,"repeat"),y()(u,x.gl.CLAMP_TO_EDGE,"clamp"),y()(u,x.gl.MIRRORED_REPEAT,"mirror"),u),U=(l={},y()(l,x.gl.NONE,"none"),y()(l,x.gl.BROWSER_DEFAULT_WEBGL,"browser"),l),z=(f={},y()(f,x.gl.NEVER,"never"),y()(f,x.gl.ALWAYS,"always"),y()(f,x.gl.LESS,"less"),y()(f,x.gl.LEQUAL,"lequal"),y()(f,x.gl.GREATER,"greater"),y()(f,x.gl.GEQUAL,"gequal"),y()(f,x.gl.EQUAL,"equal"),y()(f,x.gl.NOTEQUAL,"notequal"),f),G=(p={},y()(p,x.gl.FUNC_ADD,"add"),y()(p,x.gl.MIN_EXT,"min"),y()(p,x.gl.MAX_EXT,"max"),y()(p,x.gl.FUNC_SUBTRACT,"subtract"),y()(p,x.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),p),V=(d={},y()(d,x.gl.ZERO,"zero"),y()(d,x.gl.ONE,"one"),y()(d,x.gl.SRC_COLOR,"src color"),y()(d,x.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),y()(d,x.gl.SRC_ALPHA,"src alpha"),y()(d,x.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),y()(d,x.gl.DST_COLOR,"dst color"),y()(d,x.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),y()(d,x.gl.DST_ALPHA,"dst alpha"),y()(d,x.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),y()(d,x.gl.CONSTANT_COLOR,"constant color"),y()(d,x.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),y()(d,x.gl.CONSTANT_ALPHA,"constant alpha"),y()(d,x.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),y()(d,x.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),d),H=(h={},y()(h,x.gl.NEVER,"never"),y()(h,x.gl.ALWAYS,"always"),y()(h,x.gl.LESS,"less"),y()(h,x.gl.LEQUAL,"lequal"),y()(h,x.gl.GREATER,"greater"),y()(h,x.gl.GEQUAL,"gequal"),y()(h,x.gl.EQUAL,"equal"),y()(h,x.gl.NOTEQUAL,"notequal"),h),X=(v={},y()(v,x.gl.ZERO,"zero"),y()(v,x.gl.KEEP,"keep"),y()(v,x.gl.REPLACE,"replace"),y()(v,x.gl.INVERT,"invert"),y()(v,x.gl.INCR,"increment"),y()(v,x.gl.DECR,"decrement"),y()(v,x.gl.INCR_WRAP,"increment wrap"),y()(v,x.gl.DECR_WRAP,"decrement wrap"),v),W=(g={},y()(g,x.gl.FRONT,"front"),y()(g,x.gl.BACK,"back"),g),Y=function(){function e(t,n){_()(this,e),this.buffer=void 0,this.buffer=t.buffer({data:n.data,usage:N[n.usage||x.gl.STATIC_DRAW],type:L[n.type||x.gl.UNSIGNED_BYTE]})}return S()(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(e){this.buffer.subdata(e.data,e.offset)}}]),e}(),Z=function(){function e(t,n){_()(this,e),this.elements=void 0,this.elements=t.elements({data:n.data,usage:N[n.usage||x.gl.STATIC_DRAW],type:L[n.type||x.gl.UNSIGNED_BYTE],count:n.count})}return S()(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){this.elements.subdata(e.data)}},{key:"destroy",value:function(){}}]),e}(),q=function(){function e(t,n){_()(this,e),this.framebuffer=void 0;var r=n.color,i=n.colors,o={width:n.width,height:n.height};Array.isArray(i)&&(o.colors=i.map(function(e){return e.get()})),r&&"boolean"!=typeof r&&(o.color=r.get()),this.framebuffer=t.framebuffer(o)}return S()(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){this.framebuffer.resize(e.width,e.height)}}]),e}(),K=n("cDf5"),Q=n.n(K),J=n("c6wG"),$=n.n(J),ee=n("YO3V"),te=n.n(ee);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach(function(t){y()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ie,oe=function(){function e(t,n){_()(this,e),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=t;var r=n.vs,i=n.fs,o=n.attributes,a=n.uniforms,c=n.primitive,s=n.count,u=n.elements,l=n.depth,f=n.blend,p=n.stencil,d=n.cull,h=n.instances,v={};this.options=n,a&&(this.uniforms=this.extractUniforms(a),Object.keys(a).forEach(function(e){v[e]=t.prop(e)}));var g={};Object.keys(o).forEach(function(e){g[e]=o[e].get()});var m={attributes:g,frag:i,uniforms:v,vert:r,primitive:M[void 0===c?x.gl.TRIANGLES:c]};h&&(m.instances=h),s&&(m.count=s),u&&(m.elements=u.get()),this.initDepthDrawParams({depth:l},m),this.initBlendDrawParams({blend:f},m),this.initStencilDrawParams({stencil:p},m),this.initCullDrawParams({cull:d},m),this.drawCommand=t(m),this.drawParams=m}return S()(e,[{key:"addUniforms",value:function(e){this.uniforms=re(re({},this.uniforms),this.extractUniforms(e))}},{key:"draw",value:function(e){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var t=re(re({},this.uniforms),this.extractUniforms(e.uniforms||{})),n={};Object.keys(t).forEach(function(e){var r=Q()(t[e]);n[e]="boolean"===r||"number"===r||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?t[e]:t[e].get()}),this.drawCommand(n)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(e){e.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:z[n.func||x.gl.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var r=n.func,i=n.equation,o=n.color;t.blend={enable:!!n.enable,func:{srcRGB:V[r&&r.srcRGB||x.gl.SRC_ALPHA],srcAlpha:V[r&&r.srcAlpha||x.gl.SRC_ALPHA],dstRGB:V[r&&r.dstRGB||x.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:V[r&&r.dstAlpha||x.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:G[i&&i.rgb||x.gl.FUNC_ADD],alpha:G[i&&i.alpha||x.gl.FUNC_ADD]},color:void 0===o?[0,0,0,0]:o}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var r=n.mask,i=n.func,o=void 0===i?{cmp:x.gl.ALWAYS,ref:0,mask:-1}:i,a=n.opFront,c=void 0===a?{fail:x.gl.KEEP,zfail:x.gl.KEEP,zpass:x.gl.KEEP}:a,s=n.opBack,u=void 0===s?{fail:x.gl.KEEP,zfail:x.gl.KEEP,zpass:x.gl.KEEP}:s;t.stencil={enable:!!n.enable,mask:void 0===r?-1:r,func:re(re({},o),{},{cmp:H[o.cmp]}),opFront:{fail:X[c.fail],zfail:X[c.zfail],zpass:X[c.zpass]},opBack:{fail:X[u.fail],zfail:X[u.zfail],zpass:X[u.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var r=n.face;t.cull={enable:!!n.enable,face:W[void 0===r?x.gl.BACK:r]}}}},{key:"extractUniforms",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){t.extractUniformsRecursively(r,e[r],n,"")}),n}},{key:"extractUniformsRecursively",value:function(e,t,n,r){var i=this;null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||$()(t)||""===t||"resize"in t?n["".concat(r&&r+".").concat(e)]=t:(te()(t)&&Object.keys(t).forEach(function(o){i.extractUniformsRecursively(o,t[o],n,"".concat(r&&r+".").concat(e))}),Array.isArray(t)&&t.forEach(function(t,o){Object.keys(t).forEach(function(a){i.extractUniformsRecursively(a,t[a],n,"".concat(r&&r+".").concat(e,"[").concat(o,"]"))})}))}}]),e}(),ae=function(){function e(t,n){_()(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,o=void 0===i?x.gl.UNSIGNED_BYTE:i,a=n.width,c=n.height,s=n.flipY,u=void 0!==s&&s,l=n.format,f=void 0===l?x.gl.RGBA:l,p=n.mipmap,d=void 0!==p&&p,h=n.wrapS,v=void 0===h?x.gl.CLAMP_TO_EDGE:h,g=n.wrapT,m=void 0===g?x.gl.CLAMP_TO_EDGE:g,y=n.aniso,b=void 0===y?0:y,E=n.alignment,S=void 0===E?1:E,T=n.premultiplyAlpha,A=void 0!==T&&T,O=n.mag,w=void 0===O?x.gl.NEAREST:O,k=n.min,I=void 0===k?x.gl.NEAREST:k,P=n.colorSpace,C=void 0===P?x.gl.BROWSER_DEFAULT_WEBGL:P;this.width=a,this.height=c;var R={width:a,height:c,type:L[o],format:j[f],wrapS:B[v],wrapT:B[m],mag:F[w],min:F[I],alignment:S,flipY:u,colorSpace:U[C],premultiplyAlpha:A,aniso:b};r&&(R.data=r),"number"==typeof d?R.mipmap=D[d]:"boolean"==typeof d&&(R.mipmap=d),this.texture=t.texture(R)}return S()(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture(e)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),ce=Object(I.injectable)()(ie=function(){function e(){var t=this;_()(this,e),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(e){return new oe(t.gl,e)},this.createAttribute=function(e){return new R(t.gl,e)},this.createBuffer=function(e){return new Y(t.gl,e)},this.createElements=function(e){return new Z(t.gl,e)},this.createTexture2D=function(e){return new ae(t.gl,e)},this.createFramebuffer=function(e){return new q(t.gl,e)},this.useFramebuffer=function(e,n){t.gl({framebuffer:e?e.get():null})(n)},this.clear=function(e){var n=e.framebuffer,r=void 0===n?null:n,i={color:e.color,depth:e.depth,stencil:e.stencil};i.framebuffer=null===r?r:r.get(),t.gl.clear(i)},this.viewport=function(e){var n=e.width,r=e.height;t.gl._gl.viewport(e.x,e.y,n,r),t.width=n,t.height=r,t.gl._refresh()},this.readPixels=function(e){var n=e.framebuffer,r={x:e.x,y:e.y,width:e.width,height:e.height};return n&&(r.framebuffer=n.get()),t.gl.read(r)},this.getViewportSize=function(){return{width:t.gl._gl.drawingBufferWidth,height:t.gl._gl.drawingBufferHeight}},this.getContainer=function(){var e;return null===(e=t.canvas)||void 0===e?void 0:e.parentElement},this.getCanvas=function(){return t.canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl.destroy()}}var t;return S()(e,[{key:"init",value:(t=k()(O.a.mark(function e(t,n){var r=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.canvas=t,e.next=3,new Promise(function(e,t){C()({canvas:r.canvas,attributes:{alpha:!0,antialias:n.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:n.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(n,r){!n&&r||t(n),e(r)}})});case 3:this.gl=e.sent;case 4:case"end":return e.stop()}},e,this)})),function(e,n){return t.apply(this,arguments)})},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var e=this.getGLContext();e.disable(e.CULL_FACE)}},{key:"setDirty",value:function(e){this.isDirty=e}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||ie,se=n("Hel2");function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach(function(t){y()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var fe=function(){function e(t){_()(this,e),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var n=t.id,r=t.map,i=Object(x.createSceneContainer)();this.container=i,r.setContainer(i,n),i.bind(x.TYPES.IRendererService).to(ce).inSingletonScope(),this.sceneService=i.get(x.TYPES.ISceneService),this.mapService=i.get(x.TYPES.IMapService),this.iconService=i.get(x.TYPES.IIconService),this.fontService=i.get(x.TYPES.IFontService),this.controlService=i.get(x.TYPES.IControlService),this.layerService=i.get(x.TYPES.ILayerService),this.markerService=i.get(x.TYPES.IMarkerService),this.interactionService=i.get(x.TYPES.IInteractionService),this.popupService=i.get(x.TYPES.IPopupService),this.initComponent(n),this.sceneService.init(t),this.initControl()}return S()(e,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(e){return this.sceneService.exportPng(e)}},{key:"exportMap",value:function(e){return this.sceneService.exportPng(e)}},{key:"registerRenderService",value:function(e){var t=this;this.sceneService.loaded?new e(this).init():this.on("loaded",function(){new e(t).init()})}},{key:"addLayer",value:function(e){var t=Object(x.createLayerContainer)(this.container);e.setContainer(t),this.sceneService.addLayer(e)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(e){return this.layerService.getLayer(e)}},{key:"getLayerByName",value:function(e){return this.layerService.getLayerByName(e)}},{key:"removeLayer",value:function(e){this.layerService.remove(e)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(e,t){this.iconService.addImage(e,t)}},{key:"hasImage",value:function(e){return this.iconService.hasImage(e)}},{key:"removeImage",value:function(e){this.iconService.removeImage(e)}},{key:"addIconFontGlyphs",value:function(e,t){this.fontService.addIconGlyphs(t)}},{key:"addControl",value:function(e){this.controlService.addControl(e,this.container)}},{key:"removeControl",value:function(e){this.controlService.removeControl(e)}},{key:"getControlByName",value:function(e){return this.controlService.getControlByName(e)}},{key:"addMarker",value:function(e){this.markerService.addMarker(e)}},{key:"addMarkerLayer",value:function(e){this.markerService.addMarkerLayer(e)}},{key:"removeMarkerLayer",value:function(e){this.markerService.removeMarkerLayer(e)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(e){this.popupService.addPopup(e)}},{key:"on",value:function(e,t){-1===x.SceneEventList.indexOf(e)?this.mapService.on(e,t):this.sceneService.on(e,t)}},{key:"off",value:function(e,t){-1===x.SceneEventList.indexOf(e)?this.mapService.off(e,t):this.sceneService.off(e,t)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(e){return this.mapService.setCenter(e)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(e){return this.mapService.setPitch(e)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(e){this.mapService.setRotation(e)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(e){this.mapService.panTo(e)}},{key:"panBy",value:function(e){this.mapService.panBy(e)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(e){this.mapService.setZoom(e)}},{key:"fitBounds",value:function(e,t){var n=this.sceneService.getSceneConfig(),r=n.animate;this.mapService.fitBounds(e,t||le(le({},n.fitBoundsOptions),{},{animate:r}))}},{key:"setZoomAndCenter",value:function(e,t){this.mapService.setZoomAndCenter(e,t)}},{key:"setMapStyle",value:function(e){this.mapService.setMapStyle(e)}},{key:"setMapStatus",value:function(e){this.mapService.setMapStatus(e)}},{key:"pixelToLngLat",value:function(e){return this.mapService.pixelToLngLat(e)}},{key:"lngLatToPixel",value:function(e){return this.mapService.lngLatToPixel(e)}},{key:"containerToLngLat",value:function(e){return this.mapService.containerToLngLat(e)}},{key:"lngLatToContainer",value:function(e){return this.mapService.lngLatToContainer(e)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(e,t){this.container.bind(x.TYPES.IPostProcessingPass).to(e).whenTargetNamed(t)}},{key:"initComponent",value:function(e){this.controlService.init({container:se.a.getContainer(e)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var e=this.sceneService.getSceneConfig();e.logoVisible&&this.addControl(new T.a({position:e.logoPosition}))}},{key:"map",get:function(){return this.mapService.map}}]),e}()},kekF:function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},lSCD:function(e,t,n){var r=n("NykK"),i=n("GoyQ");e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},lSNA:function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},ljhN:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},ls82:function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(C){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=Object.create((t&&t.prototype instanceof g?t:g).prototype),o=new k(r||[]);return i._invoke=function(e,t,n){var r=f;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=A(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?h:p,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=h,n.method="throw",n.arg=s.arg)}}}(e,n,o),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=u;var f="suspendedStart",p="suspendedYield",d="executing",h="completed",v={};function g(){}function m(){}function y(){}var b={};b[o]=function(){return this};var _=Object.getPrototypeOf,E=_&&_(_(I([])));E&&E!==n&&r.call(E,o)&&(b=E);var S=y.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function x(e,t){function n(i,o,a,c){var s=l(e[i],e,o);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then(function(e){n("next",e,a,c)},function(e){n("throw",e,a,c)}):t.resolve(f).then(function(e){u.value=e,a(u)},function(e){return n("throw",e,a,c)})}c(s.arg)}var i;this._invoke=function(e,r){function o(){return new t(function(t,i){n(e,r,t,i)})}return i=i?i.then(o,o):o()}}function A(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function I(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return m.prototype=S.constructor=y,y.constructor=m,m.displayName=s(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},T(x.prototype),x.prototype[a]=function(){return this},e.AsyncIterator=x,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new x(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},T(S),s(S,c,"Generator"),S[o]=function(){return this},S.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return c.type="throw",c.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},lwsE:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},m0LI:function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}},mNvP:function(e,t){var n;!function(e){!function(t){var n="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=i(e);function i(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===n.Reflect?n.Reflect=e:r=i(n.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,c=!o&&!a,s={create:o?function(){return N(Object.create(null))}:a?function(){return N({__proto__:null})}:function(){return N({})},has:c?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:c?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}():Map,p=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}():Set,d=new(l||"function"!=typeof WeakMap?function(){var e=s.create(),n=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&s.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?s.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var t;do{t="@@WeakMap@@"+a()}while(s.has(e,t));return e[t]=!0,t}function i(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:s.create()})}return e[n]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<16;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function h(e,t,n){var r=d.get(e);if(T(r)){if(!n)return;r=new f,d.set(e,r)}var i=r.get(t);if(T(i)){if(!n)return;i=new f,r.set(t,i)}return i}function v(e,t,n){if(g(e,t,n))return!0;var r=M(t);return!x(r)&&v(e,r,n)}function g(e,t,n){var r=h(t,n,!1);return!T(r)&&!!r.has(e)}function m(e,t,n){if(g(e,t,n))return y(e,t,n);var r=M(t);return x(r)?void 0:m(e,r,n)}function y(e,t,n){var r=h(t,n,!1);if(!T(r))return r.get(e)}function b(e,t,n,r){h(n,r,!0).set(e,t)}function _(e,t){var n=E(e,t),r=M(e);if(null===r)return n;var i=_(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new p,a=[],c=0,s=n;c<s.length;c++)o.has(f=s[c])||(o.add(f),a.push(f));for(var u=0,l=i;u<l.length;u++){var f;o.has(f=l[u])||(o.add(f),a.push(f))}return a}function E(e,t){var n=[],r=h(e,t,!1);if(T(r))return n;for(var o=function(e){var t=P(e,i);if(!k(t))throw new TypeError;var n=t.call(e);if(!A(n))throw new TypeError;return n}(r.keys()),a=0;;){var c=C(o);if(!c)return n.length=a,n;var s=c.value;try{n[a]=s}catch(u){try{R(o)}finally{throw u}}a++}}function S(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function T(e){return void 0===e}function x(e){return null===e}function A(e){return"object"==typeof e?null!==e:"function"==typeof e}function O(e){var t=function(e,t){switch(S(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=P(e,r);if(void 0!==i){var o=i.call(e,n);if(A(o))throw new TypeError;return o}return function(e,t){if("string"===t){var n=e.toString;if(k(n)&&!A(i=n.call(e)))return i;if(k(r=e.valueOf)&&!A(i=r.call(e)))return i}else{var r;if(k(r=e.valueOf)&&!A(i=r.call(e)))return i;var i,o=e.toString;if(k(o)&&!A(i=o.call(e)))return i}throw new TypeError}(e,"default"===n?"number":n)}(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function w(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function k(e){return"function"==typeof e}function I(e){return"function"==typeof e}function P(e,t){var n=e[t];if(null!=n){if(!k(n))throw new TypeError;return n}}function C(e){var t=e.next();return!t.done&&t}function R(e){var t=e.return;t&&t.call(e)}function M(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function N(e){return e.__=void 0,delete e.__,e}e("decorate",function(e,t,n,r){if(T(n)){if(!w(e))throw new TypeError;if(!I(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!T(r)&&!x(r)){if(!I(r))throw new TypeError;t=r}}return t}(e,t)}if(!w(e))throw new TypeError;if(!A(t))throw new TypeError;if(!A(r)&&!T(r)&&!x(r))throw new TypeError;return x(r)&&(r=void 0),function(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!T(o)&&!x(o)){if(!A(o))throw new TypeError;r=o}}return r}(e,t,n=O(n),r)}),e("metadata",function(e,t){return function(n,r){if(!A(n))throw new TypeError;if(!T(r)&&!function(e){switch(S(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;b(e,t,n,r)}}),e("defineMetadata",function(e,t,n,r){if(!A(n))throw new TypeError;return T(r)||(r=O(r)),b(e,t,n,r)}),e("hasMetadata",function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=O(n)),v(e,t,n)}),e("hasOwnMetadata",function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=O(n)),g(e,t,n)}),e("getMetadata",function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=O(n)),m(e,t,n)}),e("getOwnMetadata",function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=O(n)),y(e,t,n)}),e("getMetadataKeys",function(e,t){if(!A(e))throw new TypeError;return T(t)||(t=O(t)),_(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!A(e))throw new TypeError;return T(t)||(t=O(t)),E(e,t)}),e("deleteMetadata",function(e,t,n){if(!A(t))throw new TypeError;T(n)||(n=O(n));var r=h(t,n,!1);if(T(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=d.get(t);return i.delete(n),i.size>0||d.delete(t),!0})}(r)}()}(n||(n={}))},mTTR:function(e,t,n){var r=n("b80T"),i=n("QcOe"),o=n("MMmD");e.exports=function(e){return o(e)?r(e,!0):i(e)}},mc0g:function(e,t){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),c=a.length;c--;){var s=a[e?c:++i];if(!1===n(o[s],s,o))break}return t}}},mdPL:function(e,t,n){(function(e){var r=n("WFqU"),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,c=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=c}).call(this,n("YuTi")(e))},mpbz:function(e,t,n){e.exports=function(){"use strict";function e(n,r,i,o,a,c){if(!(a-o<=i)){var s=o+a>>1;t(n,r,s,o,a,c%2),e(n,r,i,o,s-1,c+1),e(n,r,i,s+1,a,c+1)}}function t(e,r,i,o,a,c){for(;a>o;){if(a-o>600){var s=a-o+1,u=i-o+1,l=Math.log(s),f=.5*Math.exp(2*l/3),p=.5*Math.sqrt(l*f*(s-f)/s)*(u-s/2<0?-1:1);t(e,r,i,Math.max(o,Math.floor(i-u*f/s+p)),Math.min(a,Math.floor(i+(s-u)*f/s+p)),c)}var d=r[2*i+c],h=o,v=a;for(n(e,r,o,i),r[2*a+c]>d&&n(e,r,o,a);h<v;){for(n(e,r,h,v),h++,v--;r[2*h+c]<d;)h++;for(;r[2*v+c]>d;)v--}r[2*o+c]===d?n(e,r,o,v):n(e,r,++v,a),v<=i&&(o=v+1),i<=v&&(a=v-1)}}function n(e,t,n,i){r(e,n,i),r(t,2*n,2*i),r(t,2*n+1,2*i+1)}function r(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function i(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}var o=function(e){return e[0]},a=function(e){return e[1]},c=function(t,n,r,i,c){void 0===n&&(n=o),void 0===r&&(r=a),void 0===i&&(i=64),void 0===c&&(c=Float64Array),this.nodeSize=i,this.points=t;for(var s=t.length<65536?Uint16Array:Uint32Array,u=this.ids=new s(t.length),l=this.coords=new c(2*t.length),f=0;f<t.length;f++)u[f]=f,l[2*f]=n(t[f]),l[2*f+1]=r(t[f]);e(u,l,i,0,u.length-1,0)};c.prototype.range=function(e,t,n,r){return function(e,t,n,r,i,o,a){for(var c,s,u=[0,e.length-1,0],l=[];u.length;){var f=u.pop(),p=u.pop(),d=u.pop();if(p-d<=a)for(var h=d;h<=p;h++)s=t[2*h+1],(c=t[2*h])>=n&&c<=i&&s>=r&&s<=o&&l.push(e[h]);else{var v=Math.floor((d+p)/2);s=t[2*v+1],(c=t[2*v])>=n&&c<=i&&s>=r&&s<=o&&l.push(e[v]);var g=(f+1)%2;(0===f?n<=c:r<=s)&&(u.push(d),u.push(v-1),u.push(g)),(0===f?i>=c:o>=s)&&(u.push(v+1),u.push(p),u.push(g))}}return l}(this.ids,this.coords,e,t,n,r,this.nodeSize)},c.prototype.within=function(e,t,n){return function(e,t,n,r,o,a){for(var c=[0,e.length-1,0],s=[],u=o*o;c.length;){var l=c.pop(),f=c.pop(),p=c.pop();if(f-p<=a)for(var d=p;d<=f;d++)i(t[2*d],t[2*d+1],n,r)<=u&&s.push(e[d]);else{var h=Math.floor((p+f)/2),v=t[2*h],g=t[2*h+1];i(v,g,n,r)<=u&&s.push(e[h]);var m=(l+1)%2;(0===l?n-o<=v:r-o<=g)&&(c.push(p),c.push(h-1),c.push(m)),(0===l?n+o>=v:r+o>=g)&&(c.push(h+1),c.push(f),c.push(m))}}return s}(this.ids,this.coords,e,t,n,this.nodeSize)};var s,u={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},l=Math.fround||(s=new Float32Array(1),function(e){return s[0]=+e,s[0]}),f=function(e){this.options=y(Object.create(u),e),this.trees=new Array(this.options.maxZoom+1)};function p(e,t,n,r,i){return{x:l(e),y:l(t),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function d(e,t){var n=e.geometry.coordinates,r=n[1];return{x:l(g(n[0])),y:l(m(r)),zoom:1/0,index:t,parentId:-1}}function h(e){return{type:"Feature",id:e.id,properties:v(e),geometry:{type:"Point",coordinates:[(r=e.x,360*(r-.5)),(t=e.y,n=(180-360*t)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var t,n,r}function v(e){var t=e.numPoints,n=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return y(y({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:n})}function g(e){return e/360+.5}function m(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function y(e,t){for(var n in t)e[n]=t[n];return e}function b(e){return e.x}function _(e){return e.y}return f.prototype.load=function(e){var t=this.options,n=t.log,r=t.minZoom,i=t.maxZoom,o=t.nodeSize;n&&console.time("total time");var a="prepare "+e.length+" points";n&&console.time(a),this.points=e;for(var s=[],u=0;u<e.length;u++)e[u].geometry&&s.push(d(e[u],u));this.trees[i+1]=new c(s,b,_,o,Float32Array),n&&console.timeEnd(a);for(var l=i;l>=r;l--){var f=+Date.now();s=this._cluster(s,l),this.trees[l]=new c(s,b,_,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",l,s.length,+Date.now()-f)}return n&&console.timeEnd("total time"),this},f.prototype.getClusters=function(e,t){var n=((e[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],t),c=this.getClusters([-180,r,i,o],t);return a.concat(c)}for(var s=this.trees[this._limitZoom(t)],u=[],l=0,f=s.range(g(n),m(o),g(i),m(r));l<f.length;l+=1){var p=s.points[f[l]];u.push(p.numPoints?h(p):this.points[p.index])}return u},f.prototype.getChildren=function(e){var t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[t];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),c=[],s=0,u=i.within(o.x,o.y,a);s<u.length;s+=1){var l=i.points[u[s]];l.parentId===e&&c.push(l.numPoints?h(l):this.points[l.index])}if(0===c.length)throw new Error(r);return c},f.prototype.getLeaves=function(e,t,n){var r=[];return this._appendLeaves(r,e,t=t||10,n=n||0,0),r},f.prototype.getTile=function(e,t,n){var r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),o=this.options,a=o.radius/o.extent,c=(n-a)/i,s=(n+1+a)/i,u={features:[]};return this._addTileFeatures(r.range((t-a)/i,c,(t+1+a)/i,s),r.points,t,n,i,u),0===t&&this._addTileFeatures(r.range(1-a/i,c,1,s),r.points,i,n,i,u),t===i-1&&this._addTileFeatures(r.range(0,c,a/i,s),r.points,-1,n,i,u),u.features.length?u:null},f.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t},f.prototype._appendLeaves=function(e,t,n,r,i){for(var o=0,a=this.getChildren(t);o<a.length;o+=1){var c=a[o],s=c.properties;if(s&&s.cluster?i+s.point_count<=r?i+=s.point_count:i=this._appendLeaves(e,s.cluster_id,n,r,i):i<r?i++:e.push(c),e.length===n)break}return i},f.prototype._addTileFeatures=function(e,t,n,r,i,o){for(var a=0,c=e;a<c.length;a+=1){var s=t[c[a]],u=s.numPoints,l={type:1,geometry:[[Math.round(this.options.extent*(s.x*i-n)),Math.round(this.options.extent*(s.y*i-r))]],tags:u?v(s):this.points[s.index].properties},f=void 0;u?f=s.id:this.options.generateId?f=s.index:this.points[s.index].id&&(f=this.points[s.index].id),void 0!==f&&(l.id=f),o.features.push(l)}},f.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))},f.prototype._cluster=function(e,t){for(var n=[],r=this.options,i=r.reduce,o=r.minPoints,a=r.radius/(r.extent*Math.pow(2,t)),c=0;c<e.length;c++){var s=e[c];if(!(s.zoom<=t)){s.zoom=t;for(var u=this.trees[t+1],l=u.within(s.x,s.y,a),f=s.numPoints||1,d=f,h=0,v=l;h<v.length;h+=1){var g=u.points[v[h]];g.zoom>t&&(d+=g.numPoints||1)}if(d>=o){for(var m=s.x*f,y=s.y*f,b=i&&f>1?this._map(s,!0):null,_=(c<<5)+(t+1)+this.points.length,E=0,S=l;E<S.length;E+=1){var T=u.points[S[E]];if(!(T.zoom<=t)){T.zoom=t;var x=T.numPoints||1;m+=T.x*x,y+=T.y*x,T.parentId=_,i&&(b||(b=this._map(s,!0)),i(b,this._map(T)))}}s.parentId=_,n.push(p(m/d,y/d,_,d,b))}else if(n.push(s),d>1)for(var A=0,O=l;A<O.length;A+=1){var w=u.points[O[A]];w.zoom<=t||(w.zoom=t,n.push(w))}}}return n},f.prototype._getOriginId=function(e){return e-this.points.length>>5},f.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},f.prototype._map=function(e,t){if(e.numPoints)return t?y({},e.properties):e.properties;var n=this.points[e.index].properties,r=this.options.map(n);return t&&r===n?y({},r):r},f}()},"mv/X":function(e,t,n){var r=n("ljhN"),i=n("MMmD"),o=n("wJg7"),a=n("GoyQ");e.exports=function(e,t,n){if(!a(n))return!1;var c=typeof t;return!!("number"==c?i(n)&&o(t,n.length):"string"==c&&t in n)&&r(n[t],e)}},n2J3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unmanaged=void 0;var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");t.unmanaged=function(){return function(e,t,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(e,t,n,a)}}},n3AX:function(e,t,n){var r=n("Nsbk");e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},nmnc:function(e,t,n){var r=n("Kz5y");e.exports=r.Symbol},"o+pz":function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"}(r||(r={}))},o0o1:function(e,t,n){e.exports=n("ls82")},oShl:function(e,t,n){var r=n("Nsbk"),i=n("SksO"),o=n("xfeJ"),a=n("sXyB");function c(t){var n="function"==typeof Map?new Map:void 0;return e.exports=c=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},c(t)}e.exports=c},oaX6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.targetName=void 0;var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");t.targetName=function(e){return function(t,n,a){var c=new i.Metadata(r.NAME_TAG,e);o.tagParameter(t,n,a,c)}}},"oy+k":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var r=n("d9O0"),i=function(){function e(e){this.id=r.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=i},pFRH:function(e,t,n){var r=n("cvCv"),i=n("O0oS"),o=n("zZ0H");e.exports=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o},pSRY:function(e,t,n){var r=n("QkVE");e.exports=function(e){return r(this,e).has(e)}},qK8v:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStackOverflowExeption=void 0;var r=n("MON2");t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===r.STACK_OVERFLOW}},qRkn:function(e,t,n){var r=n("3cYt")({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"});e.exports=r},quyA:function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},rEGp:function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},riiI:function(e,t){},rxlC:function(e,t,n){"use strict";e.exports=i,e.exports.default=i;var r=1e20;function i(e,t,n,r,i,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer,c=a+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(c*c),this.gridInner=new Float64Array(c*c),this.f=new Float64Array(c),this.z=new Float64Array(c+1),this.v=new Uint16Array(c),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(e,t,n,r,i,o){for(var c=0;c<t;c++)a(e,c,t,n,r,i,o);for(var s=0;s<n;s++)a(e,s*t,1,t,r,i,o)}function a(e,t,n,i,o,a,c){var s,u,l,f;for(a[0]=0,c[0]=-r,c[1]=r,s=0;s<i;s++)o[s]=e[t+s*n];for(s=1,u=0,l=0;s<i;s++){do{l=(o[s]-o[f=a[u]]+s*s-f*f)/(s-f)/2}while(l<=c[u]&&--u>-1);a[++u]=s,c[u]=l,c[u+1]=r}for(s=0,u=0;s<i;s++){for(;c[u+1]<s;)u++;e[t+s*n]=o[f=a[u]]+(s-f)*(s-f)}}i.prototype._draw=function(e,t){var n,i,a,c,s,u,l,f,p=this.ctx.measureText(e),d=p.width,h=2*this.buffer;t&&void 0!==p.actualBoundingBoxLeft?(s=Math.floor(p.actualBoundingBoxAscent)-this.middle,u=Math.max(0,this.middle-Math.ceil(p.actualBoundingBoxAscent)),l=this.buffer,n=(i=Math.min(this.size,Math.ceil(p.actualBoundingBoxRight-p.actualBoundingBoxLeft)))+h,a=(c=Math.min(this.size-u,Math.ceil(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent)))+h):(n=i=this.size,a=c=this.size,s=0,u=l=0),i&&c&&(this.ctx.clearRect(l,u,i,c),this.ctx.fillText(e,this.buffer,this.middle),f=this.ctx.getImageData(l,u,i,c));var v=new Uint8ClampedArray(n*a);return function(e,t,n,i,o,a,c){a.fill(r,0,t*n),c.fill(0,0,t*n);for(var s=(t-i)/2,u=0;u<o;u++)for(var l=0;l<i;l++){var f=(u+s)*t+l+s,p=e.data[4*(u*i+l)+3]/255;if(1===p)a[f]=0,c[f]=r;else if(0===p)a[f]=r,c[f]=0;else{var d=Math.max(0,.5-p),h=Math.max(0,p-.5);a[f]=d*d,c[f]=h*h}}}(f,n,a,i,c,this.gridOuter,this.gridInner),o(this.gridOuter,n,a,this.f,this.v,this.z),o(this.gridInner,n,a,this.f,this.v,this.z),function(e,t,n,r,i,o,a){for(var c=0;c<t*n;c++){var s=Math.sqrt(r[c])-Math.sqrt(i[c]);e[c]=Math.round(255-255*(s/o+a))}}(v,n,a,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:v,metrics:{width:i,height:c,sdfWidth:n,sdfHeight:a,top:s,left:0,advance:d,fontAscent:p.fontBoundingBoxAscent}}},i.prototype.draw=function(e){return this._draw(e,!1).data},i.prototype.drawWithMetrics=function(e){return this._draw(e,!0)}},sEf8:function(e,t){e.exports=function(e){return function(t){return e(t)}}},sXyB:function(e,t,n){var r=n("SksO"),i=n("b48C");function o(t,n,a){return e.exports=o=i()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}e.exports=o},sgoq:function(e,t,n){var r=n("asDA"),i=n("TKrE"),o=n("6nK8"),a=RegExp("['\u2019]","g");e.exports=function(e){return function(t){return r(o(i(t).replace(a,"")),e,"")}}},shjB:function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},t2Dn:function(e,t,n){var r=n("hypo"),i=n("ljhN");e.exports=function(e,t,n){(void 0!==n&&!i(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},tLB3:function(e,t,n){var r=n("GoyQ"),i=n("/9aa"),o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,s=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=c.test(e);return n||s.test(e)?u(e.slice(2),n?2:8):a.test(e)?NaN:+e}},tMB7:function(e,t,n){var r=n("y1pI");e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},u6S6:function(e,t,n){var r=n("6acW"),i=n("sgoq")(function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t)});e.exports=i},u8Dt:function(e,t,n){var r=n("YESw"),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},uhBA:function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function c(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var c=new a(n,r||e,o),s=i?i+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],c]:e._events[s].push(c):(e._events[s]=c,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=this._events[i?i+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,r=t.length,o=new Array(r);n<r;n++)o[n]=t[n].fn;return o},u.prototype.listenerCount=function(e){var t=this._events[i?i+e:e];return t?t.fn?1:t.length:0},u.prototype.emit=function(e,t,n,r,o,a){var c=i?i+e:e;if(!this._events[c])return!1;var s,u,l=this._events[c],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(u=1,s=new Array(f-1);u<f;u++)s[u-1]=arguments[u];l.fn.apply(l.context,s)}else{var p,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!s)for(p=1,s=new Array(f-1);p<f;p++)s[p-1]=arguments[p];l[u].fn.apply(l[u].context,s)}}return!0},u.prototype.on=function(e,t,n){return c(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return c(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||s(this,o);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||r&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?this._events[t=i?i+e:e]&&s(this,t):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,e.exports=u},ujMp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.circularDependencyToException=t.listMetadataForTarget=t.listRegisteredBindingsForServiceIdentifier=t.getServiceIdentifierAsString=t.getFunctionName=void 0;var r=n("MON2");function i(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function o(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||o(e.parentRequest,t))}function a(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=i,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach(function(e){var t="Object";null!==e.implementationType&&(t=a(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)})),r},t.circularDependencyToException=function e(t){t.childRequests.forEach(function(t){if(o(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var r=i(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}e(t)})},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach(function(e){n+=e.toString()+"\n"})," "+e+"\n "+e+" - "+n}return" "+e},t.getFunctionName=a},"vN+2":function(e,t){e.exports=function(){}},vuIU:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",function(){return i})},wJg7:function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},wTVA:function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},wclG:function(e,t,n){var r=n("pFRH"),i=n("88Gu")(r);e.exports=i},wkBT:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},wnjb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataReader=void 0;var r=n("xfSm"),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(r.TAGGED_PROP,e)||[]},e}();t.MetadataReader=i},wy8a:function(e,t,n){var r=n("KxBF");e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n)}},xYSL:function(e,t){e.exports=function(e,t){return e.has(t)}},xfSm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.POST_CONSTRUCT=t.DESIGN_PARAM_TYPES=t.PARAM_TYPES=t.TAGGED_PROP=t.TAGGED=t.MULTI_INJECT_TAG=t.INJECT_TAG=t.OPTIONAL_TAG=t.UNMANAGED_TAG=t.NAME_TAG=t.NAMED_TAG=void 0,t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},xfeJ:function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},xiII:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;var r=n("d9O0"),i=function(){function e(e,t,n,i,o){this.id=r.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();t.Request=i},xp6e:function(e,t,n){"use strict";function r(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(c){i={error:c}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return e(t={exports:{}},t.exports),t.exports}n.d(t,"a",function(){return A});var a=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0},e.exports=t.default});i(a);var c=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=t.pop();return e.call(this,t,r)}},e.exports=t.default});i(c);var s=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fallback=o,t.wrap=a;var n,r=t.hasSetImmediate="function"==typeof setImmediate&&setImmediate,i=t.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function o(e){setTimeout(e,0)}function a(e){return function(t){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return e(function(){return t.apply(void 0,n)})}}n=r?setImmediate:i?process.nextTick:o,t.default=a(n)});i(s);var u=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,l.isAsync)(e)?function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=t.pop(),i=e.apply(this,t);return o(i,r)}:(0,n.default)(function(t,n){var r;try{r=e.apply(this,t)}catch(i){return n(i)}if(r&&"function"==typeof r.then)return o(r,n);n(null,r)})};var n=i(c),r=i(s);function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return e.then(function(e){a(t,null,e)},function(e){a(t,e&&e.message?e:new Error(e))})}function a(e,t,n){try{e(t,n)}catch(i){(0,r.default)(function(e){throw e},i)}}e.exports=t.default});i(u);var l=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=t.isAsyncGenerator=t.isAsync=void 0;var n,r=(n=u)&&n.__esModule?n:{default:n};function i(e){return"AsyncFunction"===e[Symbol.toStringTag]}t.default=function(e){if("function"!=typeof e)throw new Error("expected a function");return i(e)?(0,r.default)(e):e},t.isAsync=i,t.isAsyncGenerator=function(e){return"AsyncGenerator"===e[Symbol.toStringTag]},t.isAsyncIterable=function(e){return"function"==typeof e[Symbol.asyncIterator]}});i(l);var f=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===t&&(t=e.length),!t)throw new Error("arity is undefined");function n(){for(var n=this,r=[],i=arguments.length;i--;)r[i]=arguments[i];return"function"==typeof r[t-1]?e.apply(this,r):new Promise(function(i,o){r[t-1]=function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(e)return o(e);i(t.length>1?t:t[0])},e.apply(n,r)})}return Object.defineProperty(n,"name",{configurable:!0,value:"awaitable("+e.name+")"}),n},e.exports=t.default});i(f);var p=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(a),r=o(l),i=o(f);function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)(function(e,t,i){var o=(0,n.default)(t)?[]:{};e(t,function(e,t,n){(0,r.default)(e)(function(e){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];r.length<2&&(r=r[0]),o[t]=r,n(e)})},function(e){return i(e,o)})},3),e.exports=t.default});i(p);var d=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(null!==e){var r=e;e=null,r.apply(this,t)}}return Object.assign(t,e),t},e.exports=t.default});i(d);var h=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()},e.exports=t.default});i(h);var v=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,n.default)(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,i,o,a,c=(0,r.default)(e);return c?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(c):(i=(t=e)?Object.keys(t):[],o=-1,a=i.length,function(){var e=i[++o];return o<a?{value:t[e],key:e}:null})};var n=i(a),r=i(h);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default});i(v);var g=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(null===e)throw new Error("Callback was already called.");var r=e;e=null,r.apply(this,t)}},e.exports=t.default});i(g);var m=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default});i(m);var y=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){var o=!1,a=!1,c=!1,s=0,u=0;function l(){s>=t||c||o||(c=!0,e.next().then(function(e){var t=e.value;if(!a&&!o){if(c=!1,e.done)return o=!0,void(s<=0&&i(null));s++,n(t,u,f),u++,l()}}).catch(p))}function f(e,t){if(s-=1,!a)return e?p(e):!1===e?(o=!0,void(a=!0)):t===r.default||o&&s<=0?(o=!0,i(null)):void l()}function p(e){a||(c=!1,o=!0,i(e))}l()};var n,r=(n=m)&&n.__esModule?n:{default:n};e.exports=t.default});i(y);var b=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=c(d),r=c(v),i=c(g),o=c(y),a=c(m);function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(t,c,s){if(s=(0,n.default)(s),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return s(null);if((0,l.isAsyncGenerator)(t))return(0,o.default)(t,e,c,s);if((0,l.isAsyncIterable)(t))return(0,o.default)(t[Symbol.asyncIterator](),e,c,s);var u=(0,r.default)(t),f=!1,p=!1,d=0,h=!1;function v(e,t){if(!p)if(d-=1,e)f=!0,s(e);else if(!1===e)f=!0,p=!0;else{if(t===a.default||f&&d<=0)return f=!0,s(null);h||g()}}function g(){for(h=!0;d<e&&!f;){var t=u();if(null===t)return f=!0,void(d<=0&&s(null));d+=1,c(t.value,t.key,(0,i.default)(v))}h=!1}g()}},e.exports=t.default});i(b);var _=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(b),r=o(l),i=o(f);function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)(function(e,t,i,o){return(0,n.default)(t)(e,(0,r.default)(i),o)},4),e.exports=t.default});i(_);var E=o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(_),r=i(f);function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,r.default)(function(e,t,r){return(0,n.default)(e,1,t,r)},3),e.exports=t.default});i(E);var S=i(o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,n.default)(r.default,e,t)};var n=i(p),r=i(E);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default})),T=(function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.args=[],this.tasks=[]}e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return this.args=t,S(this.tasks)},e.prototype.tap=function(e,t){var n=this;this.tasks.push(function(i){t.apply(void 0,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e}(n.args)),i(null,e)})}}(),o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=p(a),r=p(m),i=p(_),o=p(d),c=p(g),s=p(l),u=p(f);function p(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n){n=(0,o.default)(n);var i=0,a=0,s=e.length,u=!1;function l(e,t){!1===e&&(u=!0),!0!==u&&(e?n(e):++a!==s&&t!==r.default||n(null))}for(0===s&&n(null);i<s;i++)t(e[i],i,(0,c.default)(l))}function v(e,t,n){return(0,i.default)(e,1/0,t,n)}t.default=(0,u.default)(function(e,t,r){return((0,n.default)(e)?h:v)(e,(0,s.default)(t),r)},3),e.exports=t.default}));i(T);var x=i(o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(n.default,e,t)};var n=i(T),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default})),A=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.promise=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return x(this.tasks)},e.prototype.tapPromise=function(e,t){var n=this;this.tasks.push(function(r){return i=n,void 0,a=function(){return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(c){o=[6,c],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return n.sent(),r(null,e),[2]}})},new((o=void 0)||(o=Promise))(function(e,t){function n(e){try{c(a.next(e))}catch(n){t(n)}}function r(e){try{c(a.throw(e))}catch(n){t(n)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o(function(e){e(i)})).then(n,r)}c((a=a.apply(i,[])).next())});var i,o,a})},e}(),O=i(o(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(d),r=a(g),i=a(l),o=a(f);function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.default)(function(e,t){if(t=(0,n.default)(t),!Array.isArray(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var o=0;function a(t){(0,i.default)(e[o++]).apply(void 0,t.concat([(0,r.default)(c)]))}function c(n){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];if(!1!==n)return n||o===e.length?t.apply(void 0,[n].concat(r)):void a(r)}a([])}),e.exports=t.default}));(function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return O(this.tasks)},e.prototype.tap=function(e,t){this.tasks.push(0===this.tasks.length?function(e){var n=t();e(!!n&&null,n)}:function(n,r){r(!!t()&&null,e)})}})(),function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return S(this.tasks)},e.prototype.tap=function(e,t){this.tasks.push(function(n){n(t(),e)})}}()},y1pI:function(e,t,n){var r=n("ljhN");e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},yG8O:function(e,t){e.exports=function(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}},yGk4:function(e,t,n){var r=n("Cwc5")(n("Kz5y"),"Set");e.exports=r},yLV6:function(e,t,n){var r;!function(i,o,a,c){"use strict";var s,u=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),f=Math.round,p=Math.abs,d=Date.now;function h(e,t,n){return setTimeout(E(e,n),t)}function v(e,t,n){return!!Array.isArray(e)&&(g(e,n[t],n),!0)}function g(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==c)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function m(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),e.apply(this,arguments)}}s="function"!=typeof Object.assign?function(e){if(e===c||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==c&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var y=m(function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===c)&&(e[r[i]]=t[r[i]]),i++;return e},"extend","Use `assign`."),b=m(function(e,t){return y(e,t,!0)},"merge","Use `assign`.");function _(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&s(r,n)}function E(e,t){return function(){return e.apply(t,arguments)}}function S(e,t){return"function"==typeof e?e.apply(t&&t[0]||c,t):e}function T(e,t){return e===c?t:e}function x(e,t,n){g(k(t),function(t){e.addEventListener(t,n,!1)})}function A(e,t,n){g(k(t),function(t){e.removeEventListener(t,n,!1)})}function O(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function w(e,t){return e.indexOf(t)>-1}function k(e){return e.trim().split(/\s+/g)}function I(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function C(e,t,n){for(var r=[],i=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];I(i,a)<0&&r.push(e[o]),i[o]=a,o++}return n&&(r=t?r.sort(function(e,n){return e[t]>n[t]}):r.sort()),r}function R(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),o=0;o<u.length;){if((r=(n=u[o])?n+i:t)in e)return r;o++}return c}var M=1;function N(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var L="ontouchstart"in i,j=R(i,"PointerEvent")!==c,D=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F="touch",B="mouse",U=["x","y"],z=["clientX","clientY"];function G(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){S(e.options.enable,[e])&&n.handler(t)},this.init()}function V(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&t&&r-i==0,a=12&t&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=H(t)),i>1&&!n.firstMultiple?n.firstMultiple=H(t):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=t.center=X(r);t.timeStamp=d(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=q(s,u),t.distance=Z(s,u),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=Y(t.deltaX,t.deltaY);var l,f,h=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=p(h.x)>p(h.y)?h.x:h.y,t.scale=a?(l=a.pointers,Z((f=r)[0],f[1],z)/Z(l[0],l[1],z)):1,t.rotation=a?function(e,t){return q(t[1],t[0],z)+q(e[1],e[0],z)}(a.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,o,a=e.lastInterval||t,s=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(s>25||a.velocity===c)){var u=t.deltaX-a.deltaX,l=t.deltaY-a.deltaY,f=W(s,u,l);r=f.x,i=f.y,n=p(f.x)>p(f.y)?f.x:f.y,o=Y(u,l),e.lastInterval=t}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=o}(n,t);var v=e.element;O(t.srcEvent.target,v)&&(v=t.srcEvent.target),t.target=v}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function H(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:f(e.pointers[n].clientX),clientY:f(e.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:t,center:X(t),deltaX:e.deltaX,deltaY:e.deltaY}}function X(e){var t=e.length;if(1===t)return{x:f(e[0].clientX),y:f(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:f(n/t),y:f(r/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function Y(e,t){return e===t?1:p(e)>=p(t)?e<0?2:4:t<0?8:16}function Z(e,t,n){n||(n=U);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function q(e,t,n){return n||(n=U),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}G.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(N(this.element),this.evWin,this.domHandler)}};var K={mousedown:1,mousemove:2,mouseup:4},Q="mousedown",J="mousemove mouseup";function $(){this.evEl=Q,this.evWin=J,this.pressed=!1,G.apply(this,arguments)}_($,G,{handler:function(e){var t=K[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:B,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:F,3:"pen",4:B,5:"kinect"},ne="pointerdown",re="pointermove pointerup pointercancel";function ie(){this.evEl=ne,this.evWin=re,G.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ne="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),_(ie,G,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=ee[r],o=te[e.pointerType]||e.pointerType,a=o==F,c=I(t,e.pointerId,"pointerId");1&i&&(0===e.button||a)?c<0&&(t.push(e),c=t.length-1):12&i&&(n=!0),c<0||(t[c]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(c,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ae="touchstart",ce="touchstart touchmove touchend touchcancel";function se(){this.evTarget=ae,this.evWin=ce,this.started=!1,G.apply(this,arguments)}function ue(e,t){var n=P(e.touches),r=P(e.changedTouches);return 12&t&&(n=C(n.concat(r),"identifier",!0)),[n,r]}_(se,G,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var n=ue.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},fe="touchstart touchmove touchend touchcancel";function pe(){this.evTarget=fe,this.targetIds={},G.apply(this,arguments)}function de(e,t){var n=P(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=P(e.changedTouches),c=[],s=this.target;if(o=n.filter(function(e){return O(e.target,s)}),1===t)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&c.push(a[i]),12&t&&delete r[a[i].identifier],i++;return c.length?[C(o.concat(c),"identifier",!0),c]:void 0}function he(){G.apply(this,arguments);var e=E(this.handler,this);this.touch=new pe(this.manager,e),this.mouse=new $(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ve(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ge.call(this,t)):12&e&&ge.call(this,t)}function ge(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)},2500)}}function me(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(t-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}_(pe,G,{handler:function(e){var t=le[e.type],n=de.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:e})}}),_(he,G,{handler:function(e,t,n){var r=n.pointerType==B;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(n.pointerType==F)ve.call(this,t,n);else if(r&&me.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ye=R(l.style,"touchAction"),be=ye!==c,_e="compute",Ee="auto",Se="manipulation",Te="none",xe="pan-x",Ae="pan-y",Oe=function(){if(!be)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||i.CSS.supports("touch-action",n)}),e}();function we(e,t){this.manager=e,this.set(t)}we.prototype={set:function(e){e==_e&&(e=this.compute()),be&&this.manager.element.style&&Oe[e]&&(this.manager.element.style[ye]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,function(t){S(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(w(e,Te))return Te;var t=w(e,xe),n=w(e,Ae);return t&&n?Te:t||n?t?xe:Ae:w(e,Se)?Se:Ee}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=w(r,Te)&&!Oe.none,o=w(r,Ae)&&!Oe["pan-y"],a=w(r,xe)&&!Oe["pan-x"];if(i&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!a||!o)return i||o&&6&n||a&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var ke=32;function Ie(e){this.options=s({},this.defaults,e||{}),this.id=M++,this.manager=null,this.options.enable=T(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Pe(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ce(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Re(e,t){var n=t.manager;return n?n.get(e):e}function Me(){Ie.apply(this,arguments)}function Ne(){Me.apply(this,arguments),this.pX=null,this.pY=null}function Le(){Me.apply(this,arguments)}function je(){Ie.apply(this,arguments),this._timer=null,this._input=null}function De(){Me.apply(this,arguments)}function Fe(){Me.apply(this,arguments)}function Be(){Ie.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ue(e,t){return(t=t||{}).recognizers=T(t.recognizers,Ue.defaults.preset),new ze(e,t)}function ze(e,t){this.options=s({},Ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(j?ie:D?pe:L?he:$))(this,V),this.touchAction=new we(this,this.options.touchAction),Ge(this,!0),g(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Ge(e,t){var n,r=e.element;r.style&&(g(e.options.cssProps,function(i,o){n=R(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Ie.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(v(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Re(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return v(e,"dropRecognizeWith",this)||(e=Re(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(v(e,"requireFailure",this))return this;var t=this.requireFail;return-1===I(t,e=Re(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(v(e,"dropRequireFailure",this))return this;e=Re(e,this);var t=I(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Pe(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Pe(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=ke},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=s({},e);if(!S(this.options.enable,[this,t]))return this.reset(),void(this.state=ke);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},_(Me,Ie,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:ke}}),_(Ne,Me,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ae),24&e&&t.push(xe),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,o=e.deltaX,a=e.deltaY;return i&t.direction||(6&t.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(e.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Me.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ce(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),_(Le,Me,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Te]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),_(je,Ie,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ee]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=h(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return ke},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),_(De,Me,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Te]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),_(Fe,Me,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ne.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&p(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Ce(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),_(Be,Ie,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||Z(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=h(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return ke},failTimeout:function(){return this._timer=h(function(){this.state=ke},this.options.interval,this),ke},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ue.VERSION="2.0.7",Ue.defaults={domEvents:!1,touchAction:_e,enable:!0,inputTarget:null,inputClass:null,preset:[[De,{enable:!1}],[Le,{enable:!1},["rotate"]],[Fe,{direction:6}],[Ne,{direction:6},["swipe"]],[Be],[Be,{event:"doubletap",taps:2},["tap"]],[je]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ze.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Ie)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(v(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(v(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=I(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==c&&t!==c){var n=this.handlers;return g(k(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==c){var n=this.handlers;return g(k(e),function(e){t?n[e]&&n[e].splice(I(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ge(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(Ue,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:ke,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:ze,Input:G,TouchAction:we,TouchInput:pe,MouseInput:$,PointerEventInput:ie,TouchMouseInput:he,SingleTouchInput:se,Recognizer:Ie,AttrRecognizer:Me,Tap:Be,Pan:Ne,Swipe:Fe,Pinch:Le,Rotate:De,Press:je,on:x,off:A,each:g,merge:b,extend:y,assign:s,inherit:_,bindFn:E,prefixed:R}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Ue,(r=(function(){return Ue}).call(t,n,t,e))===c||(e.exports=r)}(window,document)},yMAV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plan=void 0,t.Plan=function(e,t){this.parentContext=e,this.rootRequest=t}},yP5f:function(e,t,n){var r=n("+K+b");e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},yXPU:function(e,t){function n(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){var a=e.apply(t,r);function c(e){n(a,i,o,c,s,"next",e)}function s(e){n(a,i,o,c,s,"throw",e)}c(void 0)})}}},z4Hk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingWhenSyntax=void 0;var r=n("406g"),i=n("RR/i"),o=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=i.namedConstraint(e),new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=i.taggedConstraint(e)(t),new r.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return i.typeConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return i.namedConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return i.taggedConstraint(e)(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=o},zZ0H:function(e,t){e.exports=function(e){return e}},zoYe:function(e,t,n){var r=n("nmnc"),i=n("eUgh"),o=n("Z0cm"),a=n("/9aa"),c=r?r.prototype:void 0,s=c?c.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return s?s.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},zxMA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryableString=void 0;var r=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=r}}]);